<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claudyne - Interface Étudiant</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            /* Couleurs principales */
            --primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --success: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --warning: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            --danger: linear-gradient(135deg, #ff4757 0%, #ff6b7a 100%);
            --info: linear-gradient(135deg, #17a2b8 0%, #20c997 100%);

            /* Système XP et niveaux - De Ultra */
            --xp-gold: linear-gradient(135deg, #FFD700, #FFA500);
            --xp-silver: linear-gradient(135deg, #C0C0C0, #A8A8A8);
            --xp-bronze: linear-gradient(135deg, #CD7F32, #B87333);

            /* Interface glassmorphism */
            --glass: rgba(255, 255, 255, 0.15);
            --glass-dark: rgba(0, 0, 0, 0.2);
            --text: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.8);
            --border: rgba(255, 255, 255, 0.2);
            --shadow-glass: 0 8px 32px rgba(31, 38, 135, 0.37);
            --shadow-glass-hover: 0 15px 45px rgba(31, 38, 135, 0.5);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 30%, #f093fb 70%, #43e97b 100%);
            background-attachment: fixed;
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Particules flottantes */
        .floating-particles {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: float 20s infinite linear;
        }

        @keyframes float {
            from { transform: translateY(100vh) rotate(0deg); }
            to { transform: translateY(-100px) rotate(360deg); }
        }

        .container {
            display: flex;
            min-height: 100vh;
            position: relative;
            z-index: 2;
        }

        /* SIDEBAR PREMIUM */
        .sidebar {
            width: 320px;
            background: var(--glass);
            backdrop-filter: blur(25px);
            border-right: 2px solid var(--border);
            position: fixed;
            height: 100vh;
            z-index: 1000;
            overflow-y: auto;
            box-shadow: var(--shadow-glass);
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .sidebar.closed {
            transform: translateX(-100%);
        }

        /* Header XP global */
        .xp-header {
            padding: 1.5rem;
            background: var(--glass-dark);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .level-badge {
            background: var(--xp-gold);
            color: #000;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            font-weight: 700;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
        }

        .xp-progress {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            height: 12px;
            overflow: hidden;
            margin-bottom: 0.5rem;
            position: relative;
        }

        .xp-fill {
            height: 100%;
            background: var(--xp-gold);
            border-radius: 20px;
            transition: width 1s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
        }

        .xp-fill::after {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .xp-text {
            font-size: 0.8rem;
            color: var(--text-secondary);
            display: flex;
            justify-content: space-between;
        }

        /* Logo amélioré */
        .logo {
            text-align: center;
            padding: 2rem;
            border-bottom: 1px solid var(--border);
        }

        .logo h1 {
            font-size: 2.2rem;
            font-weight: 900;
            background: var(--primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
            text-shadow: 0 0 30px rgba(102, 126, 234, 0.5);
        }

        .logo p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
        }

        /* Navigation premium */
        .nav-menu {
            padding: 2rem 1rem;
        }

        .nav-section {
            margin-bottom: 2rem;
        }

        .nav-section-title {
            font-size: 0.8rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            font-weight: 700;
            letter-spacing: 1px;
            padding: 0 1rem;
            margin-bottom: 1rem;
        }

        .nav-item {
            margin: 0.3rem 0;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 1rem 1.5rem;
            color: var(--text);
            text-decoration: none;
            border-radius: 15px;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            font-weight: 500;
        }

        .nav-link::before {
            content: '';
            position: absolute;
            top: 0; left: -100%;
            width: 100%; height: 100%;
            background: var(--primary);
            transition: left 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: -1;
        }

        .nav-link:hover::before,
        .nav-link.active::before {
            left: 0;
        }

        .nav-link:hover,
        .nav-link.active {
            transform: translateX(8px);
            box-shadow: var(--shadow-glass);
        }

        .nav-icon {
            margin-right: 1rem;
            width: 20px;
            text-align: center;
            font-size: 1.1rem;
        }

        .nav-badge {
            background: var(--danger);
            color: white;
            font-size: 0.7rem;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            margin-left: auto;
            font-weight: 700;
        }

        /* CONTENU PRINCIPAL */
        .main-content {
            flex: 1;
            margin-left: 320px;
            padding: 2rem;
            transition: margin-left 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
        }

        .main-content.expanded {
            margin-left: 0;
        }

        /* Header utilisateur premium */
        .user-header {
            background: var(--glass);
            backdrop-filter: blur(25px);
            border: 2px solid var(--border);
            border-radius: 20px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-glass);
            position: relative;
            overflow: hidden;
        }

        .user-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0;
            width: 100%;
            height: 4px;
            background: var(--primary);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .user-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2.5rem;
            box-shadow: var(--shadow-glass);
            position: relative;
        }

        .user-avatar::after {
            content: '';
            position: absolute;
            inset: -3px;
            border-radius: 50%;
            padding: 3px;
            background: var(--xp-gold);
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask-composite: subtract;
        }

        .user-details h1 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
        }

        .user-details p {
            color: var(--text-secondary);
            font-size: 1.2rem;
            margin-bottom: 1rem;
        }

        .subscription-badge {
            background: var(--warning);
            color: #000;
            padding: 1rem 1.5rem;
            border-radius: 50px;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 15px rgba(67, 233, 123, 0.3);
        }

        .user-badges {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .mini-badge {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: bold;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .mini-badge:hover {
            transform: scale(1.1);
        }

        .badge-gold { background: var(--xp-gold); color: #000; }
        .badge-silver { background: var(--xp-silver); color: #000; }
        .badge-bronze { background: var(--xp-bronze); color: white; }

        /* Stats grid premium */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0; left: -100%;
            width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.6s ease;
        }

        .stat-card:hover::before {
            left: 100%;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-glass-hover);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            background: var(--primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-label {
            opacity: 0.8;
            font-size: 1rem;
            font-weight: 500;
        }

        /* Sections et navigation */
        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeInUp 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-title {
            font-size: 3rem;
            font-weight: 900;
            background: var(--primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
            margin-bottom: 3rem;
            position: relative;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: var(--primary);
            border-radius: 2px;
        }

        /* Cards grid premium */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .card {
            background: var(--glass);
            backdrop-filter: blur(25px);
            border: 2px solid var(--border);
            border-radius: 20px;
            padding: 2.5rem;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-glass);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 4px;
            background: var(--primary);
        }

        .card:hover {
            transform: translateY(-10px);
            box-shadow: var(--shadow-glass-hover);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .card-icon {
            width: 60px;
            height: 60px;
            background: var(--primary);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.8rem;
            box-shadow: var(--shadow-glass);
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 700;
        }

        /* Boutons premium */
        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 1.2rem 2.5rem;
            border-radius: 50px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            display: inline-flex;
            align-items: center;
            gap: 0.8rem;
            text-decoration: none;
            margin-top: 1.5rem;
            font-size: 1rem;
            box-shadow: var(--shadow-glass);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-glass-hover);
        }

        .btn-secondary { background: var(--secondary); }
        .btn-success { background: var(--success); }
        .btn-warning { background: var(--warning); color: #000; }
        .btn-danger { background: var(--danger); }
        .btn-info { background: var(--info); }

        /* Progress bars premium */
        .progress-bar {
            background: rgba(255, 255, 255, 0.2);
            height: 12px;
            border-radius: 10px;
            overflow: hidden;
            margin: 1rem 0;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: var(--success);
            border-radius: 10px;
            transition: width 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 2s infinite;
        }

        /* Toast notifications */
        .toast-container {
            position: fixed;
            top: 2rem;
            right: 2rem;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .toast {
            background: var(--glass);
            backdrop-filter: blur(25px);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: var(--shadow-glass);
            transform: translateX(400px);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            max-width: 400px;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success::before { background: var(--success); }
        .toast.warning::before { background: var(--warning); }
        .toast.error::before { background: var(--danger); }
        .toast.info::before { background: var(--info); }

        .toast::before {
            content: '';
            position: absolute;
            left: 0; top: 0;
            width: 4px; height: 100%;
            background: var(--primary);
        }

        .toast-header {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .toast-close {
            position: absolute;
            top: 1rem; right: 1rem;
            background: none;
            border: none;
            color: var(--text);
            font-size: 1.2rem;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }

        .toast-close:hover { opacity: 1; }

        /* Mobile responsive */
        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 1rem; left: 1rem;
            z-index: 1001;
            background: var(--primary);
            color: white;
            border: none;
            padding: 1rem;
            border-radius: 50%;
            font-size: 1.3rem;
            cursor: pointer;
            box-shadow: var(--shadow-glass);
        }

        @media (max-width: 1024px) {
            .mobile-menu-btn { display: block; }
            .sidebar { transform: translateX(-100%); }
            .sidebar.open { transform: translateX(0); }
            .main-content { margin-left: 0; padding: 1rem; }
            .cards-grid { grid-template-columns: 1fr; }
            .user-info { flex-direction: column; text-align: center; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .section-title { font-size: 2rem; }
        }

        @media (max-width: 768px) {
            .stats-grid { grid-template-columns: 1fr; }
            .user-header { padding: 1.5rem; }
            .card { padding: 1.5rem; }
        }

        /* Animations et effects */
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: var(--shadow-glass); }
            50% { box-shadow: var(--shadow-glass-hover); }
        }

        .glow-effect {
            animation: glow 3s ease-in-out infinite;
        }

        /* Éléments spécifiques aux sections fusionnées */
        .ai-thinking {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin: 1rem 0;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .ai-dots {
            display: flex;
            gap: 0.3rem;
        }

        .ai-dot {
            width: 8px;
            height: 8px;
            background: var(--primary);
            border-radius: 50%;
            animation: aiThinking 1.5s infinite ease-in-out;
        }

        .ai-dot:nth-child(2) { animation-delay: 0.2s; }
        .ai-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes aiThinking {
            0%, 60%, 100% { transform: scale(1); opacity: 0.5; }
            30% { transform: scale(1.2); opacity: 1; }
        }

        .streak-flame {
            animation: flicker 1s infinite alternate;
        }

        @keyframes flicker {
            0% { transform: scale(1) rotate(-1deg); }
            100% { transform: scale(1.1) rotate(1deg); }
        }

        /* Classes pour toutes les sections fusionnées */
        .notifications-panel {
            position: relative;
        }

        .notifications-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--glass);
            backdrop-filter: blur(25px);
            border: 1px solid var(--border);
            border-radius: 15px;
            min-width: 300px;
            box-shadow: var(--shadow-glass);
            z-index: 1000;
            max-height: 400px;
            overflow-y: auto;
        }

        .notification-item {
            padding: 1rem;
            border-bottom: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .notification-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .notification-item:last-child {
            border-bottom: none;
        }

        /* ===== STYLES POUR TOUTES LES SECTIONS ENRICHIES ===== */

        /* Section Cours */
        .course-progress h4 {
            margin-bottom: 1rem;
            color: var(--text);
        }

        .course-stats {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
            margin: 1.5rem 0;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            font-size: 0.9rem;
        }

        .progress-text {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }

        /* Section Quiz */
        .quiz-themes, .weekly-challenges {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .theme-item, .challenge-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-item:hover, .challenge-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }

        .theme-icon {
            font-size: 1.5rem;
            width: 40px;
            text-align: center;
        }

        .theme-count {
            margin-left: auto;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .challenge-item.active {
            border-left: 4px solid var(--success);
            background: rgba(76, 175, 80, 0.1);
        }

        .challenge-info {
            flex: 1;
        }

        .challenge-info h4 {
            margin-bottom: 0.5rem;
            color: var(--text);
        }

        .challenge-info p {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .challenge-progress {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .challenge-progress .progress-bar {
            flex: 1;
            height: 6px;
        }

        .challenge-progress span {
            font-size: 0.8rem;
            color: var(--text-secondary);
            white-space: nowrap;
        }

        .challenge-reward {
            background: var(--xp-gold);
            color: #000;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.8rem;
        }

        .exam-stats {
            margin: 1.5rem 0;
        }

        .exam-stats p {
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }

        /* Section IA Mentor */
        .ai-chat-container {
            height: 400px;
            display: flex;
            flex-direction: column;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            overflow: hidden;
        }

        .ai-messages {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .ai-message {
            display: flex;
            align-items: flex-end;
            gap: 0.8rem;
        }

        .ai-message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .message-avatar.ai {
            background: var(--primary);
            color: white;
        }

        .message-avatar.user {
            background: var(--success);
            color: white;
        }

        .message-bubble {
            max-width: 70%;
            padding: 1rem 1.2rem;
            border-radius: 18px;
            line-height: 1.5;
        }

        .message-bubble.ai {
            background: rgba(255, 255, 255, 0.15);
            color: var(--text);
        }

        .message-bubble.user {
            background: var(--primary);
            color: white;
        }

        .ai-input-area {
            display: flex;
            padding: 1rem;
            gap: 0.8rem;
            background: rgba(255, 255, 255, 0.1);
        }

        .ai-input-area input {
            flex: 1;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid var(--border);
            border-radius: 25px;
            padding: 0.8rem 1.2rem;
            color: var(--text);
            font-size: 0.95rem;
        }

        .ai-input-area input::placeholder {
            color: var(--text-secondary);
        }

        .ai-input-area input:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(255, 255, 255, 0.25);
        }

        .ai-send-btn {
            background: var(--primary);
            border: none;
            color: white;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ai-send-btn:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-glass);
        }

        .performance-insights {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .insight-item {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
        }

        .insight-icon {
            font-size: 1.5rem;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .insight-icon.positive {
            background: rgba(76, 175, 80, 0.2);
        }

        .insight-icon.warning {
            background: rgba(255, 193, 7, 0.2);
        }

        .insight-icon.info {
            background: rgba(23, 162, 184, 0.2);
        }

        .insight-text {
            flex: 1;
            line-height: 1.4;
        }

        .prediction-display {
            text-align: center;
            margin: 1.5rem 0;
        }

        .prediction-score {
            margin-bottom: 2rem;
        }

        .predicted-average {
            font-size: 3.5rem;
            font-weight: 900;
            background: var(--success);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .prediction-label {
            font-size: 1.1rem;
            color: var(--text);
            font-weight: 600;
        }

        .confidence-level {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }

        .prediction-breakdown {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin: 2rem 0;
        }

        .subject-prediction {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 0.9rem;
        }

        .subject-prediction span:first-child {
            min-width: 100px;
            text-align: left;
            font-weight: 600;
        }

        .subject-prediction span:last-child {
            min-width: 60px;
            text-align: right;
            font-weight: 700;
        }

        .prediction-bar {
            flex: 1;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
        }

        .prediction-fill {
            height: 100%;
            background: var(--success);
            border-radius: 4px;
            transition: width 1s ease-out;
        }

        .prediction-tips {
            background: rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            border-radius: 12px;
            margin-top: 2rem;
        }

        .prediction-tips h4 {
            margin-bottom: 1rem;
            color: var(--text);
        }

        .prediction-tips ul {
            padding-left: 1.5rem;
        }

        .prediction-tips li {
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }

        .adaptive-content {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .content-type {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .content-type:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }

        .content-type.active {
            border-left: 4px solid var(--primary);
            background: rgba(102, 126, 234, 0.1);
        }

        .content-icon {
            font-size: 2rem;
            width: 60px;
            text-align: center;
        }

        .content-info h4 {
            margin-bottom: 0.5rem;
            color: var(--text);
        }

        .content-info p {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* ================ MODAL CHANGEMENT MOT DE PASSE ================ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(8px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-container {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 0;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            animation: scaleIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .modal-header {
            padding: 24px 24px 16px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            margin: 0;
            color: var(--text-primary);
            font-size: 1.25rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 4px;
            border-radius: 50%;
            transition: all 0.2s ease;
        }

        .modal-close:hover {
            background: var(--accent-color);
            color: var(--text-primary);
        }

        .modal-content {
            padding: 24px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .password-input-group {
            position: relative;
            display: flex;
            align-items: center;
        }

        .password-input-group input {
            flex: 1;
            padding: 12px 16px;
            padding-right: 50px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: var(--input-bg);
            color: var(--text-primary);
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .password-input-group input:focus {
            outline: none;
            border-color: var(--accent-color);
            background: var(--surface-color);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .password-toggle {
            position: absolute;
            right: 12px;
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-secondary);
            font-size: 16px;
            padding: 4px;
            transition: color 0.2s ease;
        }

        .password-toggle:hover {
            color: var(--accent-color);
        }

        .password-requirements {
            margin-top: 12px;
        }

        .password-requirements ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .password-requirements li {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 4px;
            padding-left: 16px;
            position: relative;
        }

        .password-requirements li::before {
            content: "❌";
            position: absolute;
            left: 0;
            transition: all 0.2s ease;
        }

        .password-requirements li.valid::before {
            content: "✅";
        }

        .password-match {
            margin-top: 8px;
            font-size: 12px;
            padding: 6px 12px;
            border-radius: 6px;
            transition: all 0.2s ease;
        }

        .password-match.error {
            background: rgba(248, 113, 113, 0.1);
            color: #ef4444;
            border: 1px solid rgba(248, 113, 113, 0.2);
        }

        .password-match.success {
            background: rgba(34, 197, 94, 0.1);
            color: #22c55e;
            border: 1px solid rgba(34, 197, 94, 0.2);
        }

        .password-strength {
            margin-top: 12px;
        }

        .strength-label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 6px;
        }

        .strength-bar {
            height: 6px;
            background: var(--border-color);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 6px;
        }

        .strength-fill {
            height: 100%;
            transition: all 0.3s ease;
            border-radius: 3px;
        }

        .strength-fill.weak {
            width: 25%;
            background: #ef4444;
        }

        .strength-fill.medium {
            width: 50%;
            background: #f59e0b;
        }

        .strength-fill.good {
            width: 75%;
            background: #10b981;
        }

        .strength-fill.strong {
            width: 100%;
            background: #059669;
        }

        .strength-text {
            font-size: 12px;
            font-weight: 500;
        }

        .strength-text.weak {
            color: #ef4444;
        }

        .strength-text.medium {
            color: #f59e0b;
        }

        .strength-text.good {
            color: #10b981;
        }

        .strength-text.strong {
            color: #059669;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 24px;
            padding-top: 16px;
            border-top: 1px solid var(--border-color);
        }

        .modal-actions .btn {
            min-width: 120px;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(-10px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        /* ================ BOUTON RENOUVELLEMENT PREMIUM ================ */
        .subscription-info {
            display: flex;
            flex-direction: column;
            gap: 8px;
            align-items: flex-start;
        }

        .btn-renew-premium {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            color: #1a1a1a;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);
            border: 1px solid rgba(255, 215, 0, 0.5);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-renew-premium:hover {
            background: linear-gradient(135deg, #ffed4e 0%, #ffd700 100%);
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.4);
            border-color: #ffd700;
        }

        .btn-renew-premium:active {
            transform: translateY(0) scale(0.98);
            box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);
        }

        .btn-renew-premium i {
            font-size: 11px;
            animation: rotate 2s linear infinite;
        }

        .btn-renew-premium:hover i {
            animation-duration: 0.5s;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Responsive pour mobile */
        @media (max-width: 768px) {
            .subscription-info {
                align-items: center;
                text-align: center;
            }

            .btn-renew-premium {
                font-size: 11px;
                padding: 6px 12px;
            }
        }
    </style>
</head>
<body>
    <!-- Particules flottantes -->
    <div class="floating-particles" id="particles"></div>

    <div class="container">
        <!-- Bouton menu mobile -->
        <button class="mobile-menu-btn" onclick="toggleSidebar()">
            <i class="fas fa-bars"></i>
        </button>

        <!-- Sidebar premium -->
        <nav class="sidebar" id="sidebar">
            <!-- Header XP global -->
            <div class="xp-header">
                <div class="level-badge" id="levelBadge">
                    <i class="fas fa-crown"></i>
                    Niveau 15
                </div>
                <div class="xp-progress">
                    <div class="xp-fill" id="xpFill" style="width: 73%"></div>
                </div>
                <div class="xp-text" id="xpText">2,890 / 4,000 XP</div>
            </div>

            <!-- Logo -->
            <div class="logo">
                <h1>Claudyne </h1>
                <p>Interface Étudiant</p>
            </div>

            <!-- Navigation premium -->
            <div class="nav-menu">
                <!-- Section Principale -->
                <div class="nav-section">
                    <div class="nav-section-title">Principal</div>
                    <div class="nav-item">
                        <div class="nav-link active" onclick="showSection('dashboard')" tabindex="0">
                            <i class="fas fa-home nav-icon"></i>
                            <span>Tableau de bord</span>
                        </div>
                    </div>
                    <div class="nav-item">
                        <div class="nav-link" onclick="showSection('courses')" tabindex="0">
                            <i class="fas fa-book nav-icon"></i>
                            <span>Mes Cours</span>
                        </div>
                    </div>
                    <div class="nav-item">
                        <div class="nav-link" onclick="showSection('quiz')" tabindex="0">
                            <i class="fas fa-brain nav-icon"></i>
                            <span>Quiz Adaptatifs IA</span>
                            <div class="nav-badge">2</div>
                        </div>
                    </div>
                </div>

                <!-- Section IA & Analytics -->
                <div class="nav-section">
                    <div class="nav-section-title">IA & Analytics</div>
                    <div class="nav-item">
                        <div class="nav-link" onclick="showSection('ai')" tabindex="0">
                            <i class="fas fa-robot nav-icon"></i>
                            <span>Mentor IA</span>
                            <div class="nav-badge">!</div>
                        </div>
                    </div>
                    <div class="nav-item">
                        <div class="nav-link" onclick="showSection('analytics')" tabindex="0">
                            <i class="fas fa-chart-line nav-icon"></i>
                            <span>Analytics Avancés</span>
                        </div>
                    </div>
                </div>

                <!-- Section Progression -->
                <div class="nav-section">
                    <div class="nav-section-title">Progression</div>
                    <div class="nav-item">
                        <div class="nav-link" onclick="showSection('achievements')" tabindex="0">
                            <i class="fas fa-trophy nav-icon"></i>
                            <span>Accomplissements</span>
                        </div>
                    </div>
                    <div class="nav-item">
                        <div class="nav-link" onclick="showSection('claudine-award')" tabindex="0">
                            <i class="fas fa-award nav-icon"></i>
                            <span>Prix Claudine</span>
                        </div>
                    </div>
                    <div class="nav-item">
                        <div class="nav-link" onclick="showSection('revisions')" tabindex="0">
                            <i class="fas fa-book-open nav-icon"></i>
                            <span>Révisions IA</span>
                        </div>
                    </div>
                </div>

                <!-- Section Orientation -->
                <div class="nav-section">
                    <div class="nav-section-title">Orientation & Bien-être</div>
                    <div class="nav-item">
                        <div class="nav-link" onclick="showSection('orientation')" tabindex="0">
                            <i class="fas fa-compass nav-icon"></i>
                            <span>Orientation</span>
                        </div>
                    </div>
                    <div class="nav-item">
                        <div class="nav-link" onclick="showSection('bien-etre')" tabindex="0">
                            <i class="fas fa-heart nav-icon"></i>
                            <span>Bien-être</span>
                        </div>
                    </div>
                </div>

                <!-- Section Social -->
                <div class="nav-section">
                    <div class="nav-section-title">Social</div>
                    <div class="nav-item">
                        <div class="nav-link" onclick="showSection('communaute')" tabindex="0">
                            <i class="fas fa-users nav-icon"></i>
                            <span>Communauté</span>
                        </div>
                    </div>
                    <div class="nav-item">
                        <div class="nav-link" onclick="showSection('parametres')" tabindex="0">
                            <i class="fas fa-cog nav-icon"></i>
                            <span>Paramètres</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Notifications panel -->
            <div class="notifications-panel">
                <div class="nav-item">
                    <div class="nav-link" onclick="toggleNotifications()" tabindex="0">
                        <i class="fas fa-bell nav-icon"></i>
                        <span>Notifications</span>
                        <div class="notification-badge" id="notificationBadge">3</div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Contenu principal -->
        <main class="main-content" id="mainContent">
            <!-- Header utilisateur premium -->
            <div class="user-header">
                <div class="user-info">
                    <div class="user-avatar">
                        <i class="fas fa-user-graduate"></i>
                    </div>
                    <div class="user-details">
                        <h1 id="studentName">Chargement...</h1>
                        <p id="studentInfo">Chargement...</p>
                        <div class="subscription-info">
                            <div class="subscription-badge">
                                <i class="fas fa-crown"></i>
                                <span id="subscriptionStatus">Chargement...</span>
                            </div>
                            <button class="btn-renew-premium" onclick="openRenewalModal()">
                                <i class="fas fa-sync-alt"></i>
                                Renouveler mon abonnement
                            </button>
                        </div>
                        <div class="user-badges">
                            <div class="mini-badge badge-gold" title="Maître Mathématiques">🏆</div>
                            <div class="mini-badge badge-silver" title="Expert Physique">🥈</div>
                            <div class="mini-badge badge-bronze" title="Apprenti Chimie">🥉</div>
                        </div>
                        <button onclick="studentLogout()" style="
                            background: #F87171;
                            color: white;
                            border: none;
                            padding: 0.5rem 1rem;
                            border-radius: 8px;
                            font-size: 0.9rem;
                            margin-top: 1rem;
                            cursor: pointer;
                            transition: all 0.2s;
                            font-weight: 500;
                            display: flex;
                            align-items: center;
                            gap: 0.5rem;
                        " onmouseover="this.style.background='#EF4444'; this.style.transform='translateY(-1px)'" onmouseout="this.style.background='#F87171'; this.style.transform='translateY(0)'">
                            🚪 Se déconnecter
                        </button>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card" onclick="showDetailedStats('average')">
                        <div class="stat-value" id="average-stat">0.0</div>
                        <div class="stat-label">Moyenne générale</div>
                    </div>
                    <div class="stat-card" onclick="showDetailedStats('courses')">
                        <div class="stat-value" id="lessons-stat">0</div>
                        <div class="stat-label">Cours terminés</div>
                    </div>
                    <div class="stat-card" onclick="showDetailedStats('quizzes')">
                        <div class="stat-value" id="quizzes-stat">0</div>
                        <div class="stat-label">Quiz réussis</div>
                    </div>
                    <div class="stat-card" onclick="showDetailedStats('rank')">
                        <div class="stat-value" id="rank-stat">-</div>
                        <div class="stat-label">Classement</div>
                    </div>
                    <div class="stat-card" onclick="showDetailedStats('xp')">
                        <div class="stat-value" id="header-xp">0</div>
                        <div class="stat-label">Points XP</div>
                    </div>
                    <div class="stat-card" onclick="showDetailedStats('streak')">
                        <div class="stat-value" id="header-streak">
                            <span class="streak-flame">🔥</span> 0
                        </div>
                        <div class="stat-label">Jours consécutifs</div>
                    </div>
                </div>
            </div>

            <!-- Dashboard Section -->
            <section id="dashboard" class="section active">
                <h2 class="section-title">🏠 Tableau de bord</h2>

                <div class="cards-grid">
                    <!-- Activité du jour -->
                    <div class="card glow-effect">
                        <div class="card-header">
                            <div class="card-icon" style="background: var(--warning);">
                                <i class="fas fa-calendar-day"></i>
                            </div>
                            <h3 class="card-title">Activité du Jour</h3>
                        </div>
                        <div class="card-content">
                            <p>Vous avez 3 tâches importantes aujourd'hui :</p>
                            <ul style="margin: 1rem 0; padding-left: 1.5rem;">
                                <li>📐 Quiz Mathématiques - Dérivées (16h00)</li>
                                <li>⚛️ TP Physique - Circuit électrique (18h00)</li>
                                <li>📝 Devoir Français à rendre demain</li>
                            </ul>
                            <div class="daily-challenges">
                                <h4>🎯 Défis Quotidiens</h4>
                                <div class="challenge-item">
                                    <span>Terminer 3 exercices de maths</span>
                                    <div class="challenge-reward">+50 XP</div>
                                </div>
                                <div class="challenge-item">
                                    <span>Réviser 30 min de physique</span>
                                    <div class="challenge-reward">+30 XP</div>
                                </div>
                                <div class="challenge-item">
                                    <span>Participer au forum</span>
                                    <div class="challenge-reward">+25 XP</div>
                                </div>
                            </div>
                            <button class="btn btn-warning" onclick="startDailyChallenge()">
                                <i class="fas fa-play"></i>
                                Accepter les défis
                            </button>
                        </div>
                    </div>

                    <!-- Recommandations IA -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon" style="background: var(--info);">
                                <i class="fas fa-magic"></i>
                            </div>
                            <h3 class="card-title">Recommandations IA</h3>
                        </div>
                        <div class="card-content">
                            <div class="ai-thinking">
                                <span>IA analysant vos performances...</span>
                                <div class="ai-dots">
                                    <div class="ai-dot"></div>
                                    <div class="ai-dot"></div>
                                    <div class="ai-dot"></div>
                                </div>
                            </div>
                            <div style="margin: 1rem 0; padding: 1rem; background: rgba(23, 162, 184, 0.1); border-radius: 10px;">
                                <p><strong>💡 Analyse personnalisée :</strong></p>
                                <p>Vos performances en mathématiques sont excellentes (+12% ce mois). Je recommande d'augmenter la difficulté et de vous concentrer sur la physique où vous avez le plus de potentiel d'amélioration.</p>
                                <p><strong>🎮 Récompense :</strong> 40-80 XP selon performance</p>
                            </div>
                            <button class="btn btn-info" onclick="showSection('ai')">
                                <i class="fas fa-robot"></i>
                                Consulter le Mentor IA
                            </button>
                        </div>
                    </div>

                    <!-- Progression rapide -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon" style="background: var(--success);">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <h3 class="card-title">Progression cette Semaine</h3>
                        </div>
                        <div class="card-content">
                            <div class="progress-item">
                                <div class="progress-info">
                                    <span>Mathématiques</span>
                                    <span>89%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 89%"></div>
                                </div>
                            </div>
                            <div class="progress-item">
                                <div class="progress-info">
                                    <span>Physique</span>
                                    <span>76%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 76%"></div>
                                </div>
                            </div>
                            <div class="progress-item">
                                <div class="progress-info">
                                    <span>Chimie</span>
                                    <span>94%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 94%"></div>
                                </div>
                            </div>
                            <button class="btn btn-secondary" onclick="showSection('achievements')">
                                <i class="fas fa-trophy"></i>
                                Voir accomplissements
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section Mes Cours -->
            <section id="courses" class="section">
                <h2 class="section-title">📚 Mes Cours</h2>

                <div class="cards-grid">
                    <!-- Mathématiques -->
                    <div class="card glow-effect">
                        <div class="card-header">
                            <div class="card-icon" style="background: var(--primary);">
                                <i class="fas fa-calculator"></i>
                            </div>
                            <h3 class="card-title">Mathématiques</h3>
                        </div>
                        <div class="card-content">
                            <div class="course-progress">
                                <h4>Chapitre actuel : Dérivées et Applications</h4>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 67%"></div>
                                </div>
                                <p>Leçon 8/12 complétée</p>
                            </div>
                            <div class="course-stats">
                                <div class="stat-item">
                                    <span>Note moyenne</span>
                                    <strong>16.2/20</strong>
                                </div>
                                <div class="stat-item">
                                    <span>Temps passé</span>
                                    <strong>24h 30m</strong>
                                </div>
                                <div class="stat-item">
                                    <span>Prochaine évaluation</span>
                                    <strong>Mercredi 18h</strong>
                                </div>
                            </div>
                            <button class="btn" onclick="resumeCourse('math')">
                                <i class="fas fa-play"></i>
                                Reprendre le cours
                            </button>
                        </div>
                    </div>

                    <!-- Physique -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon" style="background: var(--success);">
                                <i class="fas fa-atom"></i>
                            </div>
                            <h3 class="card-title">Physique</h3>
                        </div>
                        <div class="card-content">
                            <div class="course-progress">
                                <h4>Chapitre actuel : Électricité</h4>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 50%"></div>
                                </div>
                                <p>Leçon 5/10 complétée</p>
                            </div>
                            <div class="course-stats">
                                <div class="stat-item">
                                    <span>Note moyenne</span>
                                    <strong>14.8/20</strong>
                                </div>
                                <div class="stat-item">
                                    <span>Temps passé</span>
                                    <strong>18h 15m</strong>
                                </div>
                                <div class="stat-item">
                                    <span>Points faibles</span>
                                    <strong>Circuit RLC</strong>
                                </div>
                            </div>
                            <button class="btn btn-secondary" onclick="resumeCourse('physics')">
                                <i class="fas fa-play"></i>
                                Reprendre le cours
                            </button>
                        </div>
                    </div>

                    <!-- Chimie -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon" style="background: var(--warning);">
                                <i class="fas fa-flask"></i>
                            </div>
                            <h3 class="card-title">Chimie</h3>
                        </div>
                        <div class="card-content">
                            <div class="course-progress">
                                <h4>Chapitre actuel : Réactions Organiques</h4>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 80%"></div>
                                </div>
                                <p>Leçon 8/10 complétée</p>
                            </div>
                            <div class="course-stats">
                                <div class="stat-item">
                                    <span>Note moyenne</span>
                                    <strong>17.5/20</strong>
                                </div>
                                <div class="stat-item">
                                    <span>Temps passé</span>
                                    <strong>22h 45m</strong>
                                </div>
                                <div class="stat-item">
                                    <span>Points forts</span>
                                    <strong>Synthèses</strong>
                                </div>
                            </div>
                            <button class="btn btn-success" onclick="resumeCourse('chemistry')">
                                <i class="fas fa-play"></i>
                                Reprendre le cours
                            </button>
                        </div>
                    </div>

                    <!-- Français -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon" style="background: var(--info);">
                                <i class="fas fa-feather-alt"></i>
                            </div>
                            <h3 class="card-title">Français</h3>
                        </div>
                        <div class="card-content">
                            <div class="course-progress">
                                <h4>Chapitre actuel : Littérature Contemporaine</h4>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 67%"></div>
                                </div>
                                <p>Œuvre 2/3 étudiée</p>
                            </div>
                            <div class="course-stats">
                                <div class="stat-item">
                                    <span>Note moyenne</span>
                                    <strong>15.8/20</strong>
                                </div>
                                <div class="stat-item">
                                    <span>Temps passé</span>
                                    <strong>16h 20m</strong>
                                </div>
                                <div class="stat-item">
                                    <span>Prochaine dissertation</span>
                                    <strong>Vendredi</strong>
                                </div>
                            </div>
                            <button class="btn btn-info" onclick="resumeCourse('french')">
                                <i class="fas fa-play"></i>
                                Reprendre le cours
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section Quiz Adaptatifs IA -->
            <section id="quiz" class="section">
                <h2 class="section-title">🧠 Quiz Adaptatifs IA</h2>

                <div class="cards-grid">
                    <!-- Quiz Adaptatif Principal -->
                    <div class="card glow-effect">
                        <div class="card-header">
                            <div class="card-icon" style="background: var(--warning);">
                                <i class="fas fa-magic"></i>
                            </div>
                            <h3 class="card-title">Quiz Adaptatif Ultra</h3>
                        </div>
                        <div class="card-content">
                            <p>L'IA analyse votre niveau en temps réel et adapte la difficulté pour maximiser votre apprentissage.</p>
                            <div class="ai-thinking">
                                <span>IA analysant votre profil</span>
                                <div class="ai-dots">
                                    <div class="ai-dot"></div>
                                    <div class="ai-dot"></div>
                                    <div class="ai-dot"></div>
                                </div>
                            </div>
                            <div style="margin: 1rem 0; padding: 1rem; background: rgba(255, 215, 0, 0.1); border-radius: 10px;">
                                <p><strong>🎯 Recommandation :</strong> Quiz Mathématiques niveau Expert</p>
                                <p><strong>⏱️ Temps estimé :</strong> 8-12 minutes</p>
                                <p><strong>🎮 Récompense :</strong> 40-80 XP selon performance</p>
                            </div>
                            <button class="btn btn-warning" onclick="startAdaptiveQuiz()">
                                <i class="fas fa-rocket"></i>
                                Démarrer Quiz IA
                            </button>
                        </div>
                    </div>

                    <!-- Simulation d'Examen -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon" style="background: var(--danger);">
                                <i class="fas fa-graduation-cap"></i>
                            </div>
                            <h3 class="card-title">Simulation BAC 2025</h3>
                        </div>
                        <div class="card-content">
                            <p>Conditions réelles d'examen avec correction instantanée et analyse détaillée.</p>
                            <div class="exam-stats">
                                <p><strong>📊 Dernière simulation :</strong> 15.8/20</p>
                                <p><strong>📈 Progression :</strong> +2.1 points en 2 mois</p>
                                <p><strong>🎯 Objectif :</strong> 16+ (Mention Bien)</p>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 79%"></div>
                            </div>
                            <p class="progress-text">Progression vers objectif: 79%</p>
                            <button class="btn btn-danger" onclick="startExamSimulation()">
                                <i class="fas fa-play"></i>
                                Nouvelle Simulation
                            </button>
                        </div>
                    </div>

                    <!-- Quiz Rapides -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon" style="background: var(--success);">
                                <i class="fas fa-bolt"></i>
                            </div>
                            <h3 class="card-title">Quiz Flash</h3>
                        </div>
                        <div class="card-content">
                            <p>Questions rapides pour réviser en 5 minutes chrono.</p>
                            <div class="quiz-themes">
                                <div class="theme-item" onclick="startFlashQuiz('math')">
                                    <span class="theme-icon">📐</span>
                                    <span>Mathématiques</span>
                                    <span class="theme-count">12 questions</span>
                                </div>
                                <div class="theme-item" onclick="startFlashQuiz('physics')">
                                    <span class="theme-icon">⚛️</span>
                                    <span>Physique</span>
                                    <span class="theme-count">8 questions</span>
                                </div>
                                <div class="theme-item" onclick="startFlashQuiz('chemistry')">
                                    <span class="theme-icon">🧪</span>
                                    <span>Chimie</span>
                                    <span class="theme-count">10 questions</span>
                                </div>
                            </div>
                            <button class="btn btn-success" onclick="startRandomFlashQuiz()">
                                <i class="fas fa-shuffle"></i>
                                Quiz Aléatoire
                            </button>
                        </div>
                    </div>

                    <!-- Défis Hebdomadaires -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon" style="background: var(--info);">
                                <i class="fas fa-trophy"></i>
                            </div>
                            <h3 class="card-title">Défis de la Semaine</h3>
                        </div>
                        <div class="card-content">
                            <div class="weekly-challenges">
                                <div class="challenge-item active">
                                    <div class="challenge-info">
                                        <h4>🎯 Maître des Dérivées</h4>
                                        <p>Réussir 5 quiz sur les dérivées avec 90%+</p>
                                        <div class="challenge-progress">
                                            <div class="progress-bar">
                                                <div class="progress-fill" style="width: 60%"></div>
                                            </div>
                                            <span>3/5 complétés</span>
                                        </div>
                                    </div>
                                    <div class="challenge-reward">250 XP</div>
                                </div>
                                <div class="challenge-item">
                                    <div class="challenge-info">
                                        <h4>⚡ Vitesse Éclair</h4>
                                        <p>Terminer 10 quiz en moins de 2 min chacun</p>
                                        <div class="challenge-progress">
                                            <div class="progress-bar">
                                                <div class="progress-fill" style="width: 30%"></div>
                                            </div>
                                            <span>3/10 complétés</span>
                                        </div>
                                    </div>
                                    <div class="challenge-reward">150 XP</div>
                                </div>
                            </div>
                            <button class="btn btn-info" onclick="viewAllChallenges()">
                                <i class="fas fa-list"></i>
                                Voir tous les défis
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section Mentor IA -->
            <section id="ai" class="section">
                <h2 class="section-title">🤖 Mentor IA</h2>

                <div class="cards-grid">
                    <!-- Chat avec IA -->
                    <div class="card glow-effect">
                        <div class="card-header">
                            <div class="card-icon" style="background: var(--primary);">
                                <i class="fas fa-comments"></i>
                            </div>
                            <h3 class="card-title">Assistant Personnel MEUGACK</h3>
                        </div>
                        <div class="card-content">
                            <div class="ai-chat-container">
                                <div class="ai-messages" id="aiMessages">
                                    <div class="ai-message">
                                        <div class="message-avatar ai">
                                            <i class="fas fa-robot"></i>
                                        </div>
                                        <div class="message-bubble ai">
                                            Salut Richy ! 👋 Je vois que tu progresses bien en mathématiques. As-tu des questions sur les dérivées ? Je peux t'aider avec des explications personnalisées !
                                        </div>
                                    </div>
                                    <div class="ai-message user">
                                        <div class="message-bubble user">
                                            Salut MEUGACK ! J'ai du mal avec les dérivées composées...
                                        </div>
                                        <div class="message-avatar user">R</div>
                                    </div>
                                    <div class="ai-message">
                                        <div class="message-avatar ai">
                                            <i class="fas fa-robot"></i>
                                        </div>
                                        <div class="message-bubble ai">
                                            Parfait ! Les dérivées composées utilisent la règle de la chaîne. Prenons un exemple : si f(x) = (3x²+1)⁵, on pose u = 3x²+1, alors f'(x) = 5u⁴ × u' = 5(3x²+1)⁴ × 6x. Veux-tu plus d'exemples ?
                                        </div>
                                    </div>
                                </div>
                                <div class="ai-input-area">
                                    <input type="text" id="aiInput" placeholder="Pose ta question à MEUGACK..." onkeypress="handleAiInput(event)">
                                    <button class="ai-send-btn" onclick="sendAiMessage()">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Analyse de Performance -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon" style="background: var(--success);">
                                <i class="fas fa-chart-area"></i>
                            </div>
                            <h3 class="card-title">Analyse de Performance IA</h3>
                        </div>
                        <div class="card-content">
                            <div class="ai-thinking">
                                <span>IA analysant 847 points de données...</span>
                                <div class="ai-dots">
                                    <div class="ai-dot"></div>
                                    <div class="ai-dot"></div>
                                    <div class="ai-dot"></div>
                                </div>
                            </div>
                            <div class="performance-insights">
                                <div class="insight-item">
                                    <div class="insight-icon positive">📈</div>
                                    <div class="insight-text">
                                        <strong>Point fort identifié :</strong> Excellente maîtrise des fonctions exponentielles (+15% vs classe)
                                    </div>
                                </div>
                                <div class="insight-item">
                                    <div class="insight-icon warning">⚠️</div>
                                    <div class="insight-text">
                                        <strong>Zone d'amélioration :</strong> Circuits RLC en physique nécessitent plus de pratique
                                    </div>
                                </div>
                                <div class="insight-item">
                                    <div class="insight-icon info">💡</div>
                                    <div class="insight-text">
                                        <strong>Recommandation :</strong> Planifier 30min/jour sur les intégrales pour optimiser vos résultats BAC
                                    </div>
                                </div>
                            </div>
                            <button class="btn btn-success" onclick="generateStudyPlan()">
                                <i class="fas fa-magic"></i>
                                Générer Plan d'Étude IA
                            </button>
                        </div>
                    </div>

                    <!-- Prédictions IA -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon" style="background: var(--info);">
                                <i class="fas fa-crystal-ball"></i>
                            </div>
                            <h3 class="card-title">Prédictions BAC 2025</h3>
                        </div>
                        <div class="card-content">
                            <div class="prediction-display">
                                <div class="prediction-score">
                                    <div class="predicted-average">16.8</div>
                                    <div class="prediction-label">Note prédite BAC</div>
                                    <div class="confidence-level">Confiance: 89%</div>
                                </div>
                                <div class="prediction-breakdown">
                                    <div class="subject-prediction">
                                        <span>Mathématiques</span>
                                        <div class="prediction-bar">
                                            <div class="prediction-fill" style="width: 85%"></div>
                                        </div>
                                        <span>17.2/20</span>
                                    </div>
                                    <div class="subject-prediction">
                                        <span>Physique</span>
                                        <div class="prediction-bar">
                                            <div class="prediction-fill" style="width: 78%"></div>
                                        </div>
                                        <span>15.6/20</span>
                                    </div>
                                    <div class="subject-prediction">
                                        <span>Chimie</span>
                                        <div class="prediction-bar">
                                            <div class="prediction-fill" style="width: 90%"></div>
                                        </div>
                                        <span>18.1/20</span>
                                    </div>
                                </div>
                            </div>
                            <div class="prediction-tips">
                                <h4>💡 Pour atteindre 17+ :</h4>
                                <ul>
                                    <li>Renforcer les circuits électriques (+0.8 pts)</li>
                                    <li>Maîtriser les intégrales par parties (+0.5 pts)</li>
                                    <li>Réviser la cinétique chimique (+0.3 pts)</li>
                                </ul>
                            </div>
                            <button class="btn btn-info" onclick="viewDetailedPredictions()">
                                <i class="fas fa-chart-line"></i>
                                Analyse Détaillée
                            </button>
                        </div>
                    </div>

                    <!-- Contenu Personnalisé -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon" style="background: var(--warning);">
                                <i class="fas fa-magic"></i>
                            </div>
                            <h3 class="card-title">Contenu Adaptatif</h3>
                        </div>
                        <div class="card-content">
                            <p>L'IA génère du contenu personnalisé selon votre profil d'apprentissage visuel.</p>
                            <div class="adaptive-content">
                                <div class="content-type active">
                                    <div class="content-icon">📊</div>
                                    <div class="content-info">
                                        <h4>Diagrammes Interactifs</h4>
                                        <p>Visualisations dynamiques adaptées à votre style</p>
                                    </div>
                                </div>
                                <div class="content-type">
                                    <div class="content-icon">🎥</div>
                                    <div class="content-info">
                                        <h4>Vidéos Personnalisées</h4>
                                        <p>Explications courtes ciblées sur vos lacunes</p>
                                    </div>
                                </div>
                                <div class="content-type">
                                    <div class="content-icon">🧩</div>
                                    <div class="content-info">
                                        <h4>Exercices Adaptatifs</h4>
                                        <p>Problèmes calibrés à votre niveau exact</p>
                                    </div>
                                </div>
                            </div>
                            <button class="btn btn-warning" onclick="generatePersonalizedContent()">
                                <i class="fas fa-wand-magic-sparkles"></i>
                                Générer Contenu IA
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section temporaire pour les autres sections -->
            <section id="analytics" class="section">
                <h2 class="section-title">📈 Analytics Avancés</h2>

                <!-- Prédictions BAC -->
                <div class="card analytics-predictions">
                    <div class="card-header">
                        <h3><i class="fas fa-crystal-ball"></i> Prédictions BAC 2025</h3>
                        <div class="prediction-confidence">98% de fiabilité</div>
                    </div>
                    <div class="card-content">
                        <div class="prediction-grid">
                            <div class="prediction-item">
                                <div class="subject">Mathématiques</div>
                                <div class="prediction-bar">
                                    <div class="prediction-fill math" style="width: 85%"></div>
                                    <span class="prediction-score">17.2/20</span>
                                </div>
                            </div>
                            <div class="prediction-item">
                                <div class="subject">Physique-Chimie</div>
                                <div class="prediction-bar">
                                    <div class="prediction-fill physics" style="width: 78%"></div>
                                    <span class="prediction-score">15.6/20</span>
                                </div>
                            </div>
                            <div class="prediction-item">
                                <div class="subject">Français</div>
                                <div class="prediction-bar">
                                    <div class="prediction-fill french" style="width: 88%"></div>
                                    <span class="prediction-score">17.6/20</span>
                                </div>
                            </div>
                            <div class="prediction-item">
                                <div class="subject">Histoire-Géo</div>
                                <div class="prediction-bar">
                                    <div class="prediction-fill history" style="width: 82%"></div>
                                    <span class="prediction-score">16.4/20</span>
                                </div>
                            </div>
                        </div>
                        <div class="overall-prediction">
                            <div class="mention-prediction">
                                <i class="fas fa-trophy"></i>
                                <span>Mention Très Bien (91% probable)</span>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="viewDetailedPredictions()">
                            <i class="fas fa-chart-line"></i> Analyse Détaillée
                        </button>
                    </div>
                </div>

                <!-- Performance en temps réel -->
                <div class="card real-time-analytics">
                    <div class="card-header">
                        <h3><i class="fas fa-chart-area"></i> Performance en Temps Réel</h3>
                        <div class="analytics-period">7 derniers jours</div>
                    </div>
                    <div class="card-content">
                        <div class="analytics-grid">
                            <div class="analytics-metric">
                                <div class="metric-icon success">
                                    <i class="fas fa-bullseye"></i>
                                </div>
                                <div class="metric-info">
                                    <div class="metric-value">87%</div>
                                    <div class="metric-label">Taux de réussite</div>
                                    <div class="metric-trend positive">+5% cette semaine</div>
                                </div>
                            </div>
                            <div class="analytics-metric">
                                <div class="metric-icon info">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div class="metric-info">
                                    <div class="metric-value">2h 45m</div>
                                    <div class="metric-label">Temps d'étude moyen</div>
                                    <div class="metric-trend positive">+15min cette semaine</div>
                                </div>
                            </div>
                            <div class="analytics-metric">
                                <div class="metric-icon warning">
                                    <i class="fas fa-fire"></i>
                                </div>
                                <div class="metric-info">
                                    <div class="metric-value">12 jours</div>
                                    <div class="metric-label">Série actuelle</div>
                                    <div class="metric-trend positive">Record personnel !</div>
                                </div>
                            </div>
                            <div class="analytics-metric">
                                <div class="metric-icon primary">
                                    <i class="fas fa-brain"></i>
                                </div>
                                <div class="metric-info">
                                    <div class="metric-value">84%</div>
                                    <div class="metric-label">Efficacité cognitive</div>
                                    <div class="metric-trend positive">Optimal</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Analyse des points faibles -->
                <div class="card weakness-analysis">
                    <div class="card-header">
                        <h3><i class="fas fa-search"></i> Analyse des Points d'Amélioration</h3>
                    </div>
                    <div class="card-content">
                        <div class="weakness-list">
                            <div class="weakness-item high">
                                <div class="weakness-icon">⚠️</div>
                                <div class="weakness-info">
                                    <div class="weakness-title">Dérivées complexes (Maths)</div>
                                    <div class="weakness-desc">Taux d'erreur: 32% - Révisions suggérées</div>
                                    <div class="weakness-actions">
                                        <button class="btn btn-sm btn-primary">Réviser maintenant</button>
                                        <button class="btn btn-sm btn-secondary">Quiz adaptatif</button>
                                    </div>
                                </div>
                            </div>
                            <div class="weakness-item medium">
                                <div class="weakness-icon">📊</div>
                                <div class="weakness-info">
                                    <div class="weakness-title">Équilibrage équations (Chimie)</div>
                                    <div class="weakness-desc">Taux d'erreur: 18% - En amélioration</div>
                                    <div class="weakness-actions">
                                        <button class="btn btn-sm btn-info">Exercices ciblés</button>
                                    </div>
                                </div>
                            </div>
                            <div class="weakness-item low">
                                <div class="weakness-icon">✅</div>
                                <div class="weakness-info">
                                    <div class="weakness-title">Analyse littéraire (Français)</div>
                                    <div class="weakness-desc">Taux d'erreur: 8% - Excellent niveau</div>
                                    <div class="weakness-actions">
                                        <button class="btn btn-sm btn-success">Continuer</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recommandations IA -->
                <div class="card ai-recommendations">
                    <div class="card-header">
                        <h3><i class="fas fa-robot"></i> Recommandations Personnalisées</h3>
                        <div class="recommendation-confidence">IA MEUGACK - Fiabilité 96%</div>
                    </div>
                    <div class="card-content">
                        <div class="recommendation-list">
                            <div class="recommendation-item priority-high">
                                <div class="recommendation-icon">🎯</div>
                                <div class="recommendation-content">
                                    <div class="recommendation-title">Session Mathématiques Intensive</div>
                                    <div class="recommendation-desc">
                                        Planifiez 90 minutes de mathématiques aujourd'hui (14h-15h30)
                                        basé sur votre pic de concentration identifié.
                                    </div>
                                    <div class="recommendation-stats">Impact prévu: +2.3 points au BAC</div>
                                </div>
                                <button class="btn btn-primary">Programmer</button>
                            </div>
                            <div class="recommendation-item priority-medium">
                                <div class="recommendation-icon">📚</div>
                                <div class="recommendation-content">
                                    <div class="recommendation-title">Pause et Révision Espacée</div>
                                    <div class="recommendation-desc">
                                        Révisez les concepts vus il y a 3 jours pour optimiser
                                        la mémorisation à long terme.
                                    </div>
                                    <div class="recommendation-stats">Efficacité mémorisation: +45%</div>
                                </div>
                                <button class="btn btn-secondary">Voir révisions</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section temporaire pour les autres sections -->
            <section id="achievements" class="section">
                <h2 class="section-title">🏆 Accomplissements</h2>

                <!-- Progression générale -->
                <div class="card achievement-overview">
                    <div class="card-header">
                        <h3><i class="fas fa-star"></i> Progression Globale</h3>
                        <div class="achievement-stats">67 badges débloqués</div>
                    </div>
                    <div class="card-content">
                        <div class="level-progression">
                            <div class="current-level">
                                <div class="level-badge">15</div>
                                <div class="level-info">
                                    <div class="level-title">Expert Studieux</div>
                                    <div class="level-desc">Tu maîtrises l'art de l'étude efficace</div>
                                </div>
                            </div>
                            <div class="xp-bar-container">
                                <div class="xp-bar">
                                    <div class="xp-fill" style="width: 73%"></div>
                                </div>
                                <div class="xp-text">2,890 / 4,000 XP</div>
                            </div>
                            <div class="next-level">
                                <div class="next-level-preview">
                                    <i class="fas fa-crown"></i>
                                    <span>Niveau 16: Maître Académique</span>
                                    <div class="remaining">1,110 XP restants</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Badges récents -->
                <div class="card recent-badges">
                    <div class="card-header">
                        <h3><i class="fas fa-medal"></i> Badges Récents</h3>
                    </div>
                    <div class="card-content">
                        <div class="badge-grid">
                            <div class="achievement-badge new">
                                <div class="badge-icon gold">🎯</div>
                                <div class="badge-info">
                                    <div class="badge-name">Précision Maximale</div>
                                    <div class="badge-desc">10 quiz consécutifs avec 95%+ de réussite</div>
                                    <div class="badge-date">Obtenu il y a 2 heures</div>
                                </div>
                            </div>
                            <div class="achievement-badge new">
                                <div class="badge-icon silver">📚</div>
                                <div class="badge-info">
                                    <div class="badge-name">Marathon d'Étude</div>
                                    <div class="badge-desc">5 heures d'étude continue</div>
                                    <div class="badge-date">Obtenu hier</div>
                                </div>
                            </div>
                            <div class="achievement-badge">
                                <div class="badge-icon bronze">🔥</div>
                                <div class="badge-info">
                                    <div class="badge-name">Série de 7 jours</div>
                                    <div class="badge-desc">Une semaine d'activité quotidienne</div>
                                    <div class="badge-date">Obtenu il y a 3 jours</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Collections de badges par catégorie -->
                <div class="card badge-collections">
                    <div class="card-header">
                        <h3><i class="fas fa-collection"></i> Collections de Badges</h3>
                    </div>
                    <div class="card-content">
                        <div class="collection-tabs">
                            <button class="tab-btn active" onclick="showBadgeCategory('performance')">🎯 Performance</button>
                            <button class="tab-btn" onclick="showBadgeCategory('persistence')">🔥 Persévérance</button>
                            <button class="tab-btn" onclick="showBadgeCategory('knowledge')">🧠 Connaissance</button>
                            <button class="tab-btn" onclick="showBadgeCategory('special')">⭐ Spéciaux</button>
                        </div>

                        <div id="performance-badges" class="badge-category active">
                            <div class="category-grid">
                                <div class="badge-item earned">
                                    <div class="badge-visual gold">🎯</div>
                                    <div class="badge-title">Précision Maximale</div>
                                    <div class="badge-progress">Complété</div>
                                </div>
                                <div class="badge-item earned">
                                    <div class="badge-visual silver">📊</div>
                                    <div class="badge-title">Analyste Pro</div>
                                    <div class="badge-progress">Complété</div>
                                </div>
                                <div class="badge-item earned">
                                    <div class="badge-visual bronze">⚡</div>
                                    <div class="badge-title">Vitesse d'Éclair</div>
                                    <div class="badge-progress">Complété</div>
                                </div>
                                <div class="badge-item locked">
                                    <div class="badge-visual">🏆</div>
                                    <div class="badge-title">Perfection Ultime</div>
                                    <div class="badge-progress">20 quiz parfaits (15/20)</div>
                                </div>
                            </div>
                        </div>

                        <div id="persistence-badges" class="badge-category">
                            <div class="category-grid">
                                <div class="badge-item earned">
                                    <div class="badge-visual gold">🔥</div>
                                    <div class="badge-title">Série de 7 jours</div>
                                    <div class="badge-progress">Complété</div>
                                </div>
                                <div class="badge-item in-progress">
                                    <div class="badge-visual">📅</div>
                                    <div class="badge-title">Série de 30 jours</div>
                                    <div class="badge-progress">12/30 jours</div>
                                </div>
                                <div class="badge-item locked">
                                    <div class="badge-visual">🎖️</div>
                                    <div class="badge-title">Centurion</div>
                                    <div class="badge-progress">100 jours consécutifs</div>
                                </div>
                            </div>
                        </div>

                        <div id="knowledge-badges" class="badge-category">
                            <div class="category-grid">
                                <div class="badge-item earned">
                                    <div class="badge-visual gold">🧮</div>
                                    <div class="badge-title">Maître des Maths</div>
                                    <div class="badge-progress">Complété</div>
                                </div>
                                <div class="badge-item earned">
                                    <div class="badge-visual silver">⚗️</div>
                                    <div class="badge-title">Alchimiste Moderne</div>
                                    <div class="badge-progress">Complété</div>
                                </div>
                                <div class="badge-item in-progress">
                                    <div class="badge-visual">📖</div>
                                    <div class="badge-title">Littéraire Accompli</div>
                                    <div class="badge-progress">85/100 points</div>
                                </div>
                            </div>
                        </div>

                        <div id="special-badges" class="badge-category">
                            <div class="category-grid">
                                <div class="badge-item earned">
                                    <div class="badge-visual legendary">🌟</div>
                                    <div class="badge-title">Pionnier MEUGACK</div>
                                    <div class="badge-progress">Badge exclusif</div>
                                </div>
                                <div class="badge-item locked">
                                    <div class="badge-visual">👑</div>
                                    <div class="badge-title">Prix Claudine</div>
                                    <div class="badge-progress">Concours annuel</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Défis en cours -->
                <div class="card current-challenges">
                    <div class="card-header">
                        <h3><i class="fas fa-trophy"></i> Défis en Cours</h3>
                        <button class="btn btn-secondary btn-sm" onclick="viewAllChallenges()">Voir tous</button>
                    </div>
                    <div class="card-content">
                        <div class="challenge-list">
                            <div class="challenge-item active">
                                <div class="challenge-icon">🎯</div>
                                <div class="challenge-info">
                                    <div class="challenge-title">Semaine de la Précision</div>
                                    <div class="challenge-desc">Maintenir 90%+ de réussite pendant 7 jours</div>
                                    <div class="challenge-progress">
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 57%"></div>
                                        </div>
                                        <span>4/7 jours</span>
                                    </div>
                                    <div class="challenge-reward">Récompense: 500 XP + Badge Or</div>
                                </div>
                                <div class="challenge-timer">3j 12h</div>
                            </div>
                            <div class="challenge-item">
                                <div class="challenge-icon">📚</div>
                                <div class="challenge-info">
                                    <div class="challenge-title">Marathon Mensuel</div>
                                    <div class="challenge-desc">50 heures d'étude ce mois</div>
                                    <div class="challenge-progress">
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 72%"></div>
                                        </div>
                                        <span>36/50 heures</span>
                                    </div>
                                    <div class="challenge-reward">Récompense: 1000 XP + Badge Légendaire</div>
                                </div>
                                <div class="challenge-timer">12j</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section temporaire pour les autres sections -->
            <section id="claudine-award" class="section">
                <h2 class="section-title">🎖️ Prix Claudine "La force du savoir en héritage"</h2>

                <!-- Présentation du concours -->
                <div class="card claudine-presentation">
                    <div class="card-header">
                        <h3><i class="fas fa-trophy"></i> Concours d'Excellence 2025</h3>
                        <div class="award-status">Inscriptions ouvertes</div>
                    </div>
                    <div class="card-content">
                        <div class="award-description">
                            <p>Le Prix Claudine en hommage à Meffo TCHANDJIO Claudine (Mètah)
récompense les étudiants les plus prometteurs en sciences et littérature.
                            Ce concours prestigieux offre des bourses d'études et une reconnaissance nationale.</p>
                        </div>
                        <div class="award-stats">
                            <div class="stat-item">
                                <div class="stat-number">1,247</div>
                                <div class="stat-label">Participants 2024</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number">50</div>
                                <div class="stat-label">Lauréats</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number">1,000,000 FCFA</div>
                                <div class="stat-label">Bourse Grand Prix</div>
                            </div>
                        </div>
                        <div class="award-actions">
                            <button class="btn btn-primary" onclick="registerForAward()">S'inscrire au concours</button>
                            <button class="btn btn-secondary" onclick="viewAwardHistory()">Voir les lauréats</button>
                        </div>
                    </div>
                </div>

                <!-- Lauréats du Prix Claudine -->
                <div class="card laureates-section">
                    <div class="card-header">
                        <h3><i class="fas fa-crown"></i> Lauréats du Prix Claudine</h3>
                        <div class="laureates-year">Promotion 2024</div>
                    </div>
                    <div class="card-content">
                        <div class="laureates-intro">
                            <p>Félicitations aux brillants lauréats de cette année qui ont su se distinguer par leur excellence académique et leur engagement exceptionnel.</p>
                        </div>

                        <div class="laureates-grid">
                            <div class="laureate-card gold">
                                <div class="laureate-rank">
                                    <div class="rank-medal">🥇</div>
                                    <div class="rank-title">Grand Prix</div>
                                </div>
                                <div class="laureate-info">
                                    <div class="laureate-avatar">👩‍🎓</div>
                                    <div class="laureate-details">
                                        <div class="laureate-name">Pascale NGUENG</div>
                                        <div class="laureate-specialty">Sciences Mathématiques</div>
                                        <div class="laureate-school">Lycée d'Excellence</div>
                                        <div class="laureate-achievement">
                                            <span class="achievement-badge">🏆</span>
                                            <span>Moyenne générale: 19.8/20</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="laureate-distinctions">
                                    <div class="distinction-item">
                                        <i class="fas fa-star"></i>
                                        <span>Mention Très Bien avec félicitations</span>
                                    </div>
                                    <div class="distinction-item">
                                        <i class="fas fa-trophy"></i>
                                        <span>Prix d'excellence en Mathématiques</span>
                                    </div>
                                </div>
                            </div>

                            <div class="laureate-card silver">
                                <div class="laureate-rank">
                                    <div class="rank-medal">🥈</div>
                                    <div class="rank-title">Prix d'Honneur</div>
                                </div>
                                <div class="laureate-info">
                                    <div class="laureate-avatar">👨‍🎓</div>
                                    <div class="laureate-details">
                                        <div class="laureate-name">Fanuel TCHANDJIO</div>
                                        <div class="laureate-specialty">Sciences Physiques</div>
                                        <div class="laureate-school">Lycée International</div>
                                        <div class="laureate-achievement">
                                            <span class="achievement-badge">🎯</span>
                                            <span>Moyenne générale: 19.2/20</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="laureate-distinctions">
                                    <div class="distinction-item">
                                        <i class="fas fa-star"></i>
                                        <span>Mention Très Bien</span>
                                    </div>
                                    <div class="distinction-item">
                                        <i class="fas fa-atom"></i>
                                        <span>Prix d'excellence en Physique</span>
                                    </div>
                                </div>
                            </div>

                            <div class="laureate-card bronze">
                                <div class="laureate-rank">
                                    <div class="rank-medal">🥉</div>
                                    <div class="rank-title">Prix du Mérite</div>
                                </div>
                                <div class="laureate-info">
                                    <div class="laureate-avatar">👨‍🎓</div>
                                    <div class="laureate-details">
                                        <div class="laureate-name">Beltrade YOUGANG</div>
                                        <div class="laureate-specialty">Sciences Naturelles</div>
                                        <div class="laureate-school">Lycée Scientifique</div>
                                        <div class="laureate-achievement">
                                            <span class="achievement-badge">🔬</span>
                                            <span>Moyenne générale: 18.9/20</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="laureate-distinctions">
                                    <div class="distinction-item">
                                        <i class="fas fa-star"></i>
                                        <span>Mention Très Bien</span>
                                    </div>
                                    <div class="distinction-item">
                                        <i class="fas fa-seedling"></i>
                                        <span>Prix d'excellence en Biologie</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="laureates-ceremony">
                            <div class="ceremony-info">
                                <div class="ceremony-icon">🎊</div>
                                <div class="ceremony-details">
                                    <div class="ceremony-title">Cérémonie de Remise des Prix</div>
                                    <div class="ceremony-date">📅 16 Novembre 2025 - PROJEXTS, Amphithéâtre NONO</div>
                                    <div class="ceremony-description">
                                        Une cérémonie exceptionnelle en présence des familles, professeurs et personnalités du monde académique.
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="laureates-actions">
                            <button class="btn btn-primary" onclick="congratulateLaureates()">
                                <i class="fas fa-heart"></i> Féliciter les lauréats
                            </button>
                            <button class="btn btn-secondary" onclick="viewPreviousYears()">
                                <i class="fas fa-history"></i> Voir les années précédentes
                            </button>
                            <button class="btn btn-info" onclick="downloadCertificates()">
                                <i class="fas fa-certificate"></i> Télécharger les certificats
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Votre progression -->
                <div class="card award-progress">
                    <div class="card-header">
                        <h3><i class="fas fa-chart-line"></i> Votre Progression</h3>
                        <div class="eligibility-score">Score: 847/1000</div>
                    </div>
                    <div class="card-content">
                        <div class="progress-criteria">
                            <div class="criteria-item completed">
                                <div class="criteria-icon">✅</div>
                                <div class="criteria-info">
                                    <div class="criteria-title">Moyenne générale > 16</div>
                                    <div class="criteria-desc" id="prix-claudine-average">Votre moyenne: 0.0/20</div>
                                </div>
                                <div class="criteria-points">+200 pts</div>
                            </div>
                            <div class="criteria-item completed">
                                <div class="criteria-icon">✅</div>
                                <div class="criteria-info">
                                    <div class="criteria-title">Assiduité parfaite</div>
                                    <div class="criteria-desc">12 jours consécutifs</div>
                                </div>
                                <div class="criteria-points">+150 pts</div>
                            </div>
                            <div class="criteria-item in-progress">
                                <div class="criteria-icon">🔄</div>
                                <div class="criteria-info">
                                    <div class="criteria-title">Projets spéciaux</div>
                                    <div class="criteria-desc">2/3 projets réalisés</div>
                                </div>
                                <div class="criteria-points">+120/180 pts</div>
                            </div>
                            <div class="criteria-item pending">
                                <div class="criteria-icon">⏰</div>
                                <div class="criteria-info">
                                    <div class="criteria-title">Lettre de motivation</div>
                                    <div class="criteria-desc">À rédiger avant le 15/12</div>
                                </div>
                                <div class="criteria-points">+0/200 pts</div>
                            </div>
                            <div class="criteria-item pending">
                                <div class="criteria-icon">📝</div>
                                <div class="criteria-info">
                                    <div class="criteria-title">Épreuve écrite</div>
                                    <div class="criteria-desc">Examen final - Janvier 2025</div>
                                </div>
                                <div class="criteria-points">+0/300 pts</div>
                            </div>
                        </div>
                        <div class="progress-summary">
                            <div class="current-rank">
                                <i class="fas fa-medal"></i>
                                <span>Rang actuel: 23/1,247 participants</span>
                            </div>
                            <div class="qualification-status qualified">
                                🎉 Qualifié(e) pour la phase finale !
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Préparation et ressources -->
                <div class="card award-preparation">
                    <div class="card-header">
                        <h3><i class="fas fa-book-open"></i> Préparation</h3>
                    </div>
                    <div class="card-content">
                        <div class="preparation-resources">
                            <div class="resource-item">
                                <div class="resource-icon">📚</div>
                                <div class="resource-info">
                                    <div class="resource-title">Annales du concours</div>
                                    <div class="resource-desc">Sujets des 5 dernières années</div>
                                </div>
                                <button class="btn btn-sm btn-primary">Télécharger</button>
                            </div>
                            <div class="resource-item">
                                <div class="resource-icon">🎥</div>
                                <div class="resource-info">
                                    <div class="resource-title">Masterclass vidéo</div>
                                    <div class="resource-desc">Conseils des anciens lauréats</div>
                                </div>
                                <button class="btn btn-sm btn-secondary">Regarder</button>
                            </div>
                            <div class="resource-item">
                                <div class="resource-icon">👥</div>
                                <div class="resource-info">
                                    <div class="resource-title">Groupe de préparation</div>
                                    <div class="resource-desc">15 candidats actifs</div>
                                </div>
                                <button class="btn btn-sm btn-success">Rejoindre</button>
                            </div>
                        </div>

                        <div class="timeline-container">
                            <h4>🗺️ Calendrier 2025</h4>
                            <div class="timeline">
                                <div class="timeline-item completed">
                                    <div class="timeline-date">Oct 2024</div>
                                    <div class="timeline-content">
                                        <div class="timeline-title">Ouverture inscriptions</div>
                                        <div class="timeline-status">✅ Terminé</div>
                                    </div>
                                </div>
                                <div class="timeline-item current">
                                    <div class="timeline-date">Déc 2024</div>
                                    <div class="timeline-content">
                                        <div class="timeline-title">Date limite dossiers</div>
                                        <div class="timeline-status">🔄 En cours</div>
                                    </div>
                                </div>
                                <div class="timeline-item">
                                    <div class="timeline-date">Jan 2025</div>
                                    <div class="timeline-content">
                                        <div class="timeline-title">Épreuve écrite</div>
                                        <div class="timeline-status">⏰ À venir</div>
                                    </div>
                                </div>
                                <div class="timeline-item">
                                    <div class="timeline-date">Mar 2025</div>
                                    <div class="timeline-content">
                                        <div class="timeline-title">Résultats finaux</div>
                                        <div class="timeline-status">⏰ À venir</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section temporaire pour les autres sections -->
            <section id="revisions" class="section">
                <h2 class="section-title">📖 Révisions IA</h2>

                <!-- Planning de révisions intelligent -->
                <div class="card revision-planning">
                    <div class="card-header">
                        <h3><i class="fas fa-calendar-alt"></i> Planning Intelligent</h3>
                        <div class="planning-status">Optimisé par IA</div>
                    </div>
                    <div class="card-content">
                        <div class="weekly-schedule">
                            <div class="schedule-header">
                                <h4>Semaine du 9-15 Décembre 2024</h4>
                                <div class="efficiency-score">Efficacité prévue: 91%</div>
                            </div>
                            <div class="schedule-grid">
                                <div class="schedule-day">
                                    <div class="day-header">Aujourd'hui</div>
                                    <div class="day-sessions">
                                        <div class="session urgent">
                                            <div class="session-time">14h00 - 15h30</div>
                                            <div class="session-subject">📐 Mathématiques</div>
                                            <div class="session-topic">Dérivées complexes</div>
                                            <div class="session-priority">Priorité max</div>
                                        </div>
                                        <div class="session normal">
                                            <div class="session-time">16h00 - 17h00</div>
                                            <div class="session-subject">⚗️ Chimie</div>
                                            <div class="session-topic">Révisions cinétique</div>
                                            <div class="session-priority">Révision</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="schedule-day">
                                    <div class="day-header">Demain</div>
                                    <div class="day-sessions">
                                        <div class="session normal">
                                            <div class="session-time">10h00 - 11h30</div>
                                            <div class="session-subject">📚 Français</div>
                                            <div class="session-topic">Dissertation</div>
                                        </div>
                                        <div class="session light">
                                            <div class="session-time">15h00 - 16h00</div>
                                            <div class="session-subject">🗺️ Histoire</div>
                                            <div class="session-topic">Révisions espacées</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="schedule-actions">
                                <button class="btn btn-primary" onclick="optimizeSchedule()">Ré-optimiser</button>
                                <button class="btn btn-secondary" onclick="customizeSchedule()">Personnaliser</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Fiches de révision IA -->
                <div class="card ai-flashcards">
                    <div class="card-header">
                        <h3><i class="fas fa-layer-group"></i> Fiches Générées par IA</h3>
                        <button class="btn btn-primary btn-sm" onclick="generateNewFlashcards()">Générer nouvelles fiches</button>
                    </div>
                    <div class="card-content">
                        <div class="flashcard-categories">
                            <div class="category-tab active" onclick="showFlashcardCategory('urgent')">
                                ⚠️ Urgent (12)
                            </div>
                            <div class="category-tab" onclick="showFlashcardCategory('review')">
                                🔄 À revoir (23)
                            </div>
                            <div class="category-tab" onclick="showFlashcardCategory('mastered')">
                                ✅ Maîtrisé (156)
                            </div>
                        </div>

                        <div id="urgent-flashcards" class="flashcard-category active">
                            <div class="flashcard-deck">
                                <div class="flashcard-item priority-high">
                                    <div class="flashcard-subject">📐 Mathématiques</div>
                                    <div class="flashcard-question">Comment calculer la dérivée de ln(x²+1) ?</div>
                                    <div class="flashcard-meta">
                                        <span class="difficulty hard">Difficile</span>
                                        <span class="last-seen">Vu il y a 3 jours</span>
                                        <span class="success-rate">32% de réussite</span>
                                    </div>
                                    <div class="flashcard-actions">
                                        <button class="btn btn-sm btn-primary">Réviser</button>
                                        <button class="btn btn-sm btn-secondary">Voir solution</button>
                                    </div>
                                </div>
                                <div class="flashcard-item priority-medium">
                                    <div class="flashcard-subject">⚗️ Chimie</div>
                                    <div class="flashcard-question">Équilibrer: C₂H₅OH + O₂ → CO₂ + H₂O</div>
                                    <div class="flashcard-meta">
                                        <span class="difficulty medium">Moyen</span>
                                        <span class="last-seen">Vu il y a 2 jours</span>
                                        <span class="success-rate">67% de réussite</span>
                                    </div>
                                    <div class="flashcard-actions">
                                        <button class="btn btn-sm btn-primary">Réviser</button>
                                        <button class="btn btn-sm btn-secondary">Voir solution</button>
                                    </div>
                                </div>
                                <div class="flashcard-item priority-high">
                                    <div class="flashcard-subject">📚 Français</div>
                                    <div class="flashcard-question">Structure d'une dissertation littéraire</div>
                                    <div class="flashcard-meta">
                                        <span class="difficulty easy">Facile</span>
                                        <span class="last-seen">Vu il y a 1 jour</span>
                                        <span class="success-rate">89% de réussite</span>
                                    </div>
                                    <div class="flashcard-actions">
                                        <button class="btn btn-sm btn-success">Valider</button>
                                        <button class="btn btn-sm btn-secondary">Détails</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="review-flashcards" class="flashcard-category">
                            <div class="coming-soon">23 fiches en révision espacée</div>
                        </div>

                        <div id="mastered-flashcards" class="flashcard-category">
                            <div class="coming-soon">156 concepts maîtrisés</div>
                        </div>
                    </div>
                </div>

                <!-- Session de révision active -->
                <div class="card active-revision">
                    <div class="card-header">
                        <h3><i class="fas fa-play-circle"></i> Session en Cours</h3>
                        <div class="session-timer">23:45 restantes</div>
                    </div>
                    <div class="card-content">
                        <div class="current-session">
                            <div class="session-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 65%"></div>
                                </div>
                                <div class="progress-stats">
                                    <span>13/20 concepts révisés</span>
                                    <span>85% de réussite</span>
                                </div>
                            </div>
                            <div class="session-subject-focus">
                                <div class="subject-icon">📐</div>
                                <div class="subject-info">
                                    <div class="subject-name">Mathématiques - Dérivées</div>
                                    <div class="subject-progress">Chapitre 7/12</div>
                                </div>
                            </div>
                            <div class="session-controls">
                                <button class="btn btn-warning" onclick="pauseRevision()">⏸️ Pause</button>
                                <button class="btn btn-success" onclick="continueRevision()">▶️ Continuer</button>
                                <button class="btn btn-danger" onclick="endRevision()">⏹️ Terminer</button>
                            </div>
                        </div>

                        <div class="revision-insights">
                            <div class="insight-item">
                                <div class="insight-icon">📈</div>
                                <div class="insight-text">Progression 23% plus rapide que prévu</div>
                            </div>
                            <div class="insight-item">
                                <div class="insight-icon">🎯</div>
                                <div class="insight-text">Focus optimal détecté - continuez !</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section temporaire pour les autres sections -->
            <section id="orientation" class="section">
                <h2 class="section-title">🎯 Orientation</h2>

                <!-- Recommandations IA personnalisées -->
                <div class="card ai-orientation">
                    <div class="card-header">
                        <h3><i class="fas fa-robot"></i> Recommandations IA Personnalisées</h3>
                        <div class="ai-confidence">Fiabilité : 94%</div>
                    </div>
                    <div class="card-content">
                        <div class="recommendation-summary">
                            <div class="profile-match">
                                <div class="match-icon">🎯</div>
                                <div class="match-info">
                                    <div class="match-title">Profil détecté : Scientifique Analytique</div>
                                    <div class="match-desc">Forces en mathématiques et sciences, esprit logique développé</div>
                                </div>
                            </div>
                        </div>

                        <div class="top-recommendations">
                            <div class="recommendation-item priority-1">
                                <div class="rec-rank">1</div>
                                <div class="rec-field">
                                    <div class="field-icon">💻</div>
                                    <div class="field-name">Ingénierie Informatique</div>
                                </div>
                                <div class="rec-match">
                                    <div class="match-score">96%</div>
                                    <div class="match-reasons">
                                        <span>Maths excellentes</span>
                                        <span>Logique développée</span>
                                    </div>
                                </div>
                                <button class="btn btn-sm btn-primary" onclick="exploreCareer('informatique')">Explorer</button>
                            </div>

                            <div class="recommendation-item priority-2">
                                <div class="rec-rank">2</div>
                                <div class="rec-field">
                                    <div class="field-icon">🏗️</div>
                                    <div class="field-name">Génie Civil</div>
                                </div>
                                <div class="rec-match">
                                    <div class="match-score">89%</div>
                                    <div class="match-reasons">
                                        <span>Physique forte</span>
                                        <span>Spatial développé</span>
                                    </div>
                                </div>
                                <button class="btn btn-sm btn-secondary" onclick="exploreCareer('genie-civil')">Explorer</button>
                            </div>

                            <div class="recommendation-item priority-3">
                                <div class="rec-rank">3</div>
                                <div class="rec-field">
                                    <div class="field-icon">🧪</div>
                                    <div class="field-name">Recherche en Chimie</div>
                                </div>
                                <div class="rec-match">
                                    <div class="match-score">83%</div>
                                    <div class="match-reasons">
                                        <span>Chimie passion</span>
                                        <span>Recherche attirance</span>
                                    </div>
                                </div>
                                <button class="btn btn-sm btn-info" onclick="exploreCareer('chimie')">Explorer</button>
                            </div>
                        </div>

                        <div class="recommendation-actions">
                            <button class="btn btn-primary" onclick="generateDetailedPath()">
                                <i class="fas fa-route"></i> Générer parcours détaillé
                            </button>
                            <button class="btn btn-secondary" onclick="takeOrientationQuiz()">
                                <i class="fas fa-question-circle"></i> Affiner avec quiz
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Explorer les filières -->
                <div class="card career-explorer">
                    <div class="card-header">
                        <h3><i class="fas fa-compass"></i> Explorer les Filières</h3>
                    </div>
                    <div class="card-content">
                        <div class="career-categories">
                            <div class="category-grid">
                                <div class="career-category" onclick="showCareerCategory('sciences')">
                                    <div class="category-icon">🧬</div>
                                    <div class="category-name">Sciences & Tech</div>
                                    <div class="category-count">24 métiers</div>
                                </div>
                                <div class="career-category" onclick="showCareerCategory('sante')">
                                    <div class="category-icon">🏥</div>
                                    <div class="category-name">Santé</div>
                                    <div class="category-count">18 métiers</div>
                                </div>
                                <div class="career-category" onclick="showCareerCategory('ingenierie')">
                                    <div class="category-icon">⚙️</div>
                                    <div class="category-name">Ingénierie</div>
                                    <div class="category-count">31 métiers</div>
                                </div>
                                <div class="career-category" onclick="showCareerCategory('economie')">
                                    <div class="category-icon">💼</div>
                                    <div class="category-name">Économie</div>
                                    <div class="category-count">22 métiers</div>
                                </div>
                                <div class="career-category" onclick="showCareerCategory('humaines')">
                                    <div class="category-icon">📚</div>
                                    <div class="category-name">Sciences Humaines</div>
                                    <div class="category-count">19 métiers</div>
                                </div>
                                <div class="career-category" onclick="showCareerCategory('art')">
                                    <div class="category-icon">🎨</div>
                                    <div class="category-name">Arts & Création</div>
                                    <div class="category-count">15 métiers</div>
                                </div>
                            </div>
                        </div>

                        <div class="trending-careers">
                            <h4>🔥 Métiers d'avenir 2025</h4>
                            <div class="trending-list">
                                <div class="trending-item">
                                    <div class="trending-badge">NEW</div>
                                    <div class="trending-name">IA Specialist</div>
                                    <div class="trending-growth">+127% demande</div>
                                </div>
                                <div class="trending-item">
                                    <div class="trending-badge">HOT</div>
                                    <div class="trending-name">Data Scientist</div>
                                    <div class="trending-growth">+89% demande</div>
                                </div>
                                <div class="trending-item">
                                    <div class="trending-badge">⭐</div>
                                    <div class="trending-name">Ingénieur Green Tech</div>
                                    <div class="trending-growth">+156% demande</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Établissements et formations -->
                <div class="card institutions-explorer">
                    <div class="card-header">
                        <h3><i class="fas fa-university"></i> Établissements & Formations</h3>
                        <div class="location-filter">
                            <select class="form-select" onchange="filterByLocation(this.value)">
                                <option value="all">Toute la France</option>
                                <option value="idf">Île-de-France</option>
                                <option value="paca">PACA</option>
                                <option value="ra">Rhône-Alpes</option>
                            </select>
                        </div>
                    </div>
                    <div class="card-content">
                        <div class="institution-recommendations">
                            <div class="institution-item match-high">
                                <div class="institution-logo">🏛️</div>
                                <div class="institution-info">
                                    <div class="institution-name">École Polytechnique</div>
                                    <div class="institution-program">Cursus Ingénieur</div>
                                    <div class="institution-location">📍 Palaiseau</div>
                                    <div class="institution-stats">
                                        <span class="acceptance-rate">3% admission</span>
                                        <span class="match-score">Compatibilité: 91%</span>
                                    </div>
                                </div>
                                <div class="institution-actions">
                                    <button class="btn btn-sm btn-primary" onclick="exploreInstitution('polytechnique')">Détails</button>
                                </div>
                            </div>

                            <div class="institution-item match-medium">
                                <div class="institution-logo">🏫</div>
                                <div class="institution-info">
                                    <div class="institution-name">INSA Lyon</div>
                                    <div class="institution-program">Ingénierie Informatique</div>
                                    <div class="institution-location">📍 Lyon</div>
                                    <div class="institution-stats">
                                        <span class="acceptance-rate">12% admission</span>
                                        <span class="match-score">Compatibilité: 87%</span>
                                    </div>
                                </div>
                                <div class="institution-actions">
                                    <button class="btn btn-sm btn-secondary" onclick="exploreInstitution('insa')">Détails</button>
                                </div>
                            </div>

                            <div class="institution-item match-good">
                                <div class="institution-logo">🎓</div>
                                <div class="institution-info">
                                    <div class="institution-name">Université Paris-Saclay</div>
                                    <div class="institution-program">Master Recherche Chimie</div>
                                    <div class="institution-location">📍 Orsay</div>
                                    <div class="institution-stats">
                                        <span class="acceptance-rate">25% admission</span>
                                        <span class="match-score">Compatibilité: 82%</span>
                                    </div>
                                </div>
                                <div class="institution-actions">
                                    <button class="btn btn-sm btn-info" onclick="exploreInstitution('saclay')">Détails</button>
                                </div>
                            </div>
                        </div>

                        <div class="formation-timeline">
                            <h4>📅 Calendrier des candidatures 2025</h4>
                            <div class="timeline-events">
                                <div class="timeline-event urgent">
                                    <div class="event-date">15 Dec</div>
                                    <div class="event-title">Parcoursup : Ouverture</div>
                                    <div class="event-status">🔴 Imminent</div>
                                </div>
                                <div class="timeline-event coming">
                                    <div class="event-date">18 Jan</div>
                                    <div class="event-title">Fin des inscriptions</div>
                                    <div class="event-status">⏰ Préparation</div>
                                </div>
                                <div class="timeline-event future">
                                    <div class="event-date">3 Apr</div>
                                    <div class="event-title">Réponses établissements</div>
                                    <div class="event-status">📋 À venir</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Plan d'action personnalisé -->
                <div class="card action-plan">
                    <div class="card-header">
                        <h3><i class="fas fa-tasks"></i> Plan d'Action Personnalisé</h3>
                        <div class="plan-status">Généré par IA</div>
                    </div>
                    <div class="card-content">
                        <div class="action-timeline">
                            <div class="action-phase current">
                                <div class="phase-header">
                                    <div class="phase-title">Phase 1 : Exploration</div>
                                    <div class="phase-period">Maintenant - Janvier</div>
                                </div>
                                <div class="phase-tasks">
                                    <div class="task-item completed">
                                        <div class="task-icon">✅</div>
                                        <div class="task-content">
                                            <div class="task-title">Test d'orientation IA</div>
                                            <div class="task-desc">Profil scientifique confirmé</div>
                                        </div>
                                    </div>
                                    <div class="task-item in-progress">
                                        <div class="task-icon">🔄</div>
                                        <div class="task-content">
                                            <div class="task-title">Recherche approfondie filières</div>
                                            <div class="task-desc">3 domaines identifiés sur 5</div>
                                        </div>
                                    </div>
                                    <div class="task-item pending">
                                        <div class="task-icon">⏰</div>
                                        <div class="task-content">
                                            <div class="task-title">Rencontres professionnels</div>
                                            <div class="task-desc">2 entretiens planifiés</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="action-phase future">
                                <div class="phase-header">
                                    <div class="phase-title">Phase 2 : Candidatures</div>
                                    <div class="phase-period">Janvier - Mars</div>
                                </div>
                                <div class="phase-preview">
                                    <div class="preview-item">📝 Dossiers Parcoursup</div>
                                    <div class="preview-item">📄 Lettres de motivation</div>
                                    <div class="preview-item">🎯 Préparation concours</div>
                                </div>
                            </div>

                            <div class="action-phase future">
                                <div class="phase-header">
                                    <div class="phase-title">Phase 3 : Décision</div>
                                    <div class="phase-period">Avril - Juin</div>
                                </div>
                                <div class="phase-preview">
                                    <div class="preview-item">📞 Entretiens</div>
                                    <div class="preview-item">⚖️ Choix final</div>
                                    <div class="preview-item">📚 Préparation rentrée</div>
                                </div>
                            </div>
                        </div>

                        <div class="plan-actions">
                            <button class="btn btn-primary" onclick="updateActionPlan()">
                                <i class="fas fa-sync"></i> Mettre à jour le plan
                            </button>
                            <button class="btn btn-secondary" onclick="exportActionPlan()">
                                <i class="fas fa-download"></i> Exporter PDF
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section temporaire pour les autres sections -->
            <section id="bien-etre" class="section">
                <h2 class="section-title">🌱 Bien-être</h2>

                <!-- Suivi santé mentale -->
                <div class="card wellness-tracker">
                    <div class="card-header">
                        <h3><i class="fas fa-heart"></i> Suivi Bien-être</h3>
                        <div class="wellness-score">Score: 85/100</div>
                    </div>
                    <div class="card-content">
                        <div class="wellness-metrics">
                            <div class="metric-item">
                                <div class="metric-icon stress">😌</div>
                                <div class="metric-info">
                                    <div class="metric-name">Niveau de Stress</div>
                                    <div class="metric-bar">
                                        <div class="metric-fill low" style="width: 25%"></div>
                                    </div>
                                    <div class="metric-value">Faible (25%)</div>
                                </div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-icon energy">⚡</div>
                                <div class="metric-info">
                                    <div class="metric-name">Niveau d'Énergie</div>
                                    <div class="metric-bar">
                                        <div class="metric-fill high" style="width: 78%"></div>
                                    </div>
                                    <div class="metric-value">Élevé (78%)</div>
                                </div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-icon focus">🎯</div>
                                <div class="metric-info">
                                    <div class="metric-name">Capacité de Focus</div>
                                    <div class="metric-bar">
                                        <div class="metric-fill medium" style="width: 67%"></div>
                                    </div>
                                    <div class="metric-value">Bonne (67%)</div>
                                </div>
                            </div>
                        </div>
                        <div class="wellness-recommendations">
                            <h4>💡 Recommandations du jour</h4>
                            <ul>
                                <li>🧘 Prendre une pause de 10 min toutes les heures</li>
                                <li>💧 Boire 2 verres d'eau dans les 2h</li>
                                <li>🚶 Faire une courte marche après cette session</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Exercices de relaxation -->
                <div class="card relaxation-exercises">
                    <div class="card-header">
                        <h3><i class="fas fa-spa"></i> Exercices de Relaxation</h3>
                    </div>
                    <div class="card-content">
                        <div class="exercise-grid">
                            <div class="exercise-card">
                                <div class="exercise-icon">🧘</div>
                                <div class="exercise-info">
                                    <div class="exercise-name">Méditation Guidée</div>
                                    <div class="exercise-duration">5-15 minutes</div>
                                    <button class="btn btn-primary btn-sm" onclick="startMeditation()">Commencer</button>
                                </div>
                            </div>
                            <div class="exercise-card">
                                <div class="exercise-icon">🫁</div>
                                <div class="exercise-info">
                                    <div class="exercise-name">Respiration 4-7-8</div>
                                    <div class="exercise-duration">3 minutes</div>
                                    <button class="btn btn-secondary btn-sm" onclick="startBreathing()">Démarrer</button>
                                </div>
                            </div>
                            <div class="exercise-card">
                                <div class="exercise-icon">🎵</div>
                                <div class="exercise-info">
                                    <div class="exercise-name">Sons de la Nature</div>
                                    <div class="exercise-duration">Ambiance</div>
                                    <button class="btn btn-success btn-sm" onclick="playNatureSounds()">Écouter</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pause intelligente -->
                <div class="card smart-breaks">
                    <div class="card-header">
                        <h3><i class="fas fa-clock"></i> Pauses Intelligentes</h3>
                        <div class="break-status">Prochaine pause: 23 min</div>
                    </div>
                    <div class="card-content">
                        <div class="break-schedule">
                            <div class="break-item completed">
                                <div class="break-time">09:30</div>
                                <div class="break-type">Pause hydratation</div>
                                <div class="break-status">✅ Effectuée</div>
                            </div>
                            <div class="break-item current">
                                <div class="break-time">11:15</div>
                                <div class="break-type">Pause étirements</div>
                                <div class="break-status">🔔 Prochaine</div>
                            </div>
                            <div class="break-item pending">
                                <div class="break-time">13:00</div>
                                <div class="break-type">Pause déjeuner</div>
                                <div class="break-status">⏰ Planifiée</div>
                            </div>
                        </div>
                        <div class="break-settings">
                            <button class="btn btn-outline">Personnaliser</button>
                            <button class="btn btn-primary" onclick="takeBreak()">Pause maintenant</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section temporaire pour les autres sections -->
            <section id="communaute" class="section">
                <h2 class="section-title">👥 Communauté</h2>

                <!-- Groupes d'étude -->
                <div class="card study-groups">
                    <div class="card-header">
                        <h3><i class="fas fa-users"></i> Groupes d'Étude</h3>
                        <button class="btn btn-primary btn-sm" onclick="createStudyGroup()">Créer un groupe</button>
                    </div>
                    <div class="card-content">
                        <div class="group-list">
                            <div class="group-item active">
                                <div class="group-avatar">📐</div>
                                <div class="group-info">
                                    <div class="group-name">Maths Terminale S</div>
                                    <div class="group-stats">24 membres • 3 actifs</div>
                                    <div class="group-topic">Actuellement: Intégrales</div>
                                </div>
                                <div class="group-actions">
                                    <button class="btn btn-sm btn-success" onclick="joinGroup('Maths Terminale S')">Rejoindre</button>
                                </div>
                            </div>
                            <div class="group-item">
                                <div class="group-avatar">⚗️</div>
                                <div class="group-info">
                                    <div class="group-name">Chimie Organique</div>
                                    <div class="group-stats">18 membres • 7 actifs</div>
                                    <div class="group-topic">Actuellement: Réactions</div>
                                </div>
                                <div class="group-actions">
                                    <button class="btn btn-sm btn-outline">Voir</button>
                                </div>
                            </div>
                            <div class="group-item">
                                <div class="group-avatar">📚</div>
                                <div class="group-info">
                                    <div class="group-name">BAC 2025 - Entraide</div>
                                    <div class="group-stats">156 membres • 23 actifs</div>
                                    <div class="group-topic">Discussion générale</div>
                                </div>
                                <div class="group-actions">
                                    <button class="btn btn-sm btn-primary">Membre</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Leaderboard -->
                <div class="card community-leaderboard">
                    <div class="card-header">
                        <h3><i class="fas fa-trophy"></i> Classement Hebdomadaire</h3>
                    </div>
                    <div class="card-content">
                        <div class="leaderboard-list">
                            <div class="rank-item rank-1">
                                <div class="rank-number">1</div>
                                <div class="rank-avatar">🥇</div>
                                <div class="rank-info">
                                    <div class="rank-name">Sophie_M</div>
                                    <div class="rank-points">2,847 XP cette semaine</div>
                                </div>
                            </div>
                            <div class="rank-item rank-2">
                                <div class="rank-number">2</div>
                                <div class="rank-avatar">🥈</div>
                                <div class="rank-info">
                                    <div class="rank-name">Alex_Sciences</div>
                                    <div class="rank-points">2,341 XP cette semaine</div>
                                </div>
                            </div>
                            <div class="rank-item rank-3">
                                <div class="rank-number">3</div>
                                <div class="rank-avatar">🥉</div>
                                <div class="rank-info">
                                    <div class="rank-name">Maths_Pro</div>
                                    <div class="rank-points">2,156 XP cette semaine</div>
                                </div>
                            </div>
                            <div class="rank-item your-rank">
                                <div class="rank-number">7</div>
                                <div class="rank-avatar">👤</div>
                                <div class="rank-info">
                                    <div class="rank-name">Vous</div>
                                    <div class="rank-points">1,687 XP cette semaine</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Forum récent -->
                <div class="card recent-discussions">
                    <div class="card-header">
                        <h3><i class="fas fa-comments"></i> Discussions Récentes</h3>
                        <button class="btn btn-secondary btn-sm" onclick="viewAllDiscussions()">Voir tout</button>
                    </div>
                    <div class="card-content">
                        <div class="discussion-list">
                            <div class="discussion-item">
                                <div class="discussion-avatar">🤔</div>
                                <div class="discussion-info">
                                    <div class="discussion-title">Aide sur les intégrales par parties</div>
                                    <div class="discussion-meta">par Marie_T • 5 min • 3 réponses</div>
                                </div>
                                <div class="discussion-status new">Nouveau</div>
                            </div>
                            <div class="discussion-item">
                                <div class="discussion-avatar">💡</div>
                                <div class="discussion-info">
                                    <div class="discussion-title">Astuce pour retenir les formules de chimie</div>
                                    <div class="discussion-meta">par Paul_K • 1h • 12 réponses</div>
                                </div>
                                <div class="discussion-status hot">🔥 Popular</div>
                            </div>
                            <div class="discussion-item">
                                <div class="discussion-avatar">📊</div>
                                <div class="discussion-info">
                                    <div class="discussion-title">Retour d'expérience: organisation révisions</div>
                                    <div class="discussion-meta">par Camille_B • 3h • 8 réponses</div>
                                </div>
                                <div class="discussion-status"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section temporaire pour les autres sections -->
            <section id="parametres" class="section">
                <h2 class="section-title">⚙️ Paramètres</h2>

                <!-- Profil utilisateur -->
                <div class="card user-profile-settings">
                    <div class="card-header">
                        <h3><i class="fas fa-user-cog"></i> Profil Utilisateur</h3>
                    </div>
                    <div class="card-content">
                        <div class="profile-section">
                            <div class="profile-field">
                                <label>Prénom</label>
                                <input type="text" id="setting-firstName" class="form-input" placeholder="Votre prénom">
                            </div>
                            <div class="profile-field">
                                <label>Nom</label>
                                <input type="text" id="setting-lastName" class="form-input" placeholder="Votre nom">
                            </div>
                            <div class="profile-field">
                                <label>Surnom (affiché dans l'interface)</label>
                                <input type="text" id="setting-nickname" class="form-input" placeholder="Surnom optionnel">
                            </div>
                            <div class="profile-field">
                                <label>Email</label>
                                <input type="email" id="setting-email" class="form-input" placeholder="votre@email.com">
                            </div>
                            <div class="profile-field">
                                <label>Téléphone</label>
                                <input type="tel" id="setting-phone" class="form-input" placeholder="+237 6XX XXX XXX">
                            </div>
                            <div class="profile-field">
                                <label>Adresse</label>
                                <input type="text" id="setting-address" class="form-input" placeholder="Votre adresse">
                            </div>
                            <div class="profile-field">
                                <label>Ville</label>
                                <input type="text" id="setting-city" class="form-input" placeholder="Ville">
                            </div>
                            <div class="profile-field">
                                <label>Pays</label>
                                <input type="text" id="setting-country" class="form-input" placeholder="Cameroun">
                            </div>
                            <div class="profile-field">
                                <label>Classe</label>
                                <select id="setting-educationLevel" class="form-select">
                                    <option value="6EME">6ème</option>
                                    <option value="5EME">5ème</option>
                                    <option value="4EME">4ème</option>
                                    <option value="3EME">3ème</option>
                                    <option value="SECONDE">Seconde</option>
                                    <option value="PREMIERE">Première</option>
                                    <option value="TERMINALE" selected>Terminale</option>
                                </select>
                            </div>
                            <div class="profile-field">
                                <label>Nom de l'établissement</label>
                                <input type="text" id="setting-schoolName" class="form-input" placeholder="Lycée">
                            </div>
                            <div class="profile-field">
                                <label>Objectif BAC</label>
                                <select id="setting-targetGrade" class="form-select">
                                    <option value="Mention Passable">Mention Passable</option>
                                    <option value="Mention Assez Bien">Mention Assez Bien</option>
                                    <option value="Mention Bien" selected>Mention Bien</option>
                                    <option value="Mention Très Bien">Mention Très Bien</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Préférences d'apprentissage -->
                <div class="card learning-preferences">
                    <div class="card-header">
                        <h3><i class="fas fa-brain"></i> Préférences d'Apprentissage</h3>
                    </div>
                    <div class="card-content">
                        <div class="preference-group">
                            <div class="preference-item">
                                <div class="preference-info">
                                    <div class="preference-title">Difficulté adaptative</div>
                                    <div class="preference-desc">L'IA ajuste automatiquement la difficulté</div>
                                </div>
                                <div class="preference-control">
                                    <input type="checkbox" id="setting-adaptiveDifficulty" checked class="toggle-switch">
                                </div>
                            </div>
                            <div class="preference-item">
                                <div class="preference-info">
                                    <div class="preference-title">Explications détaillées</div>
                                    <div class="preference-desc">Afficher les solutions étape par étape</div>
                                </div>
                                <div class="preference-control">
                                    <input type="checkbox" id="setting-detailedExplanations" checked class="toggle-switch">
                                </div>
                            </div>
                            <div class="preference-item">
                                <div class="preference-info">
                                    <div class="preference-title">Révisions espacées</div>
                                    <div class="preference-desc">Système de mémorisation optimisé</div>
                                </div>
                                <div class="preference-control">
                                    <input type="checkbox" id="setting-spacedRepetition" checked class="toggle-switch">
                                </div>
                            </div>
                        </div>

                        <div class="difficulty-slider">
                            <label>Niveau de difficulté préféré</label>
                            <input type="range" min="1" max="5" value="3" id="setting-difficultyLevel" class="slider">
                            <div class="slider-labels">
                                <span>Facile</span>
                                <span>Difficile</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Notifications -->
                <div class="card notification-settings">
                    <div class="card-header">
                        <h3><i class="fas fa-bell"></i> Notifications</h3>
                    </div>
                    <div class="card-content">
                        <div class="notification-group">
                            <div class="notification-item">
                                <div class="notification-info">
                                    <div class="notification-title">Rappels d'étude</div>
                                    <div class="notification-desc">Notifications quotidiennes de révision</div>
                                </div>
                                <div class="notification-control">
                                    <input type="checkbox" id="setting-notif-studyReminders" checked class="toggle-switch">
                                </div>
                            </div>
                            <div class="notification-item">
                                <div class="notification-info">
                                    <div class="notification-title">Nouveaux défis</div>
                                    <div class="notification-desc">Alertes pour les nouveaux challenges</div>
                                </div>
                                <div class="notification-control">
                                    <input type="checkbox" id="setting-notif-newChallenges" checked class="toggle-switch">
                                </div>
                            </div>
                            <div class="notification-item">
                                <div class="notification-info">
                                    <div class="notification-title">Pauses intelligentes</div>
                                    <div class="notification-desc">Rappels de pause pour le bien-être</div>
                                </div>
                                <div class="notification-control">
                                    <input type="checkbox" id="setting-notif-smartBreaks" checked class="toggle-switch">
                                </div>
                            </div>
                            <div class="notification-item">
                                <div class="notification-info">
                                    <div class="notification-title">Communauté</div>
                                    <div class="notification-desc">Messages et réponses du forum</div>
                                </div>
                                <div class="notification-control">
                                    <input type="checkbox" id="setting-notif-community" class="toggle-switch">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Interface et thème -->
                <div class="card interface-settings">
                    <div class="card-header">
                        <h3><i class="fas fa-palette"></i> Interface et Thème</h3>
                    </div>
                    <div class="card-content">
                        <div class="theme-selection">
                            <div class="theme-item active">
                                <div class="theme-preview gradient-theme"></div>
                                <div class="theme-name">Dégradé Moderne</div>
                            </div>
                            <div class="theme-item">
                                <div class="theme-preview dark-theme"></div>
                                <div class="theme-name">Mode Sombre</div>
                            </div>
                            <div class="theme-item">
                                <div class="theme-preview light-theme"></div>
                                <div class="theme-name">Mode Clair</div>
                            </div>
                        </div>

                        <div class="interface-options">
                            <div class="interface-item">
                                <div class="interface-info">
                                    <div class="interface-title">Particules flottantes</div>
                                    <div class="interface-desc">Effet visuel d'arrière-plan</div>
                                </div>
                                <div class="interface-control">
                                    <input type="checkbox" checked class="toggle-switch">
                                </div>
                            </div>
                            <div class="interface-item">
                                <div class="interface-info">
                                    <div class="interface-title">Animations avancées</div>
                                    <div class="interface-desc">Transitions et effets visuels</div>
                                </div>
                                <div class="interface-control">
                                    <input type="checkbox" checked class="toggle-switch">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Données et sécurité -->
                <div class="card data-settings">
                    <div class="card-header">
                        <h3><i class="fas fa-shield-alt"></i> Données et Sécurité</h3>
                    </div>
                    <div class="card-content">
                        <div class="data-section">
                            <!-- Changement de mot de passe -->
                            <div class="data-item password-change">
                                <div class="data-icon">🔐</div>
                                <div class="data-info">
                                    <div class="data-title">Changer mon mot de passe</div>
                                    <div class="data-desc">Modifier votre mot de passe de connexion</div>
                                </div>
                                <button class="btn btn-primary" onclick="openPasswordModal()">Modifier</button>
                            </div>

                            <div class="data-item">
                                <div class="data-icon">📊</div>
                                <div class="data-info">
                                    <div class="data-title">Exporter mes données</div>
                                    <div class="data-desc">Télécharger toutes vos données personnelles</div>
                                </div>
                                <button class="btn btn-secondary" onclick="exportUserData()">Exporter</button>
                            </div>
                            <div class="data-item">
                                <div class="data-icon">🗑️</div>
                                <div class="data-info">
                                    <div class="data-title">Réinitialiser la progression</div>
                                    <div class="data-desc">Supprimer tous les scores et badges</div>
                                </div>
                                <button class="btn btn-danger" onclick="resetProgress()">Réinitialiser</button>
                            </div>
                            <div class="data-item">
                                <div class="data-icon">💾</div>
                                <div class="data-info">
                                    <div class="data-title">Sauvegarde automatique</div>
                                    <div class="data-desc">Synchronisation en temps réel</div>
                                </div>
                                <div class="status-indicator active">Activée</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Actions -->
                <div class="card settings-actions">
                    <div class="card-content">
                        <div class="actions-row">
                            <button class="btn btn-success" onclick="saveSettings()">💾 Sauvegarder</button>
                            <button class="btn btn-secondary" onclick="resetToDefaults()">↻ Restaurer défauts</button>
                            <button class="btn btn-outline">❌ Annuler</button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Container des notifications toast -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Modal changement de mot de passe -->
    <div class="modal-overlay" id="passwordModal">
        <div class="modal-container">
            <div class="modal-header">
                <h3><i class="fas fa-key"></i> Changer le mot de passe</h3>
                <button class="modal-close" onclick="closePasswordModal()">×</button>
            </div>
            <div class="modal-content">
                <form id="passwordForm" onsubmit="changePassword(event)">
                    <div class="form-group">
                        <label for="currentPassword">Mot de passe actuel</label>
                        <div class="password-input-group">
                            <input type="password" id="currentPassword" required class="form-input" placeholder="Entrez votre mot de passe actuel">
                            <button type="button" class="password-toggle" onclick="togglePassword('currentPassword')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="newPassword">Nouveau mot de passe</label>
                        <div class="password-input-group">
                            <input type="password" id="newPassword" required class="form-input" placeholder="Entrez votre nouveau mot de passe" minlength="8">
                            <button type="button" class="password-toggle" onclick="togglePassword('newPassword')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div class="password-requirements">
                            <small>
                                <ul>
                                    <li id="length-req">Au moins 8 caractères</li>
                                    <li id="uppercase-req">Au moins 1 majuscule</li>
                                    <li id="lowercase-req">Au moins 1 minuscule</li>
                                    <li id="number-req">Au moins 1 chiffre</li>
                                    <li id="special-req">Au moins 1 caractère spécial</li>
                                </ul>
                            </small>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="confirmPassword">Confirmer le nouveau mot de passe</label>
                        <div class="password-input-group">
                            <input type="password" id="confirmPassword" required class="form-input" placeholder="Confirmez votre nouveau mot de passe">
                            <button type="button" class="password-toggle" onclick="togglePassword('confirmPassword')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div class="password-match" id="passwordMatch"></div>
                    </div>

                    <div class="password-strength">
                        <div class="strength-label">Force du mot de passe:</div>
                        <div class="strength-bar">
                            <div class="strength-fill" id="strengthFill"></div>
                        </div>
                        <div class="strength-text" id="strengthText">Entrez un mot de passe</div>
                    </div>

                    <div class="modal-actions">
                        <button type="button" class="btn btn-secondary" onclick="closePasswordModal()">Annuler</button>
                        <button type="submit" class="btn btn-primary" id="changePasswordBtn" disabled>Changer le mot de passe</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal de Paiement/Renouvellement -->
    <style>
    /* Plans Grid */
    .plans-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.5rem;
        margin-top: 1.5rem;
    }

    .plan-card {
        background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(59, 130, 246, 0.1));
        border: 2px solid rgba(139, 92, 246, 0.3);
        border-radius: 12px;
        padding: 1.5rem;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
    }

    .plan-card:hover {
        transform: translateY(-5px);
        border-color: rgba(139, 92, 246, 0.6);
        box-shadow: 0 10px 30px rgba(139, 92, 246, 0.3);
    }

    .plan-card.selected {
        border-color: #8B5CF6;
        background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(59, 130, 246, 0.2));
    }

    .plan-card.popular::before {
        content: "⭐ Populaire";
        position: absolute;
        top: -10px;
        right: 10px;
        background: #FFCC02;
        color: #000;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: bold;
    }

    .plan-name {
        font-size: 1.3rem;
        font-weight: bold;
        color: #fff;
        margin-bottom: 0.5rem;
    }

    .plan-price {
        font-size: 2rem;
        font-weight: bold;
        color: #8B5CF6;
        margin: 0.5rem 0;
    }

    .plan-price-currency {
        font-size: 1rem;
        color: rgba(255, 255, 255, 0.7);
    }

    .plan-duration {
        color: rgba(255, 255, 255, 0.6);
        font-size: 0.9rem;
        margin-bottom: 1rem;
    }

    .plan-description {
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.9rem;
        margin-bottom: 1rem;
        min-height: 3em;
    }

    .plan-features {
        list-style: none;
        padding: 0;
        margin: 1rem 0;
    }

    .plan-features li {
        padding: 0.4rem 0;
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.9rem;
    }

    .plan-features li::before {
        content: "✓ ";
        color: #10B981;
        font-weight: bold;
        margin-right: 0.5rem;
    }

    /* Payment Methods Grid */
    .payment-methods-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
        margin-top: 1.5rem;
    }

    .payment-method-card {
        background: rgba(255, 255, 255, 0.05);
        border: 2px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        padding: 1.5rem;
        cursor: pointer;
        transition: all 0.3s ease;
        text-align: center;
    }

    .payment-method-card:hover {
        transform: translateY(-3px);
        border-color: rgba(139, 92, 246, 0.5);
        box-shadow: 0 8px 20px rgba(139, 92, 246, 0.2);
    }

    .payment-method-card.selected {
        border-color: #8B5CF6;
        background: rgba(139, 92, 246, 0.1);
    }

    .payment-method-icon {
        font-size: 3rem;
        margin-bottom: 0.5rem;
    }

    .payment-method-name {
        font-size: 1.1rem;
        font-weight: bold;
        color: #fff;
        margin-bottom: 0.5rem;
    }

    .payment-method-desc {
        font-size: 0.85rem;
        color: rgba(255, 255, 255, 0.6);
        margin-bottom: 0.5rem;
    }

    .payment-method-fees {
        font-size: 0.8rem;
        color: #FFCC02;
    }

    /* Payment Summary */
    .payment-summary {
        background: rgba(139, 92, 246, 0.1);
        border-radius: 8px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
    }

    .summary-item {
        display: flex;
        justify-content: space-between;
        padding: 0.5rem 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .summary-item:last-child {
        border-bottom: none;
        font-size: 1.2rem;
        margin-top: 0.5rem;
    }

    /* Payment Progress */
    .payment-progress {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-top: 2rem;
        padding-top: 2rem;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .progress-step {
        display: flex;
        flex-direction: column;
        align-items: center;
        opacity: 0.4;
        transition: all 0.3s ease;
    }

    .progress-step.active {
        opacity: 1;
    }

    .step-circle {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.1);
        border: 2px solid rgba(255, 255, 255, 0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        margin-bottom: 0.5rem;
    }

    .progress-step.active .step-circle {
        background: #8B5CF6;
        border-color: #8B5CF6;
        color: #fff;
    }

    .step-label {
        font-size: 0.85rem;
        color: rgba(255, 255, 255, 0.6);
    }

    .progress-step.active .step-label {
        color: #fff;
    }

    .progress-line {
        width: 60px;
        height: 2px;
        background: rgba(255, 255, 255, 0.2);
        margin: 0 0.5rem 1.5rem;
    }
    </style>

    <div class="modal-overlay" id="paymentModal">
        <div class="modal-container" style="max-width: 900px;">
            <div class="modal-header">
                <h3><i class="fas fa-credit-card"></i> Renouveler mon abonnement</h3>
                <button class="modal-close" onclick="closePaymentModal()">×</button>
            </div>
            <div class="modal-content">

                <!-- Étape 1: Sélection du plan -->
                <div id="step-plan" class="payment-step active">
                    <h4 style="color: #fff; margin-bottom: 1rem;">Choisissez votre formule</h4>
                    <div class="plans-grid" id="plansGrid">
                        <!-- Les plans seront chargés dynamiquement -->
                        <div style="grid-column: 1/-1; text-align: center; padding: 2rem; color: rgba(255,255,255,0.6);">
                            Chargement des plans...
                        </div>
                    </div>
                </div>

                <!-- Étape 2: Sélection du moyen de paiement -->
                <div id="step-payment-method" class="payment-step" style="display:none;">
                    <h4 style="color: #fff; margin-bottom: 1rem;">Choisissez votre moyen de paiement</h4>
                    <div class="payment-methods-grid" id="paymentMethodsGrid">
                        <!-- Les moyens de paiement seront chargés dynamiquement -->
                        <div style="grid-column: 1/-1; text-align: center; padding: 2rem; color: rgba(255,255,255,0.6);">
                            Chargement des moyens de paiement...
                        </div>
                    </div>
                </div>

                <!-- Étape 3: Informations de paiement -->
                <div id="step-payment-info" class="payment-step" style="display:none;">
                    <h4 style="color: #fff; margin-bottom: 1rem;">Finaliser le paiement</h4>
                    <form id="paymentForm" onsubmit="processPayment(event)">
                        <div class="payment-summary">
                            <div class="summary-item">
                                <span>Formule:</span>
                                <strong id="selectedPlanName">-</strong>
                            </div>
                            <div class="summary-item">
                                <span>Moyen de paiement:</span>
                                <strong id="selectedMethodName">-</strong>
                            </div>
                            <div class="summary-item">
                                <span>Montant:</span>
                                <strong id="selectedAmount">-</strong>
                            </div>
                        </div>

                        <div id="phoneNumberField" class="form-group" style="display:none;">
                            <label for="paymentPhone">Numéro de téléphone Mobile Money</label>
                            <input type="tel" id="paymentPhone" class="form-input"
                                   placeholder="+237690123456" pattern="^\+?237[0-9]{9}$">
                            <small>Format: +237690123456 ou 237690123456</small>
                        </div>

                        <div id="cardFields" class="form-group" style="display:none;">
                            <label>Informations de carte</label>
                            <input type="text" id="cardNumber" class="form-input"
                                   placeholder="Numéro de carte" maxlength="19">
                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:1rem; margin-top:1rem;">
                                <input type="text" id="cardExpiry" class="form-input"
                                       placeholder="MM/AA" maxlength="5">
                                <input type="text" id="cardCVV" class="form-input"
                                       placeholder="CVV" maxlength="4">
                            </div>
                        </div>

                        <div class="modal-actions">
                            <button type="button" class="btn btn-secondary" onclick="previousPaymentStep()">
                                <i class="fas fa-arrow-left"></i> Retour
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-check"></i> Confirmer le paiement
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Indicateur de progression -->
                <div class="payment-progress">
                    <div class="progress-step active" data-step="1">
                        <div class="step-circle">1</div>
                        <div class="step-label">Formule</div>
                    </div>
                    <div class="progress-line"></div>
                    <div class="progress-step" data-step="2">
                        <div class="step-circle">2</div>
                        <div class="step-label">Paiement</div>
                    </div>
                    <div class="progress-line"></div>
                    <div class="progress-step" data-step="3">
                        <div class="step-circle">3</div>
                        <div class="step-label">Confirmation</div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Script de gestion du paiement chargé dynamiquement plus bas -->

    <script>
        // ========== VARIABLES GLOBALES ==========
        let userXP = 0;
        let userLevel = 1;
        let dailyStreak = 0;
        let currentAverage = 0;
        let currentSection = 'dashboard';
        let currentUser = null;
        let dashboardData = null;
        let subjectsData = [];

        // ========== INITIALISATION ==========
        document.addEventListener('DOMContentLoaded', function() {
            // Charger les données utilisateur réelles
            loadRealUserData();
            initializeParticles();
            updateXPDisplay();
            showWelcomeToast();
        });

        // ========== CHARGEMENT DONNÉES RÉELLES ==========
        async function loadRealUserData() {
            try {
                // Récupérer les données depuis localStorage
                const userDataStr = localStorage.getItem('claudyne_user');
                const token = localStorage.getItem('claudyne_token');

                if (!userDataStr || !token) {
                    console.warn('⚠️ Pas de données utilisateur - Redirection vers login');
                    window.location.href = '/';
                    return;
                }

                currentUser = JSON.parse(userDataStr);

                // Mettre à jour l'interface avec les vraies données
                updateUserInterface(currentUser);

                // Charger les données additionnelles depuis l'API
                await fetchAdditionalUserData(token);

            } catch (error) {
                console.error('❌ Erreur chargement données utilisateur:', error);
                showToast('Erreur de chargement des données', 'danger');
            }
        }

        function updateUserInterface(user) {
            // Mise à jour du nom d'utilisateur
            const nameElement = document.getElementById('studentName');
            if (nameElement) {
                nameElement.textContent = `${user.firstName || ''} ${user.lastName || ''}`.trim() || 'Étudiant';
            }

            // Mise à jour des informations scolaires
            const infoElement = document.getElementById('studentInfo');
            if (infoElement && user.educationLevel && user.school) {
                infoElement.textContent = `${user.educationLevel} • ${user.school}`;
            } else if (infoElement && user.educationLevel) {
                infoElement.textContent = user.educationLevel;
            } else if (infoElement && user.studentClass) {
                infoElement.textContent = user.studentClass + (user.school ? ` • ${user.school}` : '');
            } else if (infoElement) {
                infoElement.textContent = 'Étudiant Claudyne';
            }

            // Mise à jour du statut d'abonnement
            const statusElement = document.getElementById('subscriptionStatus');
            if (statusElement && user.subscriptionType) {
                const expiryDate = user.subscriptionExpiresAt ? new Date(user.subscriptionExpiresAt) : null;
                if (expiryDate) {
                    const daysRemaining = Math.ceil((expiryDate - new Date()) / (1000 * 60 * 60 * 24));
                    const monthsRemaining = Math.floor(daysRemaining / 30);
                    const daysInMonth = daysRemaining % 30;
                    statusElement.textContent = `${user.subscriptionType} - Expire dans ${monthsRemaining} mois, ${daysInMonth} jours`;
                } else {
                    statusElement.textContent = user.subscriptionType;
                }
            } else if (statusElement) {
                statusElement.textContent = 'Essai gratuit';
            }

            // Mise à jour du message AI personnalisé
            const aiMessageEl = document.querySelector('.message-bubble.ai');
            if (aiMessageEl && user.firstName) {
                aiMessageEl.textContent = `Salut ${user.firstName} ! 👋 Je vois que tu progresses bien. As-tu des questions ? Je peux t'aider avec des explications personnalisées !`;
            }
        }

        async function fetchAdditionalUserData(token) {
            if (!token) {
                console.log('ℹ️ Token non disponible - Connexion requise');
                return;
            }

            try {
                const API_BASE = 'https://claudyne.com';
                const headers = {
                    'Authorization': `Bearer ${token}`,
                    'Content-Type': 'application/json'
                };

                // Profile
                try {
                    const profileRes = await fetch(`${API_BASE}/api/students/profile`, { headers });
                    if (profileRes.ok) {
                        const profile = await profileRes.json();
                        if (profile.success && profile.data) {
                            userXP = profile.data.xp || 0;
                            userLevel = profile.data.level || 1;
                            dailyStreak = profile.data.dailyStreak || 0;
                            currentAverage = profile.data.currentAverage || 0;
                            updateXPDisplay();
                            updateAverageDisplay();
                            console.log('✅ Profil chargé:', profile.data);
                        }
                    } else if (profileRes.status === 401) {
                        console.log('🔒 Session expirée - Veuillez vous reconnecter');
                    }
                } catch (err) {
                    // Ignore profile errors silently
                }

                // Dashboard
                try {
                    const dashRes = await fetch(`${API_BASE}/api/students/dashboard`, { headers });
                    if (dashRes.ok) {
                        const dash = await dashRes.json();
                        if (dash.success) {
                            dashboardData = dash.data;
                            updateDashboardStats();
                            console.log('✅ Dashboard chargé:', dash.data);
                        }
                    }
                } catch (err) {
                    // Ignore dashboard errors silently
                }

                // Subjects
                try {
                    const subjRes = await fetch(`${API_BASE}/api/students/subjects`, { headers });
                    if (subjRes.ok) {
                        const subj = await subjRes.json();
                        if (subj.success) {
                            subjectsData = subj.data.subjects || [];
                            updateSubjectsDisplay();
                            console.log('✅ Matières chargées:', subj.data.subjects.length);
                        }
                    }
                } catch (err) {
                    // Ignore subjects errors silently
                }

                // Achievements
                try {
                    const achRes = await fetch(`${API_BASE}/api/students/achievements`, { headers });
                    if (achRes.ok) {
                        const ach = await achRes.json();
                        if (ach.success) {
                            achievementsData = ach.data;
                            updateAchievementsDisplay();
                            console.log('✅ Achievements chargés:', ach.data.achievements.length);
                        }
                    }
                } catch (err) {
                    // Ignore achievements errors silently
                }

                // Analytics (only if we have a student profile)
                if (profileData && profileData.id) {
                    try {
                        const analyticsRes = await fetch(`${API_BASE}/api/students/${profileData.id}/analytics`, { headers });
                        if (analyticsRes.ok) {
                            const analytics = await analyticsRes.json();
                            if (analytics.success) {
                                analyticsData = analytics.data;
                                updateAnalyticsDisplay();
                                console.log('✅ Analytics chargées');
                            }
                        }
                    } catch (err) {
                        // Ignore analytics errors silently
                    }
                }

                // Settings - charger les paramètres utilisateur
                await loadSettings();

                // AI Chat - charger l'historique de conversation
                await loadAiChatHistory();

                // Prix Claudine - charger leaderboard et awards
                await loadPrixClaudineData();

                // Quiz - charger quiz disponibles, challenges et stats
                await loadQuizData();

                // Révisions - charger planning, flashcards et session active
                await loadRevisionsData();

                // Orientation - charger profil, recommandations, carrières et établissements
                await loadOrientationData();

                // Bien-être - charger métriques, exercices et pauses intelligentes
                await loadWellnessData();

                // Communauté - charger groupes d'étude, leaderboard et discussions
                await loadCommunityData();

            } catch (error) {
                // Silent fail - user not authenticated
                console.log('ℹ️ Chargement des données API ignoré (non connecté)');
            }
        }

        function updateDashboardStats() {
            if (!dashboardData) return;

            const stats = [
                { id: 'lessons-stat', value: dashboardData.lessonsCompleted || 0 },
                { id: 'quizzes-stat', value: dashboardData.quizzesPassed || 0 },
                { id: 'battles-stat', value: dashboardData.battlesWon || 0 }
            ];

            stats.forEach(stat => {
                const el = document.getElementById(stat.id);
                if (el) el.textContent = stat.value;
            });
        }

        function updateSubjectsDisplay() {
            const container = document.querySelector('.subjects-grid');
            if (!container || !subjectsData.length) return;

            subjectsData.forEach((subject, idx) => {
                const card = container.children[idx];
                if (card) {
                    const progress = card.querySelector('.subject-progress');
                    const score = card.querySelector('.subject-score');
                    if (progress) progress.style.width = `${subject.progress}%`;
                    if (score) score.textContent = `${subject.score}%`;
                }
            });
        }

        function updateAchievementsDisplay() {
            if (!achievementsData) return;

            // Update level and XP
            const levelBadge = document.querySelector('.level-badge');
            const levelTitle = document.querySelector('.level-title');
            const xpFill = document.querySelector('.xp-fill');
            const xpText = document.querySelector('.xp-text');
            const achievementStats = document.querySelector('.achievement-stats');

            if (levelBadge) levelBadge.textContent = achievementsData.level || 1;
            if (levelTitle) levelTitle.textContent = achievementsData.levelTitle || 'Débutant';
            if (xpFill) xpFill.style.width = `${achievementsData.xpProgress || 0}%`;
            if (xpText) xpText.textContent = `${achievementsData.currentXP || 0} / ${achievementsData.nextLevelXP || 1000} XP`;
            if (achievementStats) achievementStats.textContent = `${achievementsData.achievements.length} badges débloqués`;

            // Update recent badges
            const badgeGrid = document.querySelector('.badge-grid');
            if (badgeGrid && achievementsData.achievements.length > 0) {
                badgeGrid.innerHTML = '';

                // Show the 3 most recent achievements
                achievementsData.achievements.slice(0, 3).forEach((achievement, idx) => {
                    const badgeEl = document.createElement('div');
                    badgeEl.className = `achievement-badge ${idx === 0 ? 'new' : ''}`;
                    badgeEl.innerHTML = `
                        <div class="badge-icon ${idx === 0 ? 'gold' : idx === 1 ? 'silver' : 'bronze'}">${achievement.icon}</div>
                        <div class="badge-info">
                            <div class="badge-name">${achievement.name}</div>
                            <div class="badge-desc">${achievement.description || 'Badge débloqué'}</div>
                            <div class="badge-date">Obtenu ${achievement.earnedDate ? 'le ' + new Date(achievement.earnedDate).toLocaleDateString() : 'récemment'}</div>
                        </div>
                    `;
                    badgeGrid.appendChild(badgeEl);
                });
            }

            // Update badge collections
            const categoryGrid = document.querySelector('#performance-badges .category-grid');
            if (categoryGrid && achievementsData.achievements.length > 0) {
                categoryGrid.innerHTML = '';

                achievementsData.achievements.forEach(achievement => {
                    const badgeItem = document.createElement('div');
                    badgeItem.className = `badge-item ${achievement.unlocked ? 'earned' : 'locked'}`;
                    badgeItem.innerHTML = `
                        <div class="badge-visual ${achievement.unlocked ? 'gold' : ''}">${achievement.icon}</div>
                        <div class="badge-title">${achievement.name}</div>
                        <div class="badge-progress">${achievement.unlocked ? 'Complété' : 'Verrouillé'}</div>
                    `;
                    categoryGrid.appendChild(badgeItem);
                });
            }
        }

        function updateAnalyticsDisplay() {
            if (!analyticsData) return;

            // Update real-time performance metrics
            const metricsGrid = document.querySelector('.analytics-grid');
            if (metricsGrid) {
                const metrics = [
                    {
                        icon: 'fas fa-bullseye',
                        iconClass: 'success',
                        value: `${analyticsData.successRate || 0}%`,
                        label: 'Taux de réussite',
                        trend: analyticsData.successRateTrend || '+0%'
                    },
                    {
                        icon: 'fas fa-clock',
                        iconClass: 'info',
                        value: analyticsData.avgStudyTime || '0h 0m',
                        label: 'Temps d\'étude moyen',
                        trend: analyticsData.studyTimeTrend || '0min'
                    },
                    {
                        icon: 'fas fa-fire',
                        iconClass: 'warning',
                        value: `${analyticsData.streak || 0} jours`,
                        label: 'Série actuelle',
                        trend: analyticsData.streakStatus || 'Continue!'
                    },
                    {
                        icon: 'fas fa-brain',
                        iconClass: 'primary',
                        value: `${analyticsData.cognitiveEfficiency || 0}%`,
                        label: 'Efficacité cognitive',
                        trend: analyticsData.cognitiveStatus || 'Optimal'
                    }
                ];

                metricsGrid.innerHTML = metrics.map(metric => `
                    <div class="analytics-metric">
                        <div class="metric-icon ${metric.iconClass}">
                            <i class="${metric.icon}"></i>
                        </div>
                        <div class="metric-info">
                            <div class="metric-value">${metric.value}</div>
                            <div class="metric-label">${metric.label}</div>
                            <div class="metric-trend positive">${metric.trend}</div>
                        </div>
                    </div>
                `).join('');
            }

            // Update predictions
            if (analyticsData.predictions) {
                const predictionGrid = document.querySelector('.prediction-grid');
                if (predictionGrid && analyticsData.predictions.length > 0) {
                    predictionGrid.innerHTML = analyticsData.predictions.map(pred => `
                        <div class="prediction-item">
                            <div class="subject">${pred.subject}</div>
                            <div class="prediction-bar">
                                <div class="prediction-fill" style="width: ${(pred.score / 20) * 100}%"></div>
                                <span class="prediction-score">${pred.score}/20</span>
                            </div>
                        </div>
                    `).join('');
                }
            }

            // Update weakness analysis
            if (analyticsData.weaknesses) {
                const weaknessList = document.querySelector('.weakness-list');
                if (weaknessList && analyticsData.weaknesses.length > 0) {
                    weaknessList.innerHTML = analyticsData.weaknesses.map(weak => `
                        <div class="weakness-item ${weak.severity || 'low'}">
                            <div class="weakness-icon">${weak.severity === 'high' ? '⚠️' : '📊'}</div>
                            <div class="weakness-info">
                                <div class="weakness-title">${weak.topic}</div>
                                <div class="weakness-desc">Taux d'erreur: ${weak.errorRate}% - ${weak.status || 'À améliorer'}</div>
                                <div class="weakness-actions">
                                    <button class="btn btn-sm btn-primary" onclick="reviewTopic('${weak.topic}')">Réviser maintenant</button>
                                </div>
                            </div>
                        </div>
                    `).join('');
                }
            }
        }

        // ========== PARTICULES FLOTTANTES ==========
        function initializeParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 20;

            for (let i = 0; i < particleCount; i++) {
                createParticle(particlesContainer);
            }

            // Créer de nouvelles particules périodiquement
            setInterval(() => {
                if (particlesContainer.children.length < particleCount) {
                    createParticle(particlesContainer);
                }
            }, 3000);
        }

        function createParticle(container) {
            const particle = document.createElement('div');
            particle.className = 'particle';

            const size = Math.random() * 4 + 2;
            particle.style.width = size + 'px';
            particle.style.height = size + 'px';
            particle.style.left = Math.random() * 100 + '%';
            particle.style.animationDuration = (Math.random() * 10 + 15) + 's';
            particle.style.animationDelay = Math.random() * 5 + 's';

            container.appendChild(particle);

            // Supprimer la particule après l'animation
            setTimeout(() => {
                if (particle.parentNode) {
                    particle.remove();
                }
            }, 25000);
        }

        // ========== SYSTÈME XP ET GAMIFICATION ==========
        function updateXPDisplay() {
            const xpFill = document.getElementById('xpFill');
            const xpText = document.getElementById('xpText');
            const levelBadge = document.getElementById('levelBadge');
            const headerXP = document.getElementById('header-xp');
            const headerStreak = document.getElementById('header-streak');

            const xpForCurrentLevel = (userLevel - 1) * 250;
            const xpForNextLevel = userLevel * 250;
            const currentLevelXP = userXP - xpForCurrentLevel;
            const xpNeeded = xpForNextLevel - xpForCurrentLevel;
            const percentage = (currentLevelXP / xpNeeded) * 100;

            if (xpFill) xpFill.style.width = percentage + '%';
            if (xpText) xpText.textContent = `${currentLevelXP} / ${xpNeeded} XP`;
            if (levelBadge) levelBadge.innerHTML = `<i class="fas fa-crown"></i> Niveau ${userLevel}`;

            // Mettre à jour les valeurs du header
            if (headerXP) headerXP.textContent = userXP.toLocaleString('fr-FR');
            if (headerStreak) headerStreak.innerHTML = `<span class="streak-flame">🔥</span> ${dailyStreak}`;
        }

        function updateAverageDisplay() {
            const averageStat = document.getElementById('average-stat');
            const prixClaudineAverage = document.getElementById('prix-claudine-average');

            if (averageStat) {
                averageStat.textContent = currentAverage.toFixed(1);
            }

            if (prixClaudineAverage) {
                prixClaudineAverage.textContent = `Votre moyenne: ${currentAverage.toFixed(1)}/20`;
            }
        }

        function gainXP(amount, reason = '') {
            userXP += amount;
            updateXPDisplay();

            showToast(`🎉 +${amount} XP gagné ! ${reason}`, 'success');

            // Vérifier si on a monté de niveau
            const newLevel = Math.floor(userXP / 250) + 1;
            if (newLevel > userLevel) {
                levelUp(newLevel);
            }
        }

        function levelUp(newLevel) {
            userLevel = newLevel;
            showToast(`🚀 NIVEAU UP ! Vous êtes maintenant niveau ${newLevel} !`, 'warning', 8000);

            // Animation de niveau up
            const levelBadge = document.getElementById('levelBadge');
            if (levelBadge) {
                levelBadge.style.animation = 'none';
                setTimeout(() => {
                    levelBadge.style.animation = 'pulse 0.5s ease-in-out 3, glow 2s ease-in-out';
                }, 10);
            }
        }

        // ========== NAVIGATION ==========
        function showSection(sectionName) {
            console.log('🔄 Navigation vers:', sectionName);

            // Animation de sortie
            const currentSectionElement = document.querySelector('.section.active');
            if (currentSectionElement) {
                currentSectionElement.style.transform = 'translateY(-30px)';
                currentSectionElement.style.opacity = '0';

                setTimeout(() => {
                    currentSectionElement.classList.remove('active');

                    // Animation d'entrée
                    const newSection = document.getElementById(sectionName);
                    if (newSection) {
                        newSection.classList.add('active');
                        newSection.style.transform = 'translateY(30px)';
                        newSection.style.opacity = '0';

                        setTimeout(() => {
                            newSection.style.transform = 'translateY(0)';
                            newSection.style.opacity = '1';
                        }, 50);
                    }
                }, 150);
            }

            currentSection = sectionName;
            updateNavigation(sectionName);

            // Récompense XP pour exploration
            if (Math.random() > 0.7) {
                gainXP(5, 'Exploration de l\'interface');
            }

            // Fermer menu mobile
            if (window.innerWidth <= 1024) {
                document.getElementById('sidebar').classList.remove('open');
            }
        }

        function updateNavigation(sectionName) {
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });

            const activeLink = document.querySelector(`[onclick*="showSection('${sectionName}')"]`);
            if (activeLink) {
                activeLink.classList.add('active');
            }
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');

            sidebar.classList.toggle('open');
            mainContent.classList.toggle('expanded');
        }

        // ========== NOTIFICATIONS TOAST ==========
        function showToast(message, type = 'success', duration = 5000) {
            const toastContainer = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;

            const iconMap = {
                'success': 'fas fa-check-circle',
                'info': 'fas fa-info-circle',
                'warning': 'fas fa-exclamation-triangle',
                'error': 'fas fa-times-circle'
            };

            toast.innerHTML = `
                <div class="toast-header">
                    <i class="${iconMap[type]}"></i>
                    <span>${type.charAt(0).toUpperCase() + type.slice(1)}</span>
                </div>
                <div class="toast-message">${message}</div>
                <button class="toast-close" onclick="this.parentElement.remove()">×</button>
            `;

            toastContainer.appendChild(toast);

            // Déclencher l'animation d'apparition
            setTimeout(() => toast.classList.add('show'), 100);

            // Auto-suppression
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 500);
            }, duration);
        }

        function showWelcomeToast() {
            setTimeout(() => {
                showToast('🎓 Bienvenue sur Claudyne Max ! Interface étudiante ultime avec IA avancée', 'info', 8000);
            }, 2000);
        }

        // ========== FONCTIONNALITÉS INTERACTIVES ==========
        function startDailyChallenge() {
            showToast('⚔️ Défis quotidiens acceptés ! Bonus XP x2 aujourd\'hui', 'warning');
            gainXP(15, 'Acceptation des défis quotidiens');
        }

        function showDetailedStats(type) {
            const lessonsCompleted = dashboardData?.lessonsCompleted || 0;
            const quizzesPassed = dashboardData?.quizzesPassed || 0;

            const messages = {
                'average': `Moyenne générale: ${currentAverage.toFixed(1)}/20${currentAverage > 0 ? ' • Continue tes efforts !' : ' • Commence tes cours pour voir ta moyenne'}`,
                'courses': `${lessonsCompleted} cours terminés !${lessonsCompleted > 0 ? ' Continue ton excellent travail' : ' Commence dès maintenant'}`,
                'quizzes': `${quizzesPassed} quiz réussis !${quizzesPassed > 0 ? ' Tu progresses bien' : ' Lance ton premier quiz'}`,
                'rank': 'Classement: Non disponible pour le moment',
                'xp': `Points XP : ${userXP} XP accumulés !${userXP > 0 ? ' Niveau ' + userLevel : ' Commence à gagner des XP'}`,
                'streak': `Série de ${dailyStreak} jours !${dailyStreak > 0 ? ' Continue comme ça ! 🔥' : ' Commence ta série aujourd\'hui ! 🔥'}`
            };

            showToast(`📊 ${messages[type]}`, 'info', 6000);
            gainXP(5, 'Consultation stats détaillées');
        }

        function toggleNotifications() {
            showToast('💡 3 nouvelles notifications : Quiz disponible, Rappel révision, Nouveau badge débloqué', 'info');
        }

        // ========== SAUVEGARDE DONNÉES ==========
        function saveUserData() {
            const userData = {
                xp: userXP,
                level: userLevel,
                streak: dailyStreak,
                currentSection: currentSection
            };
            localStorage.setItem('claudyneMaxData', JSON.stringify(userData));
        }

        function loadUserData() {
            const saved = localStorage.getItem('claudyneMaxData');
            if (saved) {
                const data = JSON.parse(saved);
                userXP = data.xp || 0;
                userLevel = data.level || 1;
                dailyStreak = data.streak || 0;
                currentSection = data.currentSection || 'dashboard';
            }
        }

        // Sauvegarder périodiquement
        setInterval(saveUserData, 30000);
        window.addEventListener('beforeunload', saveUserData);

        // ========== RESPONSIVE ==========
        window.addEventListener('resize', function() {
            if (window.innerWidth > 1024) {
                document.getElementById('sidebar').classList.remove('open');
                document.getElementById('mainContent').classList.remove('expanded');
            }
        });

        // ========== FONCTIONS SPÉCIFIQUES AUX NOUVELLES SECTIONS ==========

        // Fonctions Cours
        function resumeCourse(subject) {
            const subjects = {
                math: 'Mathématiques - Dérivées',
                physics: 'Physique - Électricité',
                chemistry: 'Chimie - Réactions Organiques',
                french: 'Français - Littérature'
            };
            showToast(`📚 Reprise du cours: ${subjects[subject]}`, 'info');
            gainXP(10, `Reprise cours ${subjects[subject]}`);
        }

        // Fonctions Quiz
        function startAdaptiveQuiz() {
            showToast('🧠 L\'IA analyse votre profil cognitif...', 'info');
            setTimeout(() => {
                showToast('🎯 Quiz adaptatif prêt ! Difficulté optimisée pour vous', 'warning');
                gainXP(15, 'Lancement quiz adaptatif');
            }, 3000);
        }

        function startExamSimulation() {
            showToast('📝 Démarrage de la simulation BAC 2025...', 'info');
            setTimeout(() => {
                showToast('⏰ Simulation en cours - Conditions réelles d\'examen', 'warning');
                gainXP(25, 'Simulation BAC démarrée');
            }, 2000);
        }

        function startFlashQuiz(subject) {
            const subjects = {
                math: 'Mathématiques',
                physics: 'Physique',
                chemistry: 'Chimie'
            };
            showToast(`⚡ Quiz Flash ${subjects[subject]} démarré !`, 'success');
            gainXP(5, `Quiz Flash ${subjects[subject]}`);
        }

        function startRandomFlashQuiz() {
            showToast('🎲 Quiz Flash aléatoire généré par l\'IA !', 'success');
            gainXP(8, 'Quiz Flash aléatoire');
        }

        function viewAllChallenges() {
            showToast('🏆 Affichage de tous vos défis en cours et disponibles', 'info');
            gainXP(3, 'Consultation défis');
        }

        // Fonctions IA Mentor
        function handleAiInput(event) {
            if (event.key === 'Enter') {
                sendAiMessage();
            }
        }

        // AI Chat state management
        let aiSessionId = localStorage.getItem('ai_session_id') || null;
        let isAiLoading = false;

        // Load AI chat history
        async function loadAiChatHistory() {
            const token = localStorage.getItem('claudyne_token');
            if (!token) return;

            try {
                const API_BASE = 'https://claudyne.com';
                const endpoint = aiSessionId
                    ? `${API_BASE}/api/mentor/chat/${aiSessionId}`
                    : `${API_BASE}/api/mentor/chat`;

                const response = await fetch(endpoint, {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    const result = await response.json();
                    if (result.success && result.data.messages) {
                        // Clear existing messages except welcome message
                        const messagesContainer = document.getElementById('aiMessages');
                        messagesContainer.innerHTML = '';

                        // Add loaded messages
                        result.data.messages.forEach(msg => {
                            const sender = msg.role === 'user' ? 'user' : 'ai';
                            addAiMessage(msg.content, sender, false);
                        });

                        // Store sessionId
                        if (result.data.sessionId) {
                            aiSessionId = result.data.sessionId;
                            localStorage.setItem('ai_session_id', aiSessionId);
                        }

                        console.log('✅ Chat history loaded:', result.data.messages.length, 'messages');
                    }
                }
            } catch (error) {
                console.log('ℹ️ Could not load AI chat history:', error.message);
            }
        }

        async function sendAiMessage() {
            const input = document.getElementById('aiInput');
            const message = input.value.trim();

            if (!message || isAiLoading) return;

            const token = localStorage.getItem('claudyne_token');
            if (!token) {
                showToast('🔒 Vous devez être connecté pour utiliser MEUGACK', 'warning');
                return;
            }

            // Add user message immediately
            addAiMessage(message, 'user');
            input.value = '';
            isAiLoading = true;

            try {
                const API_BASE = 'https://claudyne.com';
                const response = await fetch(`${API_BASE}/api/mentor/chat`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        message: message,
                        sessionId: aiSessionId
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    if (result.success && result.data) {
                        // Store sessionId from response
                        if (result.data.sessionId) {
                            aiSessionId = result.data.sessionId;
                            localStorage.setItem('ai_session_id', aiSessionId);
                        }

                        // Add AI response
                        if (result.data.assistantMessage) {
                            addAiMessage(result.data.assistantMessage.content, 'ai');
                            gainXP(5, 'Interaction avec MEUGACK');
                        }
                    }
                } else {
                    throw new Error('Failed to get AI response');
                }
            } catch (error) {
                console.error('Error sending AI message:', error);
                addAiMessage('Désolé, je rencontre un problème technique. Réessaie dans quelques instants.', 'ai');
                showToast('❌ Erreur de connexion avec MEUGACK', 'error');
            } finally {
                isAiLoading = false;
            }
        }

        function addAiMessage(message, sender, autoScroll = true) {
            const messagesContainer = document.getElementById('aiMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `ai-message ${sender}`;

            if (sender === 'user') {
                messageDiv.innerHTML = `
                    <div class="message-bubble user">${message}</div>
                    <div class="message-avatar user">${profileData?.firstName?.charAt(0) || 'U'}</div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div class="message-avatar ai"><i class="fas fa-robot"></i></div>
                    <div class="message-bubble ai">${message}</div>
                `;
            }

            messagesContainer.appendChild(messageDiv);
            if (autoScroll) {
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }
        }

        // ========== PRIX CLAUDINE INTEGRATION ==========

        let prixClaudineData = {
            leaderboard: [],
            myAwards: null,
            stats: null
        };

        // Load Prix Claudine leaderboard and student's awards
        async function loadPrixClaudineData() {
            const token = localStorage.getItem('claudyne_token');
            if (!token) return;

            try {
                const API_BASE = 'https://claudyne.com';
                const headers = {
                    'Authorization': `Bearer ${token}`,
                    'Content-Type': 'application/json'
                };

                // Load leaderboard (top 3 for laureates section)
                try {
                    const leaderboardRes = await fetch(`${API_BASE}/api/prix-claudine/leaderboard?limit=3`, { headers });
                    if (leaderboardRes.ok) {
                        const result = await leaderboardRes.json();
                        if (result.success) {
                            prixClaudineData.leaderboard = result.data.leaderboard || [];
                            prixClaudineData.stats = result.data.stats || {};
                            updatePrixClaudineLaureates();
                            updatePrixClaudineStats();
                            console.log('✅ Prix Claudine leaderboard loaded:', prixClaudineData.leaderboard.length);
                        }
                    }
                } catch (err) {
                    console.log('ℹ️ Could not load Prix Claudine leaderboard');
                }

                // Load student's awards and progression
                try {
                    const myAwardsRes = await fetch(`${API_BASE}/api/prix-claudine/my-awards`, { headers });
                    if (myAwardsRes.ok) {
                        const result = await myAwardsRes.json();
                        if (result.success) {
                            prixClaudineData.myAwards = result.data;
                            updatePrixClaudineProgression();
                            console.log('✅ My Prix Claudine awards loaded');
                        }
                    }
                } catch (err) {
                    console.log('ℹ️ Could not load my Prix Claudine awards');
                }
            } catch (error) {
                console.log('ℹ️ Prix Claudine data loading skipped');
            }
        }

        function updatePrixClaudineStats() {
            if (!prixClaudineData.stats) return;

            // Update award stats section (participants, laureates, etc.)
            const statElements = document.querySelectorAll('.award-stats .stat-number');
            if (statElements.length >= 2) {
                if (prixClaudineData.stats.totalWinners) {
                    statElements[0].textContent = prixClaudineData.stats.totalWinners.toLocaleString();
                }
            }
        }

        function updatePrixClaudineLaureates() {
            if (!prixClaudineData.leaderboard || prixClaudineData.leaderboard.length === 0) return;

            const laureatesGrid = document.querySelector('.laureates-grid');
            if (!laureatesGrid) return;

            // Clear existing static laureates
            laureatesGrid.innerHTML = '';

            const ranks = ['gold', 'silver', 'bronze'];
            const medals = ['🥇', '🥈', '🥉'];
            const rankTitles = ['Grand Prix', 'Prix d\'Honneur', 'Prix du Mérite'];

            prixClaudineData.leaderboard.slice(0, 3).forEach((laureate, idx) => {
                const card = document.createElement('div');
                card.className = `laureate-card ${ranks[idx]}`;
                card.innerHTML = `
                    <div class="laureate-rank">
                        <div class="rank-medal">${medals[idx]}</div>
                        <div class="rank-title">${rankTitles[idx]}</div>
                    </div>
                    <div class="laureate-info">
                        <div class="laureate-avatar">${laureate.recipient?.avatar || '🎓'}</div>
                        <div class="laureate-details">
                            <div class="laureate-name">${laureate.recipient?.name || 'Anonymous'}</div>
                            <div class="laureate-specialty">${laureate.category || 'Non spécifié'}</div>
                            <div class="laureate-school">${laureate.recipient?.educationLevel || ''}</div>
                            <div class="laureate-achievement">
                                <span class="achievement-badge">🏆</span>
                                <span>${laureate.points} points</span>
                            </div>
                        </div>
                    </div>
                    <div class="laureate-distinctions">
                        <div class="distinction-item">
                            <i class="fas fa-star"></i>
                            <span>${laureate.title || 'Lauréat Prix Claudine'}</span>
                        </div>
                        ${laureate.testimonial ? `
                        <div class="distinction-item">
                            <i class="fas fa-quote-left"></i>
                            <span>${laureate.testimonial.substring(0, 100)}...</span>
                        </div>
                        ` : ''}
                    </div>
                `;
                laureatesGrid.appendChild(card);
            });
        }

        function updatePrixClaudineProgression() {
            if (!prixClaudineData.myAwards) return;

            const stats = prixClaudineData.myAwards.stats;

            // Update eligibility score
            const scoreEl = document.querySelector('.eligibility-score');
            if (scoreEl && stats.totalPoints) {
                scoreEl.textContent = `Score: ${stats.totalPoints}/1000`;
            }

            // Update student average
            const avgEl = document.getElementById('prix-claudine-average');
            if (avgEl && currentAverage) {
                avgEl.textContent = `Votre moyenne: ${currentAverage}/20`;
            }

            // Update current rank if available
            const rankEl = document.querySelector('.current-rank span');
            if (rankEl && stats.bestRank) {
                rankEl.innerHTML = `<i class="fas fa-medal"></i> <span>Rang actuel: ${stats.bestRank}</span>`;
            }

            // Update qualification status
            const qualificationEl = document.querySelector('.qualification-status');
            if (qualificationEl && stats.winnersCount > 0) {
                qualificationEl.classList.add('qualified');
                qualificationEl.textContent = '🎉 Lauréat(e) du Prix Claudine !';
            }
        }

        // ========== QUIZ INTEGRATION ==========

        let quizData = {
            available: [],
            challenges: { daily: [], weekly: [] },
            stats: null,
            recommendation: null
        };

        // Load Quiz data (quizzes, challenges, stats)
        async function loadQuizData() {
            const token = localStorage.getItem('claudyne_token');
            if (!token) return;

            try {
                const API_BASE = 'https://claudyne.com';
                const headers = {
                    'Authorization': `Bearer ${token}`,
                    'Content-Type': 'application/json'
                };

                // Load available quizzes
                try {
                    const quizzesRes = await fetch(`${API_BASE}/api/quiz/available?limit=20`, { headers });
                    if (quizzesRes.ok) {
                        const result = await quizzesRes.json();
                        if (result.success) {
                            quizData.available = result.data.quizzes || [];
                            quizData.recommendation = result.data.recommendation;
                            updateQuizRecommendation();
                            console.log('✅ Quiz disponibles chargés:', quizData.available.length);
                        }
                    }
                } catch (err) {
                    console.log('ℹ️ Could not load available quizzes');
                }

                // Load challenges (weekly/daily)
                try {
                    const challengesRes = await fetch(`${API_BASE}/api/quiz/challenges`, { headers });
                    if (challengesRes.ok) {
                        const result = await challengesRes.json();
                        if (result.success) {
                            quizData.challenges.daily = result.data.daily || [];
                            quizData.challenges.weekly = result.data.weekly || [];
                            updateWeeklyChallenges();
                            console.log('✅ Challenges chargés:', result.data.total);
                        }
                    }
                } catch (err) {
                    console.log('ℹ️ Could not load challenges');
                }

                // Load quiz stats
                try {
                    const statsRes = await fetch(`${API_BASE}/api/quiz/stats`, { headers });
                    if (statsRes.ok) {
                        const result = await statsRes.json();
                        if (result.success) {
                            quizData.stats = result.data;
                            updateQuizStats();
                            console.log('✅ Quiz stats chargées');
                        }
                    }
                } catch (err) {
                    console.log('ℹ️ Could not load quiz stats');
                }
            } catch (error) {
                console.log('ℹ️ Quiz data loading skipped');
            }
        }

        function updateQuizRecommendation() {
            if (!quizData.recommendation) return;

            // Update AI recommendation section
            const recommendationSection = document.querySelector('.ai-thinking').nextElementSibling;
            if (recommendationSection) {
                recommendationSection.innerHTML = `
                    <p><strong>🎯 Recommandation :</strong> ${quizData.recommendation.title}</p>
                    <p><strong>⏱️ Temps estimé :</strong> ${quizData.recommendation.estimatedDuration || 10} minutes</p>
                    <p><strong>🎮 Récompense :</strong> ${quizData.recommendation.rewardXP || 50} XP</p>
                `;
            }
        }

        function updateWeeklyChallenges() {
            const challengesContainer = document.querySelector('.weekly-challenges');
            if (!challengesContainer || quizData.challenges.weekly.length === 0) return;

            // Clear existing challenges
            challengesContainer.innerHTML = '';

            // Add first 2 weekly challenges
            quizData.challenges.weekly.slice(0, 2).forEach(challenge => {
                const challengeDiv = document.createElement('div');
                challengeDiv.className = `challenge-item ${challenge.isCompleted ? 'completed' : 'active'}`;
                challengeDiv.innerHTML = `
                    <div class="challenge-info">
                        <h4>${challenge.icon || '🎯'} ${challenge.title}</h4>
                        <p>${challenge.description}</p>
                        <div class="challenge-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${challenge.progressPercentage || 0}%"></div>
                            </div>
                            <span>${challenge.currentValue || 0}/${challenge.targetValue} ${challenge.unit}</span>
                        </div>
                    </div>
                    <div class="challenge-reward">${challenge.reward?.xp || 0} XP</div>
                `;
                challengesContainer.appendChild(challengeDiv);
            });
        }

        function updateQuizStats() {
            if (!quizData.stats) return;

            // Update BAC simulation stats
            const examStats = document.querySelector('.exam-stats');
            if (examStats) {
                const avgScore = quizData.stats.averageScore || 0;
                const recentProgress = quizData.stats.recentProgress || 0;
                examStats.innerHTML = `
                    <p><strong>📊 Score moyen :</strong> ${avgScore}/100</p>
                    <p><strong>📈 Progression :</strong> ${recentProgress > 0 ? '+' : ''}${recentProgress}% récemment</p>
                    <p><strong>🎯 Total quiz :</strong> ${quizData.stats.totalQuizzes || 0} complétés</p>
                `;
            }

            // Update progress bar
            const progressFill = document.querySelector('#quiz .progress-fill');
            if (progressFill && quizData.stats.averageScore) {
                progressFill.style.width = `${quizData.stats.averageScore}%`;
            }
        }

        // ===== REVISIONS IA SECTION =====
        let revisionsData = {
            planning: null,
            flashcards: { urgent: [], review: [], mastered: [], stats: {} },
            activeSession: null
        };

        async function loadRevisionsData() {
            try {
                const token = localStorage.getItem('claudyne_token');
                if (!token) {
                    console.log('[Revisions] No auth token found');
                    return;
                }

                // Load weekly planning
                const planningRes = await fetch(`${API_BASE}/api/revisions/planning`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                if (planningRes.ok) {
                    const result = await planningRes.json();
                    if (result.success && result.data) {
                        revisionsData.planning = result.data;
                        updateWeeklySchedule();
                    }
                }

                // Load flashcards
                const flashcardsRes = await fetch(`${API_BASE}/api/revisions/flashcards?category=all`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                if (flashcardsRes.ok) {
                    const result = await flashcardsRes.json();
                    if (result.success && result.data) {
                        revisionsData.flashcards.urgent = result.data.urgent || [];
                        revisionsData.flashcards.review = result.data.review || [];
                        revisionsData.flashcards.mastered = result.data.mastered || [];
                        revisionsData.flashcards.stats = result.data.stats || {};
                        updateFlashcardCategories();
                    }
                }

                // Load active session
                const sessionRes = await fetch(`${API_BASE}/api/revisions/session`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                if (sessionRes.ok) {
                    const result = await sessionRes.json();
                    if (result.success && result.data) {
                        revisionsData.activeSession = result.data;
                    }
                }

            } catch (error) {
                console.error('[Revisions] Error loading data:', error);
            }
        }

        function updateWeeklySchedule() {
            const scheduleGrid = document.querySelector('.schedule-grid');
            if (!scheduleGrid || !revisionsData.planning) return;

            const weeklySchedule = revisionsData.planning.weeklySchedule || [];
            const efficiencyScore = revisionsData.planning.efficiencyScore || 0;

            // Update efficiency score
            const efficiencyEl = document.querySelector('.efficiency-score');
            if (efficiencyEl) {
                efficiencyEl.textContent = `Efficacité prévue: ${efficiencyScore}%`;
            }

            // Update schedule header with date range
            if (weeklySchedule.length > 0) {
                const firstDate = new Date(weeklySchedule[0].date);
                const lastDate = new Date(weeklySchedule[weeklySchedule.length - 1].date);
                const scheduleHeaderH4 = document.querySelector('.schedule-header h4');
                if (scheduleHeaderH4) {
                    const formatDate = (d) => `${d.getDate()} ${['Jan', 'Fév', 'Mar', 'Avr', 'Mai', 'Juin', 'Juil', 'Août', 'Sep', 'Oct', 'Nov', 'Déc'][d.getMonth()]}`;
                    scheduleHeaderH4.textContent = `Semaine du ${formatDate(firstDate)} - ${formatDate(lastDate)} ${firstDate.getFullYear()}`;
                }
            }

            // Clear existing schedule
            scheduleGrid.innerHTML = '';

            // Add only first 2 days (today and tomorrow)
            weeklySchedule.slice(0, 2).forEach((day, index) => {
                const dayDiv = document.createElement('div');
                dayDiv.className = 'schedule-day';

                const dayHeader = document.createElement('div');
                dayHeader.className = 'day-header';
                dayHeader.textContent = day.isToday ? 'Aujourd\'hui' : index === 1 ? 'Demain' : day.day;

                const daySessions = document.createElement('div');
                daySessions.className = 'day-sessions';

                // Add sessions for this day
                (day.sessions || []).forEach(session => {
                    const sessionDiv = document.createElement('div');
                    sessionDiv.className = `session ${session.priority === 'urgent' ? 'urgent' : session.priority === 'normal' ? 'normal' : 'light'}`;

                    sessionDiv.innerHTML = `
                        <div class="session-time">${session.time}</div>
                        <div class="session-subject">${session.subject}</div>
                        <div class="session-topic">${session.topic}</div>
                        <div class="session-priority">${session.priority === 'urgent' ? 'Priorité max' : session.priority === 'normal' ? 'Révision' : 'Révision espacée'}</div>
                    `;

                    daySessions.appendChild(sessionDiv);
                });

                dayDiv.appendChild(dayHeader);
                dayDiv.appendChild(daySessions);
                scheduleGrid.appendChild(dayDiv);
            });
        }

        function updateFlashcardCategories() {
            const stats = revisionsData.flashcards.stats;

            // Update category tabs with counts
            const categoryTabs = document.querySelectorAll('.category-tab');
            if (categoryTabs.length >= 3) {
                categoryTabs[0].innerHTML = `⚠️ Urgent (${stats.urgentCount || 0})`;
                categoryTabs[1].innerHTML = `🔄 À revoir (${stats.reviewCount || 0})`;
                categoryTabs[2].innerHTML = `✅ Maîtrisé (${stats.masteredCount || 0})`;
            }

            // Update urgent flashcards display
            updateFlashcardDisplay('urgent');
        }

        function updateFlashcardDisplay(category) {
            const flashcardDeck = document.querySelector(`#${category}-flashcards .flashcard-deck`);
            if (!flashcardDeck) return;

            const flashcards = revisionsData.flashcards[category] || [];
            flashcardDeck.innerHTML = '';

            if (flashcards.length === 0) {
                flashcardDeck.innerHTML = `<div class="coming-soon">Aucune fiche dans cette catégorie</div>`;
                return;
            }

            // Display up to 5 flashcards
            flashcards.slice(0, 5).forEach(card => {
                const cardDiv = document.createElement('div');
                cardDiv.className = `flashcard-item priority-${card.priority}`;

                const difficultyMap = { easy: 'Facile', medium: 'Moyen', hard: 'Difficile' };
                const difficultyClass = card.difficulty || 'medium';

                cardDiv.innerHTML = `
                    <div class="flashcard-subject">${card.subject}</div>
                    <div class="flashcard-question">${card.question}</div>
                    <div class="flashcard-meta">
                        <span class="difficulty ${difficultyClass}">${difficultyMap[difficultyClass] || 'Moyen'}</span>
                        <span class="last-seen">Vu il y a ${card.lastSeen} jour${card.lastSeen > 1 ? 's' : ''}</span>
                        <span class="success-rate">${card.successRate}% de réussite</span>
                    </div>
                    <div class="flashcard-actions">
                        <button class="btn btn-sm btn-primary">Réviser</button>
                        <button class="btn btn-sm btn-secondary">Voir solution</button>
                    </div>
                `;

                flashcardDeck.appendChild(cardDiv);
            });
        }

        function showFlashcardCategory(category) {
            // Update active tab
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            // Update active category display
            document.querySelectorAll('.flashcard-category').forEach(cat => {
                cat.classList.remove('active');
            });

            const categoryDiv = document.getElementById(`${category}-flashcards`);
            if (categoryDiv) {
                categoryDiv.classList.add('active');
            }

            // Load flashcards for this category
            updateFlashcardDisplay(category);
        }

        function optimizeSchedule() {
            showToast('🤖 Ré-optimisation du planning en cours...', 'info');
            setTimeout(() => {
                loadRevisionsData();
                showToast('✅ Planning optimisé selon vos derniers progrès', 'success');
            }, 2000);
        }

        function customizeSchedule() {
            showToast('⚙️ Personnalisation du planning - Fonctionnalité en cours de développement', 'info');
        }

        function generateNewFlashcards() {
            showToast('🎴 Génération de nouvelles fiches de révision...', 'info');
            setTimeout(() => {
                loadRevisionsData();
                showToast('✨ 12 nouvelles fiches créées selon vos besoins', 'success');
                gainXP(15, 'Fiches de révision générées');
            }, 2000);
        }

        function pauseRevision() {
            showToast('⏸️ Session mise en pause', 'info');
        }

        function continueRevision() {
            showToast('▶️ Reprise de la session de révision', 'success');
        }

        function endRevision() {
            showToast('🎉 Session terminée ! Excellent travail !', 'success');
            gainXP(50, 'Session de révision complétée');
        }

        // ===== ORIENTATION SECTION =====
        let orientationData = {
            profile: null,
            recommendations: [],
            careers: null,
            institutions: [],
            actionPlan: null
        };

        async function loadOrientationData() {
            try {
                const token = localStorage.getItem('claudyne_token');
                if (!token) {
                    console.log('[Orientation] No auth token found');
                    return;
                }

                // Load AI recommendations and profile
                const recommendationsRes = await fetch(`${API_BASE}/api/orientation/recommendations`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                if (recommendationsRes.ok) {
                    const result = await recommendationsRes.json();
                    if (result.success && result.data) {
                        orientationData.profile = result.data.profile;
                        orientationData.recommendations = result.data.recommendations || [];
                        updateOrientationProfile();
                        updateTopRecommendations();
                    }
                }

                // Load career categories
                const careersRes = await fetch(`${API_BASE}/api/orientation/careers`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                if (careersRes.ok) {
                    const result = await careersRes.json();
                    if (result.success && result.data) {
                        orientationData.careers = result.data;
                        updateCareerCategories();
                        updateTrendingCareers();
                    }
                }

                // Load institutions
                const institutionsRes = await fetch(`${API_BASE}/api/orientation/institutions`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                if (institutionsRes.ok) {
                    const result = await institutionsRes.json();
                    if (result.success && result.data) {
                        orientationData.institutions = result.data.institutions || [];
                        updateInstitutionRecommendations();
                        updateApplicationTimeline(result.data.timeline);
                    }
                }

                // Load action plan
                const actionPlanRes = await fetch(`${API_BASE}/api/orientation/action-plan`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                if (actionPlanRes.ok) {
                    const result = await actionPlanRes.json();
                    if (result.success && result.data) {
                        orientationData.actionPlan = result.data;
                    }
                }

            } catch (error) {
                console.error('[Orientation] Error loading data:', error);
            }
        }

        function updateOrientationProfile() {
            const profileMatch = document.querySelector('.profile-match');
            if (!profileMatch || !orientationData.profile) return;

            const matchTitle = profileMatch.querySelector('.match-title');
            const matchDesc = profileMatch.querySelector('.match-desc');
            const aiConfidence = document.querySelector('.ai-confidence');

            if (matchTitle) {
                matchTitle.textContent = `Profil détecté : ${orientationData.profile.name}`;
            }

            if (matchDesc) {
                matchDesc.textContent = orientationData.profile.description;
            }

            if (aiConfidence) {
                aiConfidence.textContent = `Fiabilité : ${orientationData.profile.confidence || 94}%`;
            }
        }

        function updateTopRecommendations() {
            const topRecommendations = document.querySelector('.top-recommendations');
            if (!topRecommendations || !orientationData.recommendations.length) return;

            topRecommendations.innerHTML = '';

            orientationData.recommendations.slice(0, 3).forEach((rec, index) => {
                const priority = index + 1;
                const recDiv = document.createElement('div');
                recDiv.className = `recommendation-item priority-${priority}`;

                recDiv.innerHTML = `
                    <div class="rec-rank">${priority}</div>
                    <div class="rec-field">
                        <div class="field-icon">${rec.icon}</div>
                        <div class="field-name">${rec.name}</div>
                    </div>
                    <div class="rec-match">
                        <div class="match-score">${rec.match}%</div>
                        <div class="match-reasons">
                            ${rec.reasons.map(r => `<span>${r}</span>`).join('')}
                        </div>
                    </div>
                    <button class="btn btn-sm btn-${priority === 1 ? 'primary' : priority === 2 ? 'secondary' : 'info'}" onclick="exploreCareer('${rec.name.toLowerCase()}')">Explorer</button>
                `;

                topRecommendations.appendChild(recDiv);
            });
        }

        function updateCareerCategories() {
            if (!orientationData.careers || !orientationData.careers.categories) return;

            const categoryGrid = document.querySelector('.category-grid');
            if (!categoryGrid) return;

            categoryGrid.innerHTML = '';

            Object.entries(orientationData.careers.categories).forEach(([key, category]) => {
                const catDiv = document.createElement('div');
                catDiv.className = 'career-category';
                catDiv.onclick = () => showCareerCategory(key);

                catDiv.innerHTML = `
                    <div class="category-icon">${category.icon}</div>
                    <div class="category-name">${category.name}</div>
                    <div class="category-count">${category.count} métiers</div>
                `;

                categoryGrid.appendChild(catDiv);
            });
        }

        function updateTrendingCareers() {
            if (!orientationData.careers || !orientationData.careers.trending) return;

            const trendingList = document.querySelector('.trending-list');
            if (!trendingList) return;

            trendingList.innerHTML = '';

            orientationData.careers.trending.slice(0, 3).forEach(career => {
                const trendingDiv = document.createElement('div');
                trendingDiv.className = 'trending-item';

                trendingDiv.innerHTML = `
                    <div class="trending-badge">${career.badge}</div>
                    <div class="trending-name">${career.name}</div>
                    <div class="trending-growth">+${career.growth}% demande</div>
                `;

                trendingList.appendChild(trendingDiv);
            });
        }

        function updateInstitutionRecommendations() {
            const institutionRecommendations = document.querySelector('.institution-recommendations');
            if (!institutionRecommendations || !orientationData.institutions.length) return;

            institutionRecommendations.innerHTML = '';

            orientationData.institutions.slice(0, 3).forEach((inst, index) => {
                const matchClass = index === 0 ? 'match-high' : index === 1 ? 'match-medium' : 'match-good';
                const instDiv = document.createElement('div');
                instDiv.className = `institution-item ${matchClass}`;

                instDiv.innerHTML = `
                    <div class="institution-logo">${inst.logo}</div>
                    <div class="institution-info">
                        <div class="institution-name">${inst.name}</div>
                        <div class="institution-program">${inst.program}</div>
                        <div class="institution-location">📍 ${inst.location}</div>
                        <div class="institution-stats">
                            <span class="acceptance-rate">${inst.acceptanceRate}% admission</span>
                            <span class="match-score">Compatibilité: ${inst.matchScore}%</span>
                        </div>
                    </div>
                    <div class="institution-actions">
                        <button class="btn btn-sm btn-${index === 0 ? 'primary' : index === 1 ? 'secondary' : 'info'}" onclick="exploreInstitution('${inst.id}')">Détails</button>
                    </div>
                `;

                institutionRecommendations.appendChild(instDiv);
            });
        }

        function updateApplicationTimeline(timeline) {
            if (!timeline) return;

            const timelineEvents = document.querySelector('.timeline-events');
            if (!timelineEvents) return;

            timelineEvents.innerHTML = '';

            timeline.forEach(event => {
                const eventDiv = document.createElement('div');
                eventDiv.className = `timeline-event ${event.status}`;

                eventDiv.innerHTML = `
                    <div class="event-date">${event.date}</div>
                    <div class="event-title">${event.title}</div>
                    <div class="event-status">${event.statusText}</div>
                `;

                timelineEvents.appendChild(eventDiv);
            });
        }

        function exploreCareer(career) {
            showToast(`🎯 Exploration de la carrière: ${career}`, 'info');
            gainXP(10, 'Carrière explorée');
        }

        function showCareerCategory(category) {
            showToast(`📚 Affichage des métiers: ${category}`, 'info');
        }

        function exploreInstitution(instId) {
            showToast(`🏫 Détails de l'établissement: ${instId}`, 'info');
            gainXP(15, 'Établissement exploré');
        }

        function filterByLocation(location) {
            showToast(`📍 Filtrage par région: ${location}`, 'info');
            loadOrientationData(); // Reload with filter
        }

        function generateDetailedPath() {
            showToast('🗺️ Génération d\'un parcours détaillé personnalisé...', 'info');
            setTimeout(() => {
                showToast('✨ Parcours généré ! Consultez votre plan d\'action', 'success');
                gainXP(25, 'Parcours détaillé généré');
            }, 2000);
        }

        function takeOrientationQuiz() {
            showToast('📝 Quiz d\'orientation en cours de développement', 'info');
        }

        // ===== BIEN-ÊTRE (WELLNESS) SECTION =====
        let wellnessData = {
            metrics: null,
            exercises: [],
            breaks: []
        };

        async function loadWellnessData() {
            try {
                const token = localStorage.getItem('claudyne_token');
                if (!token) {
                    console.log('[Wellness] No auth token found');
                    return;
                }

                // Load wellness metrics
                const metricsRes = await fetch(`${API_BASE}/api/wellness/metrics`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                if (metricsRes.ok) {
                    const result = await metricsRes.json();
                    if (result.success && result.data) {
                        wellnessData.metrics = result.data;
                        updateWellnessMetrics();
                        updateWellnessRecommendations();
                    }
                }

                // Load relaxation exercises
                const exercisesRes = await fetch(`${API_BASE}/api/wellness/exercises`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                if (exercisesRes.ok) {
                    const result = await exercisesRes.json();
                    if (result.success && result.data) {
                        wellnessData.exercises = result.data.exercises || [];
                    }
                }

                // Load smart breaks schedule
                const breaksRes = await fetch(`${API_BASE}/api/wellness/breaks`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                if (breaksRes.ok) {
                    const result = await breaksRes.json();
                    if (result.success && result.data) {
                        wellnessData.breaks = result.data.breaks || [];
                        updateSmartBreaks(result.data.nextBreak);
                    }
                }

            } catch (error) {
                console.error('[Wellness] Error loading data:', error);
            }
        }

        function updateWellnessMetrics() {
            if (!wellnessData.metrics) return;

            // Update wellness score
            const wellnessScoreEl = document.querySelector('.wellness-score');
            if (wellnessScoreEl) {
                wellnessScoreEl.textContent = `Score: ${wellnessData.metrics.wellnessScore}/100`;
            }

            // Update stress metric
            const stressMetric = wellnessData.metrics.metrics.stress;
            const stressBar = document.querySelector('.metric-icon.stress')?.parentElement.parentElement.querySelector('.metric-fill');
            const stressValue = document.querySelector('.metric-icon.stress')?.parentElement.parentElement.querySelector('.metric-value');
            if (stressBar && stressValue) {
                stressBar.style.width = `${stressMetric.level}%`;
                stressBar.className = `metric-fill ${stressMetric.status}`;
                stressValue.textContent = `${stressMetric.label} (${stressMetric.level}%)`;
            }

            // Update energy metric
            const energyMetric = wellnessData.metrics.metrics.energy;
            const energyBar = document.querySelector('.metric-icon.energy')?.parentElement.parentElement.querySelector('.metric-fill');
            const energyValue = document.querySelector('.metric-icon.energy')?.parentElement.parentElement.querySelector('.metric-value');
            if (energyBar && energyValue) {
                energyBar.style.width = `${energyMetric.level}%`;
                energyBar.className = `metric-fill ${energyMetric.status}`;
                energyValue.textContent = `${energyMetric.label} (${energyMetric.level}%)`;
            }

            // Update focus metric
            const focusMetric = wellnessData.metrics.metrics.focus;
            const focusBar = document.querySelector('.metric-icon.focus')?.parentElement.parentElement.querySelector('.metric-fill');
            const focusValue = document.querySelector('.metric-icon.focus')?.parentElement.parentElement.querySelector('.metric-value');
            if (focusBar && focusValue) {
                focusBar.style.width = `${focusMetric.level}%`;
                focusBar.className = `metric-fill ${focusMetric.status}`;
                focusValue.textContent = `${focusMetric.label} (${focusMetric.level}%)`;
            }
        }

        function updateWellnessRecommendations() {
            if (!wellnessData.metrics || !wellnessData.metrics.recommendations) return;

            const recList = document.querySelector('.wellness-recommendations ul');
            if (!recList) return;

            recList.innerHTML = '';
            wellnessData.metrics.recommendations.forEach(rec => {
                const li = document.createElement('li');
                li.textContent = rec;
                recList.appendChild(li);
            });
        }

        function updateSmartBreaks(nextBreak) {
            if (!wellnessData.breaks.length) return;

            const breakSchedule = document.querySelector('.break-schedule');
            if (!breakSchedule) return;

            breakSchedule.innerHTML = '';

            wellnessData.breaks.forEach(breakItem => {
                const breakDiv = document.createElement('div');
                breakDiv.className = `break-item ${breakItem.status}`;

                breakDiv.innerHTML = `
                    <div class="break-time">${breakItem.time}</div>
                    <div class="break-type">${breakItem.type}</div>
                    <div class="break-status">${breakItem.statusLabel}</div>
                `;

                breakSchedule.appendChild(breakDiv);
            });

            // Update next break status
            const breakStatusEl = document.querySelector('.break-status');
            if (breakStatusEl && nextBreak) {
                breakStatusEl.textContent = `Prochaine pause: ${nextBreak}`;
            }
        }

        function startMeditation() {
            showToast('🧘 Démarrage de la méditation guidée...', 'info');
            gainXP(15, 'Session de méditation');
        }

        function startBreathing() {
            showToast('🫁 Exercice de respiration 4-7-8 démarré', 'info');
            gainXP(10, 'Exercice de respiration');
        }

        function playNatureSounds() {
            showToast('🎵 Sons de la nature activés', 'success');
        }

        async function takeBreak() {
            try {
                const token = localStorage.getItem('claudyne_token');
                if (!token) return;

                const response = await fetch(`${API_BASE}/api/wellness/break/take`, {
                    method: 'POST',
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                if (response.ok) {
                    const result = await response.json();
                    if (result.success) {
                        showToast('⏸️ Pause démarrée ! Prenez 5 minutes', 'success');
                        gainXP(20, 'Pause bien-être prise');
                    }
                }
            } catch (error) {
                console.error('[Wellness] Error taking break:', error);
                showToast('⏸️ Pause démarrée !', 'info');
            }
        }

        // ===== COMMUNITY SECTION =====
        let communityData = {
            groups: [],
            leaderboard: [],
            discussions: []
        };

        async function loadCommunityData() {
            try {
                const token = localStorage.getItem('claudyne_token');
                if (!token) {
                    console.log('[Community] No auth token found');
                    return;
                }

                // Load study groups
                const groupsRes = await fetch(`${API_BASE}/api/community/groups?status=active`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                if (groupsRes.ok) {
                    const result = await groupsRes.json();
                    if (result.success && result.data) {
                        communityData.groups = result.data.groups || [];
                        updateStudyGroups();
                    }
                }

                // Load weekly leaderboard
                const leaderboardRes = await fetch(`${API_BASE}/api/community/leaderboard?period=weekly&limit=10`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                if (leaderboardRes.ok) {
                    const result = await leaderboardRes.json();
                    if (result.success && result.data) {
                        communityData.leaderboard = result.data.leaderboard || [];
                        updateLeaderboard();
                    }
                }

                // Load recent discussions
                const discussionsRes = await fetch(`${API_BASE}/api/community/discussions?limit=10`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                if (discussionsRes.ok) {
                    const result = await discussionsRes.json();
                    if (result.success && result.data) {
                        communityData.discussions = result.data.discussions || [];
                        updateDiscussions();
                    }
                }

            } catch (error) {
                console.error('[Community] Error loading data:', error);
            }
        }

        function updateStudyGroups() {
            const groupList = document.querySelector('.group-list');
            if (!groupList || !communityData.groups.length) return;

            groupList.innerHTML = '';

            communityData.groups.forEach(group => {
                const groupDiv = document.createElement('div');
                groupDiv.className = `group-item ${group.isActive ? 'active' : ''}`;

                groupDiv.innerHTML = `
                    <div class="group-avatar">${group.avatar}</div>
                    <div class="group-info">
                        <div class="group-name">${group.name}</div>
                        <div class="group-stats">${group.memberCount} membres • ${group.activeMembers} actifs</div>
                        <div class="group-topic">Actuellement: ${group.currentTopic}</div>
                    </div>
                    <div class="group-actions">
                        <button class="btn btn-sm ${group.isActive ? 'btn-success' : 'btn-outline'}" onclick="joinGroup('${group.id}', '${group.name}')">${group.isActive ? 'Rejoindre' : 'Voir'}</button>
                    </div>
                `;

                groupList.appendChild(groupDiv);
            });
        }

        function updateLeaderboard() {
            const leaderboardList = document.querySelector('.leaderboard-list');
            if (!leaderboardList || !communityData.leaderboard.length) return;

            leaderboardList.innerHTML = '';

            communityData.leaderboard.forEach((entry, index) => {
                const rankClass = index === 0 ? 'rank-1' : index === 1 ? 'rank-2' : index === 2 ? 'rank-3' : entry.isCurrentUser ? 'your-rank' : '';
                const rankDiv = document.createElement('div');
                rankDiv.className = `rank-item ${rankClass}`;

                const rankAvatar = index === 0 ? '🥇' : index === 1 ? '🥈' : index === 2 ? '🥉' : entry.isCurrentUser ? '👤' : entry.avatar;

                rankDiv.innerHTML = `
                    <div class="rank-number">${entry.rank}</div>
                    <div class="rank-avatar">${rankAvatar}</div>
                    <div class="rank-info">
                        <div class="rank-name">${entry.isCurrentUser ? 'Vous' : entry.displayName}</div>
                        <div class="rank-points">${entry.xp.toLocaleString()} XP cette semaine</div>
                    </div>
                `;

                leaderboardList.appendChild(rankDiv);
            });
        }

        function updateDiscussions() {
            const discussionList = document.querySelector('.discussion-list');
            if (!discussionList || !communityData.discussions.length) return;

            discussionList.innerHTML = '';

            communityData.discussions.forEach(disc => {
                const discDiv = document.createElement('div');
                discDiv.className = 'discussion-item';

                discDiv.innerHTML = `
                    <div class="discussion-avatar">${disc.avatar}</div>
                    <div class="discussion-info">
                        <div class="discussion-title">${disc.title}</div>
                        <div class="discussion-meta">${disc.meta}</div>
                    </div>
                    <div class="discussion-status ${disc.status}">${disc.statusLabel}</div>
                `;

                discussionList.appendChild(discDiv);
            });
        }

        async function joinGroup(groupId, groupName) {
            try {
                const token = localStorage.getItem('claudyne_token');
                if (!token) return;

                const response = await fetch(`${API_BASE}/api/community/groups/join`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ groupId })
                });

                if (response.ok) {
                    const result = await response.json();
                    if (result.success) {
                        showToast(`✅ Vous avez rejoint "${groupName}"`, 'success');
                        gainXP(30, 'Groupe d\'étude rejoint');
                    }
                }
            } catch (error) {
                console.error('[Community] Error joining group:', error);
                showToast(`✅ Vous avez rejoint "${groupName}"`, 'success');
            }
        }

        function createStudyGroup() {
            showToast('📚 Création de groupe en cours de développement', 'info');
        }

        function viewAllDiscussions() {
            showToast('💬 Forum complet en cours de développement', 'info');
        }

        function generateStudyPlan() {
            showToast('📊 Génération du plan d\'étude optimal basé sur l\'IA...', 'info');
            setTimeout(() => {
                showToast('🚀 Plan personnalisé généré ! 3 semaines pour atteindre vos objectifs', 'success');
                gainXP(30, 'Plan d\'étude IA généré');
            }, 2500);
        }

        function viewDetailedPredictions() {
            showToast('🔮 Affichage des prédictions détaillées et recommandations personnalisées', 'info');
            gainXP(8, 'Consultation prédictions détaillées');
        }

        function generatePersonalizedContent() {
            showToast('🎨 Création de contenu personnalisé pour votre profil d\'apprentissage...', 'info');
            setTimeout(() => {
                showToast('✨ Contenu adaptatif généré ! Diagrammes et vidéos personnalisées ajoutées', 'success');
                gainXP(20, 'Contenu personnalisé généré');
            }, 3000);
        }

        // Fonction pour simuler activité (pour démonstration)
        function simulateAIActivity() {
            const activities = [
                { action: 'Analyse des performances terminée', xp: 15 },
                { action: 'Nouveau contenu personnalisé disponible', xp: 12 },
                { action: 'Prédictions BAC mises à jour', xp: 8 },
                { action: 'Recommandation d\'étude générée', xp: 10 }
            ];

            setInterval(() => {
                if (Math.random() > 0.8) { // 20% de chance
                    const activity = activities[Math.floor(Math.random() * activities.length)];
                    showToast(`🤖 IA: ${activity.action}`, 'info', 4000);
                    gainXP(activity.xp, 'Activité IA automatique');
                }
            }, 45000); // Toutes les 45 secondes
        }

        // Démarrer l'activité IA automatique
        setTimeout(simulateAIActivity, 10000);

        // ========== NOUVELLES FONCTIONS POUR SECTIONS ENRICHIES ==========

        // Fonctions pour la gestion des badges par catégorie
        function showBadgeCategory(category) {
            // Masquer toutes les catégories
            document.querySelectorAll('.badge-category').forEach(cat => {
                cat.classList.remove('active');
            });

            // Désactiver tous les boutons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // Afficher la catégorie sélectionnée
            const targetCategory = document.getElementById(category + '-badges');
            if (targetCategory) {
                targetCategory.classList.add('active');
            }

            // Activer le bouton correspondant
            event.target.classList.add('active');

            showToast(`🏆 Badges ${category} affichés`, 'info');
        }

        // Fonctions pour les exercices de bien-être
        function startMeditation() {
            showToast('🧘 Séance de méditation guidée démarrée...', 'info');
            setTimeout(() => {
                showToast('🎵 Respirez profondément et détendez-vous', 'success');
                gainXP(10, 'Session méditation');
            }, 2000);
        }

        function startBreathing() {
            showToast('🫁 Exercice de respiration 4-7-8 commencé', 'info');
            setTimeout(() => {
                showToast('💨 Inspirez 4s, retenez 7s, expirez 8s', 'warning');
                gainXP(5, 'Exercice respiration');
            }, 1500);
        }

        function playNatureSounds() {
            showToast('🎵 Sons de la nature activés - Ambiance relaxante', 'success');
            gainXP(3, 'Écoute sons nature');
        }

        function takeBreak() {
            showToast('⏸️ Pause bien-être activée - Prenez soin de vous !', 'info');
            setTimeout(() => {
                showToast('🌟 Pause terminée - Vous êtes rechargé(e) !', 'success');
                gainXP(8, 'Pause bien-être');
            }, 5000);
        }

        // Fonctions pour la communauté
        function joinGroup(groupName) {
            showToast(`👥 Rejointe le groupe: ${groupName}`, 'success');
            gainXP(15, `Groupe rejoint: ${groupName}`);
        }

        function createStudyGroup() {
            showToast('✨ Création de groupe d\'étude...', 'info');
            setTimeout(() => {
                showToast('🎉 Votre groupe "Révisions BAC 2025" a été créé !', 'success');
                gainXP(25, 'Création groupe étude');
            }, 2000);
        }

        function viewAllDiscussions() {
            showToast('💬 Chargement de toutes les discussions...', 'info');
            gainXP(3, 'Consultation forum');
        }

        // Fonctions pour les paramètres
        let settingsData = null;

        async function loadSettings() {
            try {
                const token = localStorage.getItem('claudyne_token');
                if (!token) return;

                const response = await fetch(`${API_BASE}/api/students/settings`, {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) return;

                const result = await response.json();
                if (result.success) {
                    settingsData = result.data;
                    populateSettingsForm(settingsData);
                    console.log('✅ Paramètres chargés');
                }
            } catch (error) {
                console.log('ℹ️ Erreur chargement paramètres:', error.message);
            }
        }

        function populateSettingsForm(settings) {
            if (!settings) return;

            // Profil
            if (settings.profile) {
                const fields = ['firstName', 'lastName', 'nickname', 'email', 'phone', 'address', 'city', 'country'];
                fields.forEach(field => {
                    const input = document.getElementById(`setting-${field}`);
                    if (input && settings.profile[field]) {
                        input.value = settings.profile[field];
                    }
                });
            }

            // Education
            if (settings.education) {
                const educationLevel = document.getElementById('setting-educationLevel');
                const schoolName = document.getElementById('setting-schoolName');
                const targetGrade = document.getElementById('setting-targetGrade');

                if (educationLevel && settings.education.educationLevel) {
                    educationLevel.value = settings.education.educationLevel;
                }
                if (schoolName && settings.education.schoolName) {
                    schoolName.value = settings.education.schoolName;
                }
                if (targetGrade && settings.education.targetGrade) {
                    targetGrade.value = settings.education.targetGrade;
                }
            }

            // Préférences d'apprentissage
            if (settings.learning) {
                const adaptiveDifficulty = document.getElementById('setting-adaptiveDifficulty');
                const detailedExplanations = document.getElementById('setting-detailedExplanations');
                const spacedRepetition = document.getElementById('setting-spacedRepetition');
                const difficultyLevel = document.getElementById('setting-difficultyLevel');

                if (adaptiveDifficulty) adaptiveDifficulty.checked = settings.learning.adaptiveDifficulty !== false;
                if (detailedExplanations) detailedExplanations.checked = settings.learning.detailedExplanations !== false;
                if (spacedRepetition) spacedRepetition.checked = settings.learning.spacedRepetition !== false;
                if (difficultyLevel && settings.learning.difficultyLevel) {
                    difficultyLevel.value = settings.learning.difficultyLevel;
                }
            }

            // Notifications
            if (settings.notifications) {
                const notifFields = ['studyReminders', 'newChallenges', 'smartBreaks', 'community'];
                notifFields.forEach(field => {
                    const checkbox = document.getElementById(`setting-notif-${field}`);
                    if (checkbox) {
                        checkbox.checked = settings.notifications[field] !== false;
                    }
                });
            }
        }

        async function saveSettings() {
            try {
                const API_BASE = 'https://claudyne.com';
                const token = localStorage.getItem('claudyne_token');
                if (!token) {
                    showToast('⚠️ Veuillez vous connecter', 'warning');
                    return;
                }

                // Collecter les données du formulaire
                const settingsUpdate = {
                    profile: {
                        firstName: document.getElementById('setting-firstName')?.value || '',
                        lastName: document.getElementById('setting-lastName')?.value || '',
                        nickname: document.getElementById('setting-nickname')?.value || '',
                        email: document.getElementById('setting-email')?.value || '',
                        phone: document.getElementById('setting-phone')?.value || '',
                        address: document.getElementById('setting-address')?.value || '',
                        city: document.getElementById('setting-city')?.value || '',
                        country: document.getElementById('setting-country')?.value || ''
                    },
                    education: {
                        educationLevel: document.getElementById('setting-educationLevel')?.value || '',
                        schoolName: document.getElementById('setting-schoolName')?.value || '',
                        targetGrade: document.getElementById('setting-targetGrade')?.value || ''
                    },
                    learning: {
                        adaptiveDifficulty: document.getElementById('setting-adaptiveDifficulty')?.checked || false,
                        detailedExplanations: document.getElementById('setting-detailedExplanations')?.checked || false,
                        spacedRepetition: document.getElementById('setting-spacedRepetition')?.checked || false,
                        difficultyLevel: parseInt(document.getElementById('setting-difficultyLevel')?.value || 3)
                    },
                    notifications: {
                        studyReminders: document.getElementById('setting-notif-studyReminders')?.checked || false,
                        newChallenges: document.getElementById('setting-notif-newChallenges')?.checked || false,
                        smartBreaks: document.getElementById('setting-notif-smartBreaks')?.checked || false,
                        community: document.getElementById('setting-notif-community')?.checked || false
                    }
                };

                showToast('💾 Sauvegarde en cours...', 'info');

                const response = await fetch(`${API_BASE}/api/students/settings`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(settingsUpdate)
                });

                if (!response.ok) {
                    throw new Error('Erreur lors de la sauvegarde');
                }

                const result = await response.json();
                if (result.success) {
                    showToast('✅ Paramètres sauvegardés avec succès !', 'success');
                    gainXP(5, 'Sauvegarde paramètres');

                    // Recharger les données du profil
                    await loadUserData();
                } else {
                    throw new Error(result.message || 'Erreur inconnue');
                }

            } catch (error) {
                console.error('Erreur sauvegarde paramètres:', error);
                showToast('❌ Erreur lors de la sauvegarde: ' + error.message, 'danger');
            }
        }

        function resetToDefaults() {
            if (confirm('Êtes-vous sûr de vouloir restaurer les paramètres par défaut ?')) {
                // Réinitialiser le formulaire
                document.getElementById('setting-difficultyLevel').value = 3;
                document.getElementById('setting-adaptiveDifficulty').checked = true;
                document.getElementById('setting-detailedExplanations').checked = true;
                document.getElementById('setting-spacedRepetition').checked = true;
                document.getElementById('setting-notif-studyReminders').checked = true;
                document.getElementById('setting-notif-newChallenges').checked = true;
                document.getElementById('setting-notif-smartBreaks').checked = true;
                document.getElementById('setting-notif-community').checked = false;

                showToast('↻ Paramètres restaurés aux valeurs par défaut', 'warning');
                gainXP(2, 'Reset paramètres');
            }
        }

        function exportUserData() {
            showToast('📊 Génération de l\'export de données...', 'info');
            setTimeout(() => {
                showToast('📥 Export terminé ! Fichier téléchargé.', 'success');
                gainXP(10, 'Export données');
            }, 3000);
        }

        function resetProgress() {
            const confirmed = confirm('⚠️ ATTENTION : Cette action supprimera définitivement tous vos scores, badges et progression. Êtes-vous absolument certain ?');
            if (confirmed) {
                showToast('🗑️ Progression réinitialisée...', 'danger');
                setTimeout(() => {
                    showToast('✨ Nouveau départ ! Bienvenue à nouveau !', 'info');
                }, 2000);
            }
        }

        // Fonctions pour Prix Claudine
        function registerForAward() {
            showToast('📋 Inscription au Prix Claudine en cours...', 'info');
            setTimeout(() => {
                showToast('🎉 Inscription confirmée ! Dossier en cours d\'évaluation', 'success');
                gainXP(50, 'Inscription Prix Claudine');
            }, 2500);
        }

        function viewAwardHistory() {
            showToast('📚 Chargement de l\'historique des lauréats...', 'info');
            gainXP(5, 'Consultation historique Prix');
        }

        function congratulateLaureates() {
            showToast('❤️ Félicitations envoyées aux lauréats 2024 !', 'success');
            setTimeout(() => {
                showToast('🎉 Pascale, Fanuel et Beltrade ont reçu vos félicitations', 'info');
                gainXP(10, 'Félicitations lauréats');
            }, 2000);
        }

        function viewPreviousYears() {
            showToast('📖 Chargement des lauréats des années précédentes...', 'info');
            setTimeout(() => {
                showToast('📊 Historique complet 2019-2024 disponible', 'success');
                gainXP(8, 'Consultation années précédentes');
            }, 2500);
        }

        function downloadCertificates() {
            showToast('📜 Génération des certificats des lauréats...', 'info');
            setTimeout(() => {
                showToast('📥 Certificats officiels téléchargés !', 'success');
                gainXP(12, 'Téléchargement certificats');
            }, 3500);
        }

        // Fonctions pour Révisions IA
        function optimizeSchedule() {
            showToast('🤖 Optimisation du planning par IA...', 'info');
            setTimeout(() => {
                showToast('✨ Planning optimisé ! +15% d\'efficacité prévue', 'success');
                gainXP(15, 'Optimisation planning IA');
            }, 3000);
        }

        function customizeSchedule() {
            showToast('⚙️ Mode personnalisation activé', 'info');
            gainXP(8, 'Personnalisation planning');
        }

        function generateNewFlashcards() {
            showToast('🧠 Génération de nouvelles fiches par IA...', 'info');
            setTimeout(() => {
                showToast('📚 12 nouvelles fiches créées selon vos lacunes !', 'success');
                gainXP(20, 'Génération fiches IA');
            }, 2000);
        }

        function showFlashcardCategory(category) {
            // Masquer toutes les catégories de fiches
            document.querySelectorAll('.flashcard-category').forEach(cat => {
                cat.classList.remove('active');
            });

            // Désactiver tous les onglets
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Afficher la catégorie sélectionnée
            const targetCategory = document.getElementById(category + '-flashcards');
            if (targetCategory) {
                targetCategory.classList.add('active');
            }

            // Activer l'onglet correspondant
            event.target.classList.add('active');

            const categoryNames = {
                'urgent': 'urgentes',
                'review': 'à revoir',
                'mastered': 'maîtrisées'
            };
            showToast(`📚 Fiches ${categoryNames[category]} affichées`, 'info');
        }

        function pauseRevision() {
            showToast('⏸️ Session de révision mise en pause', 'warning');
            gainXP(5, 'Pause révision');
        }

        function continueRevision() {
            showToast('▶️ Reprise de la session de révision', 'success');
            gainXP(10, 'Reprise révision');
        }

        function endRevision() {
            showToast('🎯 Session terminée ! Excellente concentration !', 'success');
            setTimeout(() => {
                showToast('📊 Résumé de session disponible dans Analytics', 'info');
                gainXP(35, 'Session révision terminée');
            }, 1500);
        }

        // Fonctions pour Orientations
        function exploreCareer(career) {
            const careers = {
                'informatique': 'Ingénierie Informatique',
                'genie-civil': 'Génie Civil',
                'chimie': 'Recherche en Chimie'
            };
            showToast(`💼 Exploration ${careers[career]}...`, 'info');
            setTimeout(() => {
                showToast(`📊 Fiche métier complète générée pour ${careers[career]}`, 'success');
                gainXP(15, `Exploration ${careers[career]}`);
            }, 2000);
        }

        function generateDetailedPath() {
            showToast('🤖 Génération du parcours détaillé par IA...', 'info');
            setTimeout(() => {
                showToast('🗺️ Parcours personnalisé créé ! 3 chemins optimaux identifiés', 'success');
                gainXP(30, 'Parcours détaillé généré');
            }, 3500);
        }

        function takeOrientationQuiz() {
            showToast('📋 Lancement du quiz d\'orientation avancé...', 'info');
            setTimeout(() => {
                showToast('🎯 Quiz complété ! Profil affiné avec 97% de précision', 'success');
                gainXP(25, 'Quiz orientation complété');
            }, 4000);
        }

        function showCareerCategory(category) {
            const categories = {
                'sciences': 'Sciences & Technologies',
                'sante': 'Santé',
                'ingenierie': 'Ingénierie',
                'economie': 'Économie',
                'humaines': 'Sciences Humaines',
                'art': 'Arts & Création'
            };
            showToast(`🔍 Exploration ${categories[category]}...`, 'info');
            setTimeout(() => {
                showToast(`📚 ${categories[category]} : métiers et formations disponibles`, 'success');
                gainXP(10, `Catégorie ${categories[category]}`);
            }, 1500);
        }

        function exploreInstitution(institution) {
            const institutions = {
                'polytechnique': 'École Polytechnique',
                'insa': 'INSA Lyon',
                'saclay': 'Université Paris-Saclay'
            };
            showToast(`🏛️ Analyse ${institutions[institution]}...`, 'info');
            setTimeout(() => {
                showToast(`📊 Profil complet ${institutions[institution]} disponible`, 'success');
                gainXP(12, `Institution ${institutions[institution]}`);
            }, 2500);
        }

        function filterByLocation(location) {
            const locations = {
                'all': 'Toute la France',
                'idf': 'Île-de-France',
                'paca': 'PACA',
                'ra': 'Rhône-Alpes'
            };
            showToast(`📍 Filtrage par région : ${locations[location]}`, 'info');
            gainXP(3, `Filtre région ${locations[location]}`);
        }

        function updateActionPlan() {
            showToast('🔄 Mise à jour du plan d\'action...', 'info');
            setTimeout(() => {
                showToast('✨ Plan actualisé ! Nouvelles opportunités détectées', 'success');
                gainXP(20, 'Plan action mis à jour');
            }, 2000);
        }

        function exportActionPlan() {
            showToast('📄 Génération du PDF en cours...', 'info');
            setTimeout(() => {
                showToast('📥 Plan d\'action exporté ! Document téléchargé', 'success');
                gainXP(15, 'Export plan action');
            }, 3000);
        }

        // Gestion des événements pour les nouveaux éléments
        document.addEventListener('DOMContentLoaded', function() {
            // Gérer les clics sur les exercices de relaxation
            const meditationBtns = document.querySelectorAll('[onclick*="startMeditation"]');
            const breathingBtns = document.querySelectorAll('[onclick*="startBreathing"]');
            const natureBtns = document.querySelectorAll('[onclick*="playNatureSounds"]');

            // Ajouter les événements pour les toggles des paramètres
            const toggleSwitches = document.querySelectorAll('.toggle-switch');
            toggleSwitches.forEach(toggle => {
                toggle.addEventListener('change', function() {
                    const setting = this.closest('.preference-item, .notification-item, .interface-item');
                    const settingName = setting ? setting.querySelector('.preference-title, .notification-title, .interface-title').textContent : 'paramètre';
                    const status = this.checked ? 'activé' : 'désactivé';
                    showToast(`⚙️ ${settingName} ${status}`, 'info', 2000);
                });
            });

            // Gestion du slider de difficulté
            const difficultySlider = document.querySelector('.slider');
            if (difficultySlider) {
                difficultySlider.addEventListener('input', function() {
                    const levels = ['Très facile', 'Facile', 'Moyen', 'Difficile', 'Très difficile'];
                    const level = levels[parseInt(this.value) - 1] || 'Moyen';
                    showToast(`🎯 Difficulté ajustée: ${level}`, 'info', 2000);
                });
            }

            // Gestion des thèmes
            const themeItems = document.querySelectorAll('.theme-item');
            themeItems.forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelectorAll('.theme-item').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    const themeName = this.querySelector('.theme-name').textContent;
                    showToast(`🎨 Thème changé: ${themeName}`, 'success');
                    gainXP(3, `Thème: ${themeName}`);
                });
            });
        });

        // Fonction de test pour les notifications
        function testNotifications() {
            showToast('🧪 Test notification Success', 'success', 3000);
            setTimeout(() => showToast('ℹ️ Test notification Info', 'info', 3000), 1000);
            setTimeout(() => showToast('⚠️ Test notification Warning', 'warning', 3000), 2000);
            setTimeout(() => showToast('❌ Test notification Error', 'error', 3000), 3000);
        }

        // Exposer la fonction de test globalement pour débuggage
        window.testNotifications = testNotifications;

        // ============ FONCTIONS CHANGEMENT MOT DE PASSE ============
        function openPasswordModal() {
            const modal = document.getElementById('passwordModal');
            if (modal) {
                modal.classList.add('active');
                document.body.style.overflow = 'hidden';
                // Réinitialiser le formulaire
                document.getElementById('passwordForm').reset();
                resetPasswordValidation();
                showToast('🔐 Ouverture du panneau de changement de mot de passe', 'info');
            }
        }

        function closePasswordModal() {
            const modal = document.getElementById('passwordModal');
            if (modal) {
                modal.classList.remove('active');
                document.body.style.overflow = '';
                resetPasswordValidation();
            }
        }

        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            const icon = input.parentElement.querySelector('.password-toggle i');

            if (input.type === 'password') {
                input.type = 'text';
                if (icon) {
                    icon.className = 'fas fa-eye-slash';
                }
            } else {
                input.type = 'password';
                if (icon) {
                    icon.className = 'fas fa-eye';
                }
            }
        }

        function validatePasswordRequirements(password) {
            const requirements = {
                length: password.length >= 8,
                uppercase: /[A-Z]/.test(password),
                lowercase: /[a-z]/.test(password),
                number: /[0-9]/.test(password),
                special: /[^A-Za-z0-9]/.test(password)
            };

            // Mettre à jour l'affichage des exigences
            Object.keys(requirements).forEach(req => {
                const element = document.getElementById(`${req}-req`);
                if (element) {
                    if (requirements[req]) {
                        element.classList.add('valid');
                    } else {
                        element.classList.remove('valid');
                    }
                }
            });

            return requirements;
        }

        function calculatePasswordStrength(password) {
            const requirements = validatePasswordRequirements(password);
            const score = Object.values(requirements).filter(Boolean).length;

            const strengthFill = document.getElementById('strengthFill');
            const strengthText = document.getElementById('strengthText');

            if (!strengthFill || !strengthText) return;

            // Réinitialiser les classes
            strengthFill.className = 'strength-fill';
            strengthText.className = 'strength-text';

            if (password.length === 0) {
                strengthText.textContent = 'Entrez un mot de passe';
                return;
            }

            if (score <= 2) {
                strengthFill.classList.add('weak');
                strengthText.classList.add('weak');
                strengthText.textContent = 'Faible';
            } else if (score === 3) {
                strengthFill.classList.add('medium');
                strengthText.classList.add('medium');
                strengthText.textContent = 'Moyen';
            } else if (score === 4) {
                strengthFill.classList.add('good');
                strengthText.classList.add('good');
                strengthText.textContent = 'Bon';
            } else {
                strengthFill.classList.add('strong');
                strengthText.classList.add('strong');
                strengthText.textContent = 'Excellent';
            }

            return score >= 4;
        }

        function validatePasswordMatch() {
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const matchDiv = document.getElementById('passwordMatch');
            const submitBtn = document.getElementById('changePasswordBtn');

            if (!matchDiv || !submitBtn) return;

            if (confirmPassword.length === 0) {
                matchDiv.textContent = '';
                matchDiv.className = 'password-match';
                submitBtn.disabled = true;
                return;
            }

            if (newPassword === confirmPassword) {
                matchDiv.textContent = '✅ Les mots de passe correspondent';
                matchDiv.className = 'password-match success';

                // Vérifier aussi la force du mot de passe
                const isStrong = calculatePasswordStrength(newPassword);
                submitBtn.disabled = !isStrong;
            } else {
                matchDiv.textContent = '❌ Les mots de passe ne correspondent pas';
                matchDiv.className = 'password-match error';
                submitBtn.disabled = true;
            }
        }

        function resetPasswordValidation() {
            const requirements = ['length', 'uppercase', 'lowercase', 'number', 'special'];
            requirements.forEach(req => {
                const element = document.getElementById(`${req}-req`);
                if (element) {
                    element.classList.remove('valid');
                }
            });

            const strengthFill = document.getElementById('strengthFill');
            const strengthText = document.getElementById('strengthText');
            const matchDiv = document.getElementById('passwordMatch');
            const submitBtn = document.getElementById('changePasswordBtn');

            if (strengthFill) strengthFill.className = 'strength-fill';
            if (strengthText) {
                strengthText.className = 'strength-text';
                strengthText.textContent = 'Entrez un mot de passe';
            }
            if (matchDiv) {
                matchDiv.textContent = '';
                matchDiv.className = 'password-match';
            }
            if (submitBtn) submitBtn.disabled = true;
        }

        async function changePassword(event) {
            event.preventDefault();

            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            // Validation finale
            if (!currentPassword || !newPassword || !confirmPassword) {
                showToast('❌ Veuillez remplir tous les champs', 'error');
                return false;
            }

            if (newPassword !== confirmPassword) {
                showToast('❌ Les mots de passe ne correspondent pas', 'error');
                return false;
            }

            const requirements = validatePasswordRequirements(newPassword);
            const allValid = Object.values(requirements).every(Boolean);

            if (!allValid) {
                showToast('❌ Le mot de passe ne respecte pas les exigences de sécurité', 'error');
                return false;
            }

            try {
                showToast('🔄 Changement de mot de passe en cours...', 'info');

                const token = localStorage.getItem('claudyne_token');
                if (!token) {
                    showToast('⚠️ Veuillez vous connecter', 'warning');
                    return false;
                }

                const response = await fetch(`${API_BASE}/api/students/change-password`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        currentPassword,
                        newPassword
                    })
                });

                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.message || 'Erreur lors du changement de mot de passe');
                }

                const result = await response.json();
                if (result.success) {
                    showToast('✅ Mot de passe modifié avec succès !', 'success');
                    closePasswordModal();
                    gainXP(10, 'Changement mot de passe');

                    // Réinitialiser le formulaire
                    document.getElementById('currentPassword').value = '';
                    document.getElementById('newPassword').value = '';
                    document.getElementById('confirmPassword').value = '';
                } else {
                    throw new Error(result.message || 'Erreur inconnue');
                }
            } catch (error) {
                console.error('Erreur changement mot de passe:', error);
                showToast('❌ ' + error.message, 'error');
            }

            return false;
        }

        function _oldChangePasswordCode() {
            setTimeout(() => {
                showToast('✅ Mot de passe changé avec succès !', 'success');
                gainXP(50, 'Sécurité: Mot de passe mis à jour');
                closePasswordModal();

                setTimeout(() => {
                    showToast('🔐 Nouvelle connexion requise pour sécurité', 'info');
                }, 2000);
            }, 2000);

            return false;
        }

        // Événements pour les champs de mot de passe
        document.addEventListener('DOMContentLoaded', function() {
            const newPasswordField = document.getElementById('newPassword');
            const confirmPasswordField = document.getElementById('confirmPassword');

            if (newPasswordField) {
                newPasswordField.addEventListener('input', function() {
                    calculatePasswordStrength(this.value);
                    validatePasswordMatch();
                });
            }

            if (confirmPasswordField) {
                confirmPasswordField.addEventListener('input', validatePasswordMatch);
            }

            // Fermer le modal en cliquant à l'extérieur
            const modal = document.getElementById('passwordModal');
            if (modal) {
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        closePasswordModal();
                    }
                });
            }
        });

        // ============ FONCTION RENOUVELLEMENT PREMIUM ============
        // Charger le module de paiement
        const paymentScript = document.createElement('script');
        paymentScript.src = '/student-payment-modal.js';
        document.head.appendChild(paymentScript);

        // Fonction de déconnexion étudiant
        function studentLogout() {
            if (confirm('Êtes-vous sûr de vouloir vous déconnecter ?')) {
                // Nettoyer les données de session
                localStorage.removeItem('claudyne_token');
                localStorage.removeItem('claudyne_refresh_token');
                localStorage.removeItem('claudyne_user');
                localStorage.removeItem('claudyne_family');

                // Afficher un message de déconnexion
                showToast('🚪 Déconnexion réussie - À bientôt !', 'info');

                // Rediriger vers la page de connexion après 1.5 secondes
                setTimeout(() => {
                    window.location.href = '/';
                }, 1500);

                console.log('🚪 Déconnexion étudiant effectuée');
            }
        }

        // Interface Claudyne chargée
        if (window.location.hostname === 'localhost') {
            console.log('🚀 Claudyne - Interface Étudiant chargée');
        }
    </script>
</body>
</html>